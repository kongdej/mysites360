import{c as ug,ac as cg,r as Z,ae as dg,b as K,T as pS,w as Wh,V as mS,W as gS,o as fg,d as Yt,h as vS,b4 as Li,g as ba,bg as kc,bh as $m,av as yS,ax as Cc,a0 as xS,aW as wS,ag as _S,bi as bS,bj as MS,ab as ES,f as Rd,i as pg,u as mg,k as gg,_ as Fd,t as Ne,n as nt,p as le,B as Ct,y as Bt,z as we,C as xt,F as ca,E as Md,q,s as Y,v as zc,J as Oh,A as Mt,D as jt,G as vg,I as da,H as fh,L as oa,x as Tn,Q as Ed,ai as Bm,M as SS,N as AS,P as Lr,m as bl,b3 as yg,bk as kS,K as CS,bl as zS,bm as TS,bn as Ml,az as OS}from"./index.20a83c22.js";import{a as Go,Q as Tc}from"./QSelect.12950763.js";import{Q as Ih}from"./QSpace.ac1f210e.js";import{Q as Nm,a as IS}from"./QScrollObserver.26699e5b.js";import{T as Lh,Q as LS,a as PS}from"./QDrawer.0d85f3c1.js";import{b as xs}from"./format.6780ce5f.js";import{Q as RS}from"./QPage.8b39828a.js";import{a as mn,d as kn,b as Ii,e as Sd,c as ao,Q as Um}from"./QItemLabel.5fea025f.js";import{Q as aa}from"./QImg.c22b8555.js";import{Q as FS}from"./QUploader.f720e30f.js";import{Q as Dm}from"./QForm.7a5a2fd1.js";import{C as rr}from"./ClosePopup.74073674.js";import{u as xg}from"./use-quasar.c59acd1d.js";import{c as Yo}from"./index.58290dd4.js";import{u as it,A as Ma,e as st,a as Ea,S as ne,M as qh,D as In,r as Gh,T as Sa,b as Yh,P as _e,c as bs,V as El,d as $S,f as BS,g as NS,h as US,G as DS,i as Vm,j as VS,k as Hm,E as Wm}from"./index.module.46f962d2.js";import{Q as Oc}from"./QTooltip.5875853b.js";import{Q as HS}from"./QBar.a048c782.js";import{f as WS,l as Sl,a as qS,d as Al,s as gn}from"./index.08e40633.js";import{e as GS}from"./api.3ba84939.js";import"./position-engine.f750f71b.js";import"./use-ratio.bd2b5243.js";const qm=["vertical","horizontal"],Ic={vertical:{offset:"offsetY",scroll:"scrollTop",dir:"down",dist:"y"},horizontal:{offset:"offsetX",scroll:"scrollLeft",dir:"right",dist:"x"}},Gm={prevent:!0,mouse:!0,mouseAllDir:!0},Ym=i=>i>=250?50:Math.ceil(i/5);var YS=ug({name:"QScrollArea",props:{...cg,thumbStyle:Object,verticalThumbStyle:Object,horizontalThumbStyle:Object,barStyle:[Array,String,Object],verticalBarStyle:[Array,String,Object],horizontalBarStyle:[Array,String,Object],contentStyle:[Array,String,Object],contentActiveStyle:[Array,String,Object],delay:{type:[String,Number],default:1e3},visible:{type:Boolean,default:null},tabindex:[String,Number],onScroll:Function},setup(i,{slots:t,emit:e}){const s=Z(!1),r=Z(!1),a=Z(!1),l={vertical:Z(0),horizontal:Z(0)},u={vertical:{ref:Z(null),position:Z(0),size:Z(0)},horizontal:{ref:Z(null),position:Z(0),size:Z(0)}},{proxy:c}=ba(),d=dg(i,c.$q);let f=null,m;const g=Z(null),v=K(()=>"q-scrollarea"+(d.value===!0?" q-scrollarea--dark":""));u.vertical.percentage=K(()=>{const V=u.vertical.size.value-l.vertical.value;if(V<=0)return 0;const J=xs(u.vertical.position.value/V,0,1);return Math.round(J*1e4)/1e4}),u.vertical.thumbHidden=K(()=>(i.visible===null?a.value:i.visible)!==!0&&s.value===!1&&r.value===!1||u.vertical.size.value<=l.vertical.value+1),u.vertical.thumbStart=K(()=>u.vertical.percentage.value*(l.vertical.value-u.vertical.thumbSize.value)),u.vertical.thumbSize=K(()=>Math.round(xs(l.vertical.value*l.vertical.value/u.vertical.size.value,Ym(l.vertical.value),l.vertical.value))),u.vertical.style=K(()=>({...i.thumbStyle,...i.verticalThumbStyle,top:`${u.vertical.thumbStart.value}px`,height:`${u.vertical.thumbSize.value}px`})),u.vertical.thumbClass=K(()=>"q-scrollarea__thumb q-scrollarea__thumb--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.vertical.barClass=K(()=>"q-scrollarea__bar q-scrollarea__bar--v absolute-right"+(u.vertical.thumbHidden.value===!0?" q-scrollarea__bar--invisible":"")),u.horizontal.percentage=K(()=>{const V=u.horizontal.size.value-l.horizontal.value;if(V<=0)return 0;const J=xs(Math.abs(u.horizontal.position.value)/V,0,1);return Math.round(J*1e4)/1e4}),u.horizontal.thumbHidden=K(()=>(i.visible===null?a.value:i.visible)!==!0&&s.value===!1&&r.value===!1||u.horizontal.size.value<=l.horizontal.value+1),u.horizontal.thumbStart=K(()=>u.horizontal.percentage.value*(l.horizontal.value-u.horizontal.thumbSize.value)),u.horizontal.thumbSize=K(()=>Math.round(xs(l.horizontal.value*l.horizontal.value/u.horizontal.size.value,Ym(l.horizontal.value),l.horizontal.value))),u.horizontal.style=K(()=>({...i.thumbStyle,...i.horizontalThumbStyle,[c.$q.lang.rtl===!0?"right":"left"]:`${u.horizontal.thumbStart.value}px`,width:`${u.horizontal.thumbSize.value}px`})),u.horizontal.thumbClass=K(()=>"q-scrollarea__thumb q-scrollarea__thumb--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__thumb--invisible":"")),u.horizontal.barClass=K(()=>"q-scrollarea__bar q-scrollarea__bar--h absolute-bottom"+(u.horizontal.thumbHidden.value===!0?" q-scrollarea__bar--invisible":""));const x=K(()=>u.vertical.thumbHidden.value===!0&&u.horizontal.thumbHidden.value===!0?i.contentStyle:i.contentActiveStyle),b=[[Lh,V=>{$(V,"vertical")},void 0,{vertical:!0,...Gm}]],E=[[Lh,V=>{$(V,"horizontal")},void 0,{horizontal:!0,...Gm}]];function S(){const V={};return qm.forEach(J=>{const pt=u[J];V[J+"Position"]=pt.position.value,V[J+"Percentage"]=pt.percentage.value,V[J+"Size"]=pt.size.value,V[J+"ContainerSize"]=l[J].value}),V}const z=pS(()=>{const V=S();V.ref=c,e("scroll",V)},0);function I(V,J,pt){if(qm.includes(V)===!1){console.error("[QScrollArea]: wrong first param of setScrollPosition (vertical/horizontal)");return}(V==="vertical"?$m:kc)(g.value,J,pt)}function O({height:V,width:J}){let pt=!1;l.vertical.value!==V&&(l.vertical.value=V,pt=!0),l.horizontal.value!==J&&(l.horizontal.value=J,pt=!0),pt===!0&&lt()}function P({position:V}){let J=!1;u.vertical.position.value!==V.top&&(u.vertical.position.value=V.top,J=!0),u.horizontal.position.value!==V.left&&(u.horizontal.position.value=V.left,J=!0),J===!0&&lt()}function G({height:V,width:J}){u.horizontal.size.value!==J&&(u.horizontal.size.value=J,lt()),u.vertical.size.value!==V&&(u.vertical.size.value=V,lt())}function $(V,J){const pt=u[J];if(V.isFirst===!0){if(pt.thumbHidden.value===!0)return;m=pt.position.value,r.value=!0}else if(r.value!==!0)return;V.isFinal===!0&&(r.value=!1);const mt=Ic[J],Tt=l[J].value,ss=(pt.size.value-Tt)/(Tt-pt.thumbSize.value),mi=V.distance[mt.dist],ot=m+(V.direction===mt.dir?1:-1)*mi*ss;ut(ot,J)}function _t(V,J){const pt=u[J];if(pt.thumbHidden.value!==!0){const mt=V[Ic[J].offset];if(mt<pt.thumbStart.value||mt>pt.thumbStart.value+pt.thumbSize.value){const Tt=mt-pt.thumbSize.value/2;ut(Tt/l[J].value*pt.size.value,J)}pt.ref.value!==null&&pt.ref.value.dispatchEvent(new MouseEvent(V.type,V))}}function zt(V){_t(V,"vertical")}function j(V){_t(V,"horizontal")}function lt(){s.value=!0,f!==null&&clearTimeout(f),f=setTimeout(()=>{f=null,s.value=!1},i.delay),i.onScroll!==void 0&&z()}function ut(V,J){g.value[Ic[J].scroll]=V}let ht=null;function Ft(){ht!==null&&clearTimeout(ht),ht=setTimeout(()=>{ht=null,a.value=!0},c.$q.platform.is.ios?50:0)}function tt(){ht!==null&&(clearTimeout(ht),ht=null),a.value=!1}let Lt=null;return Wh(()=>c.$q.lang.rtl,V=>{g.value!==null&&kc(g.value,Math.abs(u.horizontal.position.value)*(V===!0?-1:1))}),mS(()=>{Lt={top:u.vertical.position.value,left:u.horizontal.position.value}}),gS(()=>{if(Lt===null)return;const V=g.value;V!==null&&(kc(V,Lt.left),$m(V,Lt.top))}),fg(z.cancel),Object.assign(c,{getScrollTarget:()=>g.value,getScroll:S,getScrollPosition:()=>({top:u.vertical.position.value,left:u.horizontal.position.value}),getScrollPercentage:()=>({top:u.vertical.percentage.value,left:u.horizontal.percentage.value}),setScrollPosition:I,setScrollPercentage(V,J,pt){I(V,J*(u[V].size.value-l[V].value)*(V==="horizontal"&&c.$q.lang.rtl===!0?-1:1),pt)}}),()=>Yt("div",{class:v.value,onMouseenter:Ft,onMouseleave:tt},[Yt("div",{ref:g,class:"q-scrollarea__container scroll relative-position fit hide-scrollbar",tabindex:i.tabindex!==void 0?i.tabindex:void 0},[Yt("div",{class:"q-scrollarea__content absolute",style:x.value},vS(t.default,[Yt(Nm,{debounce:0,onResize:G})])),Yt(IS,{axis:"both",onScroll:P})]),Yt(Nm,{debounce:0,onResize:O}),Yt("div",{class:u.vertical.barClass.value,style:[i.barStyle,i.verticalBarStyle],"aria-hidden":"true",onMousedown:zt}),Yt("div",{class:u.horizontal.barClass.value,style:[i.barStyle,i.horizontalBarStyle],"aria-hidden":"true",onMousedown:j}),Li(Yt("div",{ref:u.vertical.ref,class:u.vertical.thumbClass.value,style:u.vertical.style.value,"aria-hidden":"true"}),b),Li(Yt("div",{ref:u.horizontal.ref,class:u.horizontal.thumbClass.value,style:u.horizontal.style.value,"aria-hidden":"true"}),E)])}});const jm="q-slider__marker-labels",jS=i=>({value:i}),ZS=({marker:i})=>Yt("div",{key:i.value,style:i.style,class:i.classes},i.label),wg=[34,37,40,33,39,38],XS={...cg,...xS,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:i=>i>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},QS=["pan","update:modelValue","change"];function JS({updateValue:i,updatePosition:t,getDragging:e,formAttrs:s}){const{props:r,emit:a,slots:l,proxy:{$q:u}}=ba(),c=dg(r,u),d=bS(s),f=Z(!1),m=Z(!1),g=Z(!1),v=Z(!1),x=K(()=>r.vertical===!0?"--v":"--h"),b=K(()=>"-"+(r.switchLabelSide===!0?"switched":"standard")),E=K(()=>r.vertical===!0?r.reverse===!0:r.reverse!==(u.lang.rtl===!0)),S=K(()=>isNaN(r.innerMin)===!0||r.innerMin<r.min?r.min:r.innerMin),z=K(()=>isNaN(r.innerMax)===!0||r.innerMax>r.max?r.max:r.innerMax),I=K(()=>r.disable!==!0&&r.readonly!==!0&&S.value<z.value),O=K(()=>{if(r.step===0)return gt=>gt;const H=(String(r.step).trim().split(".")[1]||"").length;return gt=>parseFloat(gt.toFixed(H))}),P=K(()=>r.step===0?1:r.step),G=K(()=>I.value===!0?r.tabindex||0:-1),$=K(()=>r.max-r.min),_t=K(()=>z.value-S.value),zt=K(()=>Pe(S.value)),j=K(()=>Pe(z.value)),lt=K(()=>r.vertical===!0?E.value===!0?"bottom":"top":E.value===!0?"right":"left"),ut=K(()=>r.vertical===!0?"height":"width"),ht=K(()=>r.vertical===!0?"width":"height"),Ft=K(()=>r.vertical===!0?"vertical":"horizontal"),tt=K(()=>{const H={role:"slider","aria-valuemin":S.value,"aria-valuemax":z.value,"aria-orientation":Ft.value,"data-step":r.step};return r.disable===!0?H["aria-disabled"]="true":r.readonly===!0&&(H["aria-readonly"]="true"),H}),Lt=K(()=>`q-slider q-slider${x.value} q-slider--${f.value===!0?"":"in"}active inline no-wrap `+(r.vertical===!0?"row":"column")+(r.disable===!0?" disabled":" q-slider--enabled"+(I.value===!0?" q-slider--editable":""))+(g.value==="both"?" q-slider--focus":"")+(r.label||r.labelAlways===!0?" q-slider--label":"")+(r.labelAlways===!0?" q-slider--label-always":"")+(c.value===!0?" q-slider--dark":"")+(r.dense===!0?" q-slider--dense q-slider--dense"+x.value:""));function V(H){const gt="q-slider__"+H;return`${gt} ${gt}${x.value} ${gt}${x.value}${b.value}`}function J(H){const gt="q-slider__"+H;return`${gt} ${gt}${x.value}`}const pt=K(()=>{const H=r.selectionColor||r.color;return"q-slider__selection absolute"+(H!==void 0?` text-${H}`:"")}),mt=K(()=>J("markers")+" absolute overflow-hidden"),Tt=K(()=>J("track-container")),ss=K(()=>V("pin")),mi=K(()=>V("label")),ot=K(()=>V("text-container")),X=K(()=>V("marker-labels-container")+(r.markerLabelsClass!==void 0?` ${r.markerLabelsClass}`:"")),Dt=K(()=>"q-slider__track relative-position no-outline"+(r.trackColor!==void 0?` bg-${r.trackColor}`:"")),fe=K(()=>{const H={[ht.value]:r.trackSize};return r.trackImg!==void 0&&(H.backgroundImage=`url(${r.trackImg}) !important`),H}),We=K(()=>"q-slider__inner absolute"+(r.innerTrackColor!==void 0?` bg-${r.innerTrackColor}`:"")),Ni=K(()=>{const H=j.value-zt.value,gt={[lt.value]:`${100*zt.value}%`,[ut.value]:H===0?"2px":`${100*H}%`};return r.innerTrackImg!==void 0&&(gt.backgroundImage=`url(${r.innerTrackImg}) !important`),gt});function mr(H){const{min:gt,max:Pt,step:Nt}=r;let Kt=gt+H*(Pt-gt);if(Nt>0){const vi=(Kt-S.value)%Nt;Kt+=(Math.abs(vi)>=Nt/2?(vi<0?-1:1)*Nt:0)-vi}return Kt=O.value(Kt),xs(Kt,S.value,z.value)}function Pe(H){return $.value===0?0:(H-r.min)/$.value}function sn(H,gt){const Pt=wS(H),Nt=r.vertical===!0?xs((Pt.top-gt.top)/gt.height,0,1):xs((Pt.left-gt.left)/gt.width,0,1);return xs(E.value===!0?1-Nt:Nt,zt.value,j.value)}const Rn=K(()=>yS(r.markers)===!0?r.markers:P.value),Ee=K(()=>{const H=[],gt=Rn.value,Pt=r.max;let Nt=r.min;do H.push(Nt),Nt+=gt;while(Nt<Pt);return H.push(Pt),H}),gi=K(()=>{const H=` ${jm}${x.value}-`;return jm+`${H}${r.switchMarkerLabelsSide===!0?"switched":"standard"}${H}${E.value===!0?"rtl":"ltr"}`}),Fn=K(()=>r.markerLabels===!1?null:$n(r.markerLabels).map((H,gt)=>({index:gt,value:H.value,label:H.label||H.value,classes:gi.value+(H.classes!==void 0?" "+H.classes:""),style:{...ns(H.value),...H.style||{}}}))),qe=K(()=>({markerList:Fn.value,markerMap:Re.value,classes:gi.value,getStyle:ns})),Ss=K(()=>{const H=_t.value===0?"2px":100*Rn.value/_t.value;return{...Ni.value,backgroundSize:r.vertical===!0?`2px ${H}%`:`${H}% 2px`}});function $n(H){if(H===!1)return null;if(H===!0)return Ee.value.map(jS);if(typeof H=="function")return Ee.value.map(Pt=>{const Nt=H(Pt);return Cc(Nt)===!0?{...Nt,value:Pt}:{value:Pt,label:Nt}});const gt=({value:Pt})=>Pt>=r.min&&Pt<=r.max;return Array.isArray(H)===!0?H.map(Pt=>Cc(Pt)===!0?Pt:{value:Pt}).filter(gt):Object.keys(H).map(Pt=>{const Nt=H[Pt],Kt=Number(Pt);return Cc(Nt)===!0?{...Nt,value:Kt}:{value:Kt,label:Nt}}).filter(gt)}function ns(H){return{[lt.value]:`${100*(H-r.min)/$.value}%`}}const Re=K(()=>{if(r.markerLabels===!1)return null;const H={};return Fn.value.forEach(gt=>{H[gt.value]=gt}),H});function As(){if(l["marker-label-group"]!==void 0)return l["marker-label-group"](qe.value);const H=l["marker-label"]||ZS;return Fn.value.map(gt=>H({marker:gt,...qe.value}))}const nn=K(()=>[[Lh,Eo,void 0,{[Ft.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function Eo(H){H.isFinal===!0?(v.value!==void 0&&(t(H.evt),H.touch===!0&&i(!0),v.value=void 0,a("pan","end")),f.value=!1,g.value=!1):H.isFirst===!0?(v.value=e(H.evt),t(H.evt),i(),f.value=!0,a("pan","start")):(t(H.evt),i())}function rs(){g.value=!1}function So(H){t(H,e(H)),i(),m.value=!0,f.value=!0,document.addEventListener("mouseup",Ui,!0)}function Ui(){m.value=!1,f.value=!1,i(!0),rs(),document.removeEventListener("mouseup",Ui,!0)}function os(H){t(H,e(H)),i(!0)}function Bn(H){wg.includes(H.keyCode)&&i(!0)}function Nn(H){if(r.vertical===!0)return null;const gt=u.lang.rtl!==r.reverse?1-H:H;return{transform:`translateX(calc(${2*gt-1} * ${r.thumbSize} / 2 + ${50-100*gt}%))`}}function Un(H){const gt=K(()=>m.value===!1&&(g.value===H.focusValue||g.value==="both")?" q-slider--focus":""),Pt=K(()=>`q-slider__thumb q-slider__thumb${x.value} q-slider__thumb${x.value}-${E.value===!0?"rtl":"ltr"} absolute non-selectable`+gt.value+(H.thumbColor.value!==void 0?` text-${H.thumbColor.value}`:"")),Nt=K(()=>({width:r.thumbSize,height:r.thumbSize,[lt.value]:`${100*H.ratio.value}%`,zIndex:g.value===H.focusValue?2:void 0})),Kt=K(()=>H.labelColor.value!==void 0?` text-${H.labelColor.value}`:""),vi=K(()=>Nn(H.ratio.value)),ks=K(()=>"q-slider__text"+(H.labelTextColor.value!==void 0?` text-${H.labelTextColor.value}`:""));return()=>{const rn=[Yt("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[Yt("path",{d:r.thumbPath})]),Yt("div",{class:"q-slider__focus-ring fit"})];return(r.label===!0||r.labelAlways===!0)&&(rn.push(Yt("div",{class:ss.value+" absolute fit no-pointer-events"+Kt.value},[Yt("div",{class:mi.value,style:{minWidth:r.thumbSize}},[Yt("div",{class:ot.value,style:vi.value},[Yt("span",{class:ks.value},H.label.value)])])])),r.name!==void 0&&r.disable!==!0&&d(rn,"push")),Yt("div",{class:Pt.value,style:Nt.value,...H.getNodeData()},rn)}}function Dn(H,gt,Pt,Nt){const Kt=[];r.innerTrackColor!=="transparent"&&Kt.push(Yt("div",{key:"inner",class:We.value,style:Ni.value})),r.selectionColor!=="transparent"&&Kt.push(Yt("div",{key:"selection",class:pt.value,style:H.value})),r.markers!==!1&&Kt.push(Yt("div",{key:"marker",class:mt.value,style:Ss.value})),Nt(Kt);const vi=[_S("div",{key:"trackC",class:Tt.value,tabindex:gt.value,...Pt.value},[Yt("div",{class:Dt.value,style:fe.value},Kt)],"slide",I.value,()=>nn.value)];if(r.markerLabels!==!1){const ks=r.switchMarkerLabelsSide===!0?"unshift":"push";vi[ks](Yt("div",{key:"markerL",class:X.value},As()))}return vi}return fg(()=>{document.removeEventListener("mouseup",Ui,!0)}),{state:{active:f,focus:g,preventFocus:m,dragging:v,editable:I,classes:Lt,tabindex:G,attributes:tt,roundValueFn:O,keyStep:P,trackLen:$,innerMin:S,innerMinRatio:zt,innerMax:z,innerMaxRatio:j,positionProp:lt,sizeProp:ut,isReversed:E},methods:{onActivate:So,onMobileClick:os,onBlur:rs,onKeyup:Bn,getContent:Dn,getThumbRenderFn:Un,convertRatioToModel:mr,convertModelToRatio:Pe,getDraggingRatio:sn}}}const KS=()=>({});var Lc=ug({name:"QSlider",props:{...XS,modelValue:{required:!0,default:null,validator:i=>typeof i=="number"||i===null},labelValue:[String,Number]},emits:QS,setup(i,{emit:t}){const{proxy:{$q:e}}=ba(),{state:s,methods:r}=JS({updateValue:x,updatePosition:E,getDragging:b,formAttrs:MS(i)}),a=Z(null),l=Z(0),u=Z(0);function c(){u.value=i.modelValue===null?s.innerMin.value:xs(i.modelValue,s.innerMin.value,s.innerMax.value)}Wh(()=>`${i.modelValue}|${s.innerMin.value}|${s.innerMax.value}`,c),c();const d=K(()=>r.convertModelToRatio(u.value)),f=K(()=>s.active.value===!0?l.value:d.value),m=K(()=>{const I={[s.positionProp.value]:`${100*s.innerMinRatio.value}%`,[s.sizeProp.value]:`${100*(f.value-s.innerMinRatio.value)}%`};return i.selectionImg!==void 0&&(I.backgroundImage=`url(${i.selectionImg}) !important`),I}),g=r.getThumbRenderFn({focusValue:!0,getNodeData:KS,ratio:f,label:K(()=>i.labelValue!==void 0?i.labelValue:u.value),thumbColor:K(()=>i.thumbColor||i.color),labelColor:K(()=>i.labelColor),labelTextColor:K(()=>i.labelTextColor)}),v=K(()=>s.editable.value!==!0?{}:e.platform.is.mobile===!0?{onClick:r.onMobileClick}:{onMousedown:r.onActivate,onFocus:S,onBlur:r.onBlur,onKeydown:z,onKeyup:r.onKeyup});function x(I){u.value!==i.modelValue&&t("update:modelValue",u.value),I===!0&&t("change",u.value)}function b(){return a.value.getBoundingClientRect()}function E(I,O=s.dragging.value){const P=r.getDraggingRatio(I,O);u.value=r.convertRatioToModel(P),l.value=i.snap!==!0||i.step===0?P:r.convertModelToRatio(u.value)}function S(){s.focus.value=!0}function z(I){if(!wg.includes(I.keyCode))return;ES(I);const O=([34,33].includes(I.keyCode)?10:1)*s.keyStep.value,P=([34,37,40].includes(I.keyCode)?-1:1)*(s.isReversed.value===!0?-1:1)*(i.vertical===!0?-1:1)*O;u.value=xs(s.roundValueFn.value(u.value+P),s.innerMin.value,s.innerMax.value),x()}return()=>{const I=r.getContent(m,s.tabindex,v,O=>{O.push(g())});return Yt("div",{ref:a,class:s.classes.value+(i.modelValue===null?" q-slider--no-value":""),...s.attributes.value,"aria-valuenow":i.modelValue},I)}}}),Zm={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(i,t){(function(){var e,s="4.17.21",r=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",u="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,f="__lodash_placeholder__",m=1,g=2,v=4,x=1,b=2,E=1,S=2,z=4,I=8,O=16,P=32,G=64,$=128,_t=256,zt=512,j=30,lt="...",ut=800,ht=16,Ft=1,tt=2,Lt=3,V=1/0,J=9007199254740991,pt=17976931348623157e292,mt=0/0,Tt=4294967295,ss=Tt-1,mi=Tt>>>1,ot=[["ary",$],["bind",E],["bindKey",S],["curry",I],["curryRight",O],["flip",zt],["partial",P],["partialRight",G],["rearg",_t]],X="[object Arguments]",Dt="[object Array]",fe="[object AsyncFunction]",We="[object Boolean]",Ni="[object Date]",mr="[object DOMException]",Pe="[object Error]",sn="[object Function]",Rn="[object GeneratorFunction]",Ee="[object Map]",gi="[object Number]",Fn="[object Null]",qe="[object Object]",Ss="[object Promise]",$n="[object Proxy]",ns="[object RegExp]",Re="[object Set]",As="[object String]",nn="[object Symbol]",Eo="[object Undefined]",rs="[object WeakMap]",So="[object WeakSet]",Ui="[object ArrayBuffer]",os="[object DataView]",Bn="[object Float32Array]",Nn="[object Float64Array]",Un="[object Int8Array]",Dn="[object Int16Array]",H="[object Int32Array]",gt="[object Uint8Array]",Pt="[object Uint8ClampedArray]",Nt="[object Uint16Array]",Kt="[object Uint32Array]",vi=/\b__p \+= '';/g,ks=/\b(__p \+=) '' \+/g,rn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Oa=/&(?:amp|lt|gt|quot|#39);/g,as=/[&<>"']/g,Ao=RegExp(Oa.source),gr=RegExp(as.source),cu=/<%-([\s\S]+?)%>/g,du=/<%([\s\S]+?)%>/g,Ia=/<%=([\s\S]+?)%>/g,fu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pu=/^\w*$/,mu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vr=/[\\^$.*+?()[\]{}|]/g,ko=RegExp(vr.source),Co=/^\s+/,R=/\s/,W=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,at=/\{\n\/\* \[wrapped with (.+)\] \*/,Ot=/,? & /,re=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Cs=/[()=,{}\[\]\/\s]/,zs=/\\(\\)?/g,ee=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ts=/\w*$/,ls=/^[-+]0x[0-9a-f]+$/i,he=/^0b[01]+$/i,La=/^\[object .+?Constructor\]$/,zo=/^0o[0-7]+$/i,Pa=/^(?:0|[1-9]\d*)$/,Ra=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yr=/($^)/,To=/['\n\r\u2028\u2029\\]/g,Os="\\ud800-\\udfff",vt="\\u0300-\\u036f",ve="\\ufe20-\\ufe2f",Xt="\\u20d0-\\u20ff",Ge=vt+ve+Xt,ii="\\u2700-\\u27bf",Qt="a-z\\xdf-\\xf6\\xf8-\\xff",ue="\\xac\\xb1\\xd7\\xf7",gu="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",dx="\\u2000-\\u206f",fx=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",mf="A-Z\\xc0-\\xd6\\xd8-\\xde",gf="\\ufe0e\\ufe0f",vf=ue+gu+dx+fx,vu="['\u2019]",px="["+Os+"]",yf="["+vf+"]",Fa="["+Ge+"]",xf="\\d+",mx="["+ii+"]",wf="["+Qt+"]",_f="[^"+Os+vf+xf+ii+Qt+mf+"]",yu="\\ud83c[\\udffb-\\udfff]",gx="(?:"+Fa+"|"+yu+")",bf="[^"+Os+"]",xu="(?:\\ud83c[\\udde6-\\uddff]){2}",wu="[\\ud800-\\udbff][\\udc00-\\udfff]",xr="["+mf+"]",Mf="\\u200d",Ef="(?:"+wf+"|"+_f+")",vx="(?:"+xr+"|"+_f+")",Sf="(?:"+vu+"(?:d|ll|m|re|s|t|ve))?",Af="(?:"+vu+"(?:D|LL|M|RE|S|T|VE))?",kf=gx+"?",Cf="["+gf+"]?",yx="(?:"+Mf+"(?:"+[bf,xu,wu].join("|")+")"+Cf+kf+")*",xx="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",wx="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",zf=Cf+kf+yx,_x="(?:"+[mx,xu,wu].join("|")+")"+zf,bx="(?:"+[bf+Fa+"?",Fa,xu,wu,px].join("|")+")",Mx=RegExp(vu,"g"),Ex=RegExp(Fa,"g"),_u=RegExp(yu+"(?="+yu+")|"+bx+zf,"g"),Sx=RegExp([xr+"?"+wf+"+"+Sf+"(?="+[yf,xr,"$"].join("|")+")",vx+"+"+Af+"(?="+[yf,xr+Ef,"$"].join("|")+")",xr+"?"+Ef+"+"+Sf,xr+"+"+Af,wx,xx,xf,_x].join("|"),"g"),Ax=RegExp("["+Mf+Os+Ge+gf+"]"),kx=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cx=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zx=-1,Gt={};Gt[Bn]=Gt[Nn]=Gt[Un]=Gt[Dn]=Gt[H]=Gt[gt]=Gt[Pt]=Gt[Nt]=Gt[Kt]=!0,Gt[X]=Gt[Dt]=Gt[Ui]=Gt[We]=Gt[os]=Gt[Ni]=Gt[Pe]=Gt[sn]=Gt[Ee]=Gt[gi]=Gt[qe]=Gt[ns]=Gt[Re]=Gt[As]=Gt[rs]=!1;var Ht={};Ht[X]=Ht[Dt]=Ht[Ui]=Ht[os]=Ht[We]=Ht[Ni]=Ht[Bn]=Ht[Nn]=Ht[Un]=Ht[Dn]=Ht[H]=Ht[Ee]=Ht[gi]=Ht[qe]=Ht[ns]=Ht[Re]=Ht[As]=Ht[nn]=Ht[gt]=Ht[Pt]=Ht[Nt]=Ht[Kt]=!0,Ht[Pe]=Ht[sn]=Ht[rs]=!1;var Tx={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"s"},Ox={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ix={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Lx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Px=parseFloat,Rx=parseInt,Tf=typeof Yo=="object"&&Yo&&Yo.Object===Object&&Yo,Fx=typeof self=="object"&&self&&self.Object===Object&&self,ye=Tf||Fx||Function("return this")(),bu=t&&!t.nodeType&&t,Vn=bu&&!0&&i&&!i.nodeType&&i,Of=Vn&&Vn.exports===bu,Mu=Of&&Tf.process,yi=function(){try{var k=Vn&&Vn.require&&Vn.require("util").types;return k||Mu&&Mu.binding&&Mu.binding("util")}catch{}}(),If=yi&&yi.isArrayBuffer,Lf=yi&&yi.isDate,Pf=yi&&yi.isMap,Rf=yi&&yi.isRegExp,Ff=yi&&yi.isSet,$f=yi&&yi.isTypedArray;function si(k,L,T){switch(T.length){case 0:return k.call(L);case 1:return k.call(L,T[0]);case 2:return k.call(L,T[0],T[1]);case 3:return k.call(L,T[0],T[1],T[2])}return k.apply(L,T)}function $x(k,L,T,et){for(var yt=-1,Rt=k==null?0:k.length;++yt<Rt;){var ce=k[yt];L(et,ce,T(ce),k)}return et}function xi(k,L){for(var T=-1,et=k==null?0:k.length;++T<et&&L(k[T],T,k)!==!1;);return k}function Bx(k,L){for(var T=k==null?0:k.length;T--&&L(k[T],T,k)!==!1;);return k}function Bf(k,L){for(var T=-1,et=k==null?0:k.length;++T<et;)if(!L(k[T],T,k))return!1;return!0}function on(k,L){for(var T=-1,et=k==null?0:k.length,yt=0,Rt=[];++T<et;){var ce=k[T];L(ce,T,k)&&(Rt[yt++]=ce)}return Rt}function $a(k,L){var T=k==null?0:k.length;return!!T&&wr(k,L,0)>-1}function Eu(k,L,T){for(var et=-1,yt=k==null?0:k.length;++et<yt;)if(T(L,k[et]))return!0;return!1}function Zt(k,L){for(var T=-1,et=k==null?0:k.length,yt=Array(et);++T<et;)yt[T]=L(k[T],T,k);return yt}function an(k,L){for(var T=-1,et=L.length,yt=k.length;++T<et;)k[yt+T]=L[T];return k}function Su(k,L,T,et){var yt=-1,Rt=k==null?0:k.length;for(et&&Rt&&(T=k[++yt]);++yt<Rt;)T=L(T,k[yt],yt,k);return T}function Nx(k,L,T,et){var yt=k==null?0:k.length;for(et&&yt&&(T=k[--yt]);yt--;)T=L(T,k[yt],yt,k);return T}function Au(k,L){for(var T=-1,et=k==null?0:k.length;++T<et;)if(L(k[T],T,k))return!0;return!1}var Ux=ku("length");function Dx(k){return k.split("")}function Vx(k){return k.match(re)||[]}function Nf(k,L,T){var et;return T(k,function(yt,Rt,ce){if(L(yt,Rt,ce))return et=Rt,!1}),et}function Ba(k,L,T,et){for(var yt=k.length,Rt=T+(et?1:-1);et?Rt--:++Rt<yt;)if(L(k[Rt],Rt,k))return Rt;return-1}function wr(k,L,T){return L===L?tw(k,L,T):Ba(k,Uf,T)}function Hx(k,L,T,et){for(var yt=T-1,Rt=k.length;++yt<Rt;)if(et(k[yt],L))return yt;return-1}function Uf(k){return k!==k}function Df(k,L){var T=k==null?0:k.length;return T?zu(k,L)/T:mt}function ku(k){return function(L){return L==null?e:L[k]}}function Cu(k){return function(L){return k==null?e:k[L]}}function Vf(k,L,T,et,yt){return yt(k,function(Rt,ce,Vt){T=et?(et=!1,Rt):L(T,Rt,ce,Vt)}),T}function Wx(k,L){var T=k.length;for(k.sort(L);T--;)k[T]=k[T].value;return k}function zu(k,L){for(var T,et=-1,yt=k.length;++et<yt;){var Rt=L(k[et]);Rt!==e&&(T=T===e?Rt:T+Rt)}return T}function Tu(k,L){for(var T=-1,et=Array(k);++T<k;)et[T]=L(T);return et}function qx(k,L){return Zt(L,function(T){return[T,k[T]]})}function Hf(k){return k&&k.slice(0,Yf(k)+1).replace(Co,"")}function ni(k){return function(L){return k(L)}}function Ou(k,L){return Zt(L,function(T){return k[T]})}function Oo(k,L){return k.has(L)}function Wf(k,L){for(var T=-1,et=k.length;++T<et&&wr(L,k[T],0)>-1;);return T}function qf(k,L){for(var T=k.length;T--&&wr(L,k[T],0)>-1;);return T}function Gx(k,L){for(var T=k.length,et=0;T--;)k[T]===L&&++et;return et}var Yx=Cu(Tx),jx=Cu(Ox);function Zx(k){return"\\"+Lx[k]}function Xx(k,L){return k==null?e:k[L]}function _r(k){return Ax.test(k)}function Qx(k){return kx.test(k)}function Jx(k){for(var L,T=[];!(L=k.next()).done;)T.push(L.value);return T}function Iu(k){var L=-1,T=Array(k.size);return k.forEach(function(et,yt){T[++L]=[yt,et]}),T}function Gf(k,L){return function(T){return k(L(T))}}function ln(k,L){for(var T=-1,et=k.length,yt=0,Rt=[];++T<et;){var ce=k[T];(ce===L||ce===f)&&(k[T]=f,Rt[yt++]=T)}return Rt}function Na(k){var L=-1,T=Array(k.size);return k.forEach(function(et){T[++L]=et}),T}function Kx(k){var L=-1,T=Array(k.size);return k.forEach(function(et){T[++L]=[et,et]}),T}function tw(k,L,T){for(var et=T-1,yt=k.length;++et<yt;)if(k[et]===L)return et;return-1}function ew(k,L,T){for(var et=T+1;et--;)if(k[et]===L)return et;return et}function br(k){return _r(k)?sw(k):Ux(k)}function Di(k){return _r(k)?nw(k):Dx(k)}function Yf(k){for(var L=k.length;L--&&R.test(k.charAt(L)););return L}var iw=Cu(Ix);function sw(k){for(var L=_u.lastIndex=0;_u.test(k);)++L;return L}function nw(k){return k.match(_u)||[]}function rw(k){return k.match(Sx)||[]}var ow=function k(L){L=L==null?ye:Mr.defaults(ye.Object(),L,Mr.pick(ye,Cx));var T=L.Array,et=L.Date,yt=L.Error,Rt=L.Function,ce=L.Math,Vt=L.Object,Lu=L.RegExp,aw=L.String,wi=L.TypeError,Ua=T.prototype,lw=Rt.prototype,Er=Vt.prototype,Da=L["__core-js_shared__"],Va=lw.toString,Ut=Er.hasOwnProperty,hw=0,jf=function(){var n=/[^.]+$/.exec(Da&&Da.keys&&Da.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),Ha=Er.toString,uw=Va.call(Vt),cw=ye._,dw=Lu("^"+Va.call(Ut).replace(vr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wa=Of?L.Buffer:e,hn=L.Symbol,qa=L.Uint8Array,Zf=Wa?Wa.allocUnsafe:e,Ga=Gf(Vt.getPrototypeOf,Vt),Xf=Vt.create,Qf=Er.propertyIsEnumerable,Ya=Ua.splice,Jf=hn?hn.isConcatSpreadable:e,Io=hn?hn.iterator:e,Hn=hn?hn.toStringTag:e,ja=function(){try{var n=jn(Vt,"defineProperty");return n({},"",{}),n}catch{}}(),fw=L.clearTimeout!==ye.clearTimeout&&L.clearTimeout,pw=et&&et.now!==ye.Date.now&&et.now,mw=L.setTimeout!==ye.setTimeout&&L.setTimeout,Za=ce.ceil,Xa=ce.floor,Pu=Vt.getOwnPropertySymbols,gw=Wa?Wa.isBuffer:e,Kf=L.isFinite,vw=Ua.join,yw=Gf(Vt.keys,Vt),de=ce.max,Se=ce.min,xw=et.now,ww=L.parseInt,tp=ce.random,_w=Ua.reverse,Ru=jn(L,"DataView"),Lo=jn(L,"Map"),Fu=jn(L,"Promise"),Sr=jn(L,"Set"),Po=jn(L,"WeakMap"),Ro=jn(Vt,"create"),Qa=Po&&new Po,Ar={},bw=Zn(Ru),Mw=Zn(Lo),Ew=Zn(Fu),Sw=Zn(Sr),Aw=Zn(Po),Ja=hn?hn.prototype:e,Fo=Ja?Ja.valueOf:e,ep=Ja?Ja.toString:e;function w(n){if(te(n)&&!wt(n)&&!(n instanceof kt)){if(n instanceof _i)return n;if(Ut.call(n,"__wrapped__"))return im(n)}return new _i(n)}var kr=function(){function n(){}return function(o){if(!Jt(o))return{};if(Xf)return Xf(o);n.prototype=o;var h=new n;return n.prototype=e,h}}();function Ka(){}function _i(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}w.templateSettings={escape:cu,evaluate:du,interpolate:Ia,variable:"",imports:{_:w}},w.prototype=Ka.prototype,w.prototype.constructor=w,_i.prototype=kr(Ka.prototype),_i.prototype.constructor=_i;function kt(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Tt,this.__views__=[]}function kw(){var n=new kt(this.__wrapped__);return n.__actions__=Ye(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=Ye(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=Ye(this.__views__),n}function Cw(){if(this.__filtered__){var n=new kt(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function zw(){var n=this.__wrapped__.value(),o=this.__dir__,h=wt(n),p=o<0,y=h?n.length:0,_=D_(0,y,this.__views__),M=_.start,A=_.end,C=A-M,F=p?A:M-1,B=this.__iteratees__,D=B.length,Q=0,rt=Se(C,this.__takeCount__);if(!h||!p&&y==C&&rt==C)return Sp(n,this.__actions__);var dt=[];t:for(;C--&&Q<rt;){F+=o;for(var Et=-1,ft=n[F];++Et<D;){var At=B[Et],It=At.iteratee,ai=At.type,Be=It(ft);if(ai==tt)ft=Be;else if(!Be){if(ai==Ft)continue t;break t}}dt[Q++]=ft}return dt}kt.prototype=kr(Ka.prototype),kt.prototype.constructor=kt;function Wn(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var p=n[o];this.set(p[0],p[1])}}function Tw(){this.__data__=Ro?Ro(null):{},this.size=0}function Ow(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function Iw(n){var o=this.__data__;if(Ro){var h=o[n];return h===c?e:h}return Ut.call(o,n)?o[n]:e}function Lw(n){var o=this.__data__;return Ro?o[n]!==e:Ut.call(o,n)}function Pw(n,o){var h=this.__data__;return this.size+=this.has(n)?0:1,h[n]=Ro&&o===e?c:o,this}Wn.prototype.clear=Tw,Wn.prototype.delete=Ow,Wn.prototype.get=Iw,Wn.prototype.has=Lw,Wn.prototype.set=Pw;function Is(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var p=n[o];this.set(p[0],p[1])}}function Rw(){this.__data__=[],this.size=0}function Fw(n){var o=this.__data__,h=tl(o,n);if(h<0)return!1;var p=o.length-1;return h==p?o.pop():Ya.call(o,h,1),--this.size,!0}function $w(n){var o=this.__data__,h=tl(o,n);return h<0?e:o[h][1]}function Bw(n){return tl(this.__data__,n)>-1}function Nw(n,o){var h=this.__data__,p=tl(h,n);return p<0?(++this.size,h.push([n,o])):h[p][1]=o,this}Is.prototype.clear=Rw,Is.prototype.delete=Fw,Is.prototype.get=$w,Is.prototype.has=Bw,Is.prototype.set=Nw;function Ls(n){var o=-1,h=n==null?0:n.length;for(this.clear();++o<h;){var p=n[o];this.set(p[0],p[1])}}function Uw(){this.size=0,this.__data__={hash:new Wn,map:new(Lo||Is),string:new Wn}}function Dw(n){var o=dl(this,n).delete(n);return this.size-=o?1:0,o}function Vw(n){return dl(this,n).get(n)}function Hw(n){return dl(this,n).has(n)}function Ww(n,o){var h=dl(this,n),p=h.size;return h.set(n,o),this.size+=h.size==p?0:1,this}Ls.prototype.clear=Uw,Ls.prototype.delete=Dw,Ls.prototype.get=Vw,Ls.prototype.has=Hw,Ls.prototype.set=Ww;function qn(n){var o=-1,h=n==null?0:n.length;for(this.__data__=new Ls;++o<h;)this.add(n[o])}function qw(n){return this.__data__.set(n,c),this}function Gw(n){return this.__data__.has(n)}qn.prototype.add=qn.prototype.push=qw,qn.prototype.has=Gw;function Vi(n){var o=this.__data__=new Is(n);this.size=o.size}function Yw(){this.__data__=new Is,this.size=0}function jw(n){var o=this.__data__,h=o.delete(n);return this.size=o.size,h}function Zw(n){return this.__data__.get(n)}function Xw(n){return this.__data__.has(n)}function Qw(n,o){var h=this.__data__;if(h instanceof Is){var p=h.__data__;if(!Lo||p.length<r-1)return p.push([n,o]),this.size=++h.size,this;h=this.__data__=new Ls(p)}return h.set(n,o),this.size=h.size,this}Vi.prototype.clear=Yw,Vi.prototype.delete=jw,Vi.prototype.get=Zw,Vi.prototype.has=Xw,Vi.prototype.set=Qw;function ip(n,o){var h=wt(n),p=!h&&Xn(n),y=!h&&!p&&pn(n),_=!h&&!p&&!y&&Or(n),M=h||p||y||_,A=M?Tu(n.length,aw):[],C=A.length;for(var F in n)(o||Ut.call(n,F))&&!(M&&(F=="length"||y&&(F=="offset"||F=="parent")||_&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||$s(F,C)))&&A.push(F);return A}function sp(n){var o=n.length;return o?n[Yu(0,o-1)]:e}function Jw(n,o){return fl(Ye(n),Gn(o,0,n.length))}function Kw(n){return fl(Ye(n))}function $u(n,o,h){(h!==e&&!Hi(n[o],h)||h===e&&!(o in n))&&Ps(n,o,h)}function $o(n,o,h){var p=n[o];(!(Ut.call(n,o)&&Hi(p,h))||h===e&&!(o in n))&&Ps(n,o,h)}function tl(n,o){for(var h=n.length;h--;)if(Hi(n[h][0],o))return h;return-1}function t_(n,o,h,p){return un(n,function(y,_,M){o(p,y,h(y),M)}),p}function np(n,o){return n&&us(o,pe(o),n)}function e_(n,o){return n&&us(o,Ze(o),n)}function Ps(n,o,h){o=="__proto__"&&ja?ja(n,o,{configurable:!0,enumerable:!0,value:h,writable:!0}):n[o]=h}function Bu(n,o){for(var h=-1,p=o.length,y=T(p),_=n==null;++h<p;)y[h]=_?e:yc(n,o[h]);return y}function Gn(n,o,h){return n===n&&(h!==e&&(n=n<=h?n:h),o!==e&&(n=n>=o?n:o)),n}function bi(n,o,h,p,y,_){var M,A=o&m,C=o&g,F=o&v;if(h&&(M=y?h(n,p,y,_):h(n)),M!==e)return M;if(!Jt(n))return n;var B=wt(n);if(B){if(M=H_(n),!A)return Ye(n,M)}else{var D=Ae(n),Q=D==sn||D==Rn;if(pn(n))return Cp(n,A);if(D==qe||D==X||Q&&!y){if(M=C||Q?{}:Yp(n),!A)return C?I_(n,e_(M,n)):O_(n,np(M,n))}else{if(!Ht[D])return y?n:{};M=W_(n,D,A)}}_||(_=new Vi);var rt=_.get(n);if(rt)return rt;_.set(n,M),bm(n)?n.forEach(function(ft){M.add(bi(ft,o,h,ft,n,_))}):wm(n)&&n.forEach(function(ft,At){M.set(At,bi(ft,o,h,At,n,_))});var dt=F?C?nc:sc:C?Ze:pe,Et=B?e:dt(n);return xi(Et||n,function(ft,At){Et&&(At=ft,ft=n[At]),$o(M,At,bi(ft,o,h,At,n,_))}),M}function i_(n){var o=pe(n);return function(h){return rp(h,n,o)}}function rp(n,o,h){var p=h.length;if(n==null)return!p;for(n=Vt(n);p--;){var y=h[p],_=o[y],M=n[y];if(M===e&&!(y in n)||!_(M))return!1}return!0}function op(n,o,h){if(typeof n!="function")throw new wi(l);return Wo(function(){n.apply(e,h)},o)}function Bo(n,o,h,p){var y=-1,_=$a,M=!0,A=n.length,C=[],F=o.length;if(!A)return C;h&&(o=Zt(o,ni(h))),p?(_=Eu,M=!1):o.length>=r&&(_=Oo,M=!1,o=new qn(o));t:for(;++y<A;){var B=n[y],D=h==null?B:h(B);if(B=p||B!==0?B:0,M&&D===D){for(var Q=F;Q--;)if(o[Q]===D)continue t;C.push(B)}else _(o,D,p)||C.push(B)}return C}var un=Lp(hs),ap=Lp(Uu,!0);function s_(n,o){var h=!0;return un(n,function(p,y,_){return h=!!o(p,y,_),h}),h}function el(n,o,h){for(var p=-1,y=n.length;++p<y;){var _=n[p],M=o(_);if(M!=null&&(A===e?M===M&&!oi(M):h(M,A)))var A=M,C=_}return C}function n_(n,o,h,p){var y=n.length;for(h=bt(h),h<0&&(h=-h>y?0:y+h),p=p===e||p>y?y:bt(p),p<0&&(p+=y),p=h>p?0:Em(p);h<p;)n[h++]=o;return n}function lp(n,o){var h=[];return un(n,function(p,y,_){o(p,y,_)&&h.push(p)}),h}function xe(n,o,h,p,y){var _=-1,M=n.length;for(h||(h=G_),y||(y=[]);++_<M;){var A=n[_];o>0&&h(A)?o>1?xe(A,o-1,h,p,y):an(y,A):p||(y[y.length]=A)}return y}var Nu=Pp(),hp=Pp(!0);function hs(n,o){return n&&Nu(n,o,pe)}function Uu(n,o){return n&&hp(n,o,pe)}function il(n,o){return on(o,function(h){return Bs(n[h])})}function Yn(n,o){o=dn(o,n);for(var h=0,p=o.length;n!=null&&h<p;)n=n[cs(o[h++])];return h&&h==p?n:e}function up(n,o,h){var p=o(n);return wt(n)?p:an(p,h(n))}function Fe(n){return n==null?n===e?Eo:Fn:Hn&&Hn in Vt(n)?U_(n):K_(n)}function Du(n,o){return n>o}function r_(n,o){return n!=null&&Ut.call(n,o)}function o_(n,o){return n!=null&&o in Vt(n)}function a_(n,o,h){return n>=Se(o,h)&&n<de(o,h)}function Vu(n,o,h){for(var p=h?Eu:$a,y=n[0].length,_=n.length,M=_,A=T(_),C=1/0,F=[];M--;){var B=n[M];M&&o&&(B=Zt(B,ni(o))),C=Se(B.length,C),A[M]=!h&&(o||y>=120&&B.length>=120)?new qn(M&&B):e}B=n[0];var D=-1,Q=A[0];t:for(;++D<y&&F.length<C;){var rt=B[D],dt=o?o(rt):rt;if(rt=h||rt!==0?rt:0,!(Q?Oo(Q,dt):p(F,dt,h))){for(M=_;--M;){var Et=A[M];if(!(Et?Oo(Et,dt):p(n[M],dt,h)))continue t}Q&&Q.push(dt),F.push(rt)}}return F}function l_(n,o,h,p){return hs(n,function(y,_,M){o(p,h(y),_,M)}),p}function No(n,o,h){o=dn(o,n),n=Qp(n,o);var p=n==null?n:n[cs(Ei(o))];return p==null?e:si(p,n,h)}function cp(n){return te(n)&&Fe(n)==X}function h_(n){return te(n)&&Fe(n)==Ui}function u_(n){return te(n)&&Fe(n)==Ni}function Uo(n,o,h,p,y){return n===o?!0:n==null||o==null||!te(n)&&!te(o)?n!==n&&o!==o:c_(n,o,h,p,Uo,y)}function c_(n,o,h,p,y,_){var M=wt(n),A=wt(o),C=M?Dt:Ae(n),F=A?Dt:Ae(o);C=C==X?qe:C,F=F==X?qe:F;var B=C==qe,D=F==qe,Q=C==F;if(Q&&pn(n)){if(!pn(o))return!1;M=!0,B=!1}if(Q&&!B)return _||(_=new Vi),M||Or(n)?Wp(n,o,h,p,y,_):B_(n,o,C,h,p,y,_);if(!(h&x)){var rt=B&&Ut.call(n,"__wrapped__"),dt=D&&Ut.call(o,"__wrapped__");if(rt||dt){var Et=rt?n.value():n,ft=dt?o.value():o;return _||(_=new Vi),y(Et,ft,h,p,_)}}return Q?(_||(_=new Vi),N_(n,o,h,p,y,_)):!1}function d_(n){return te(n)&&Ae(n)==Ee}function Hu(n,o,h,p){var y=h.length,_=y,M=!p;if(n==null)return!_;for(n=Vt(n);y--;){var A=h[y];if(M&&A[2]?A[1]!==n[A[0]]:!(A[0]in n))return!1}for(;++y<_;){A=h[y];var C=A[0],F=n[C],B=A[1];if(M&&A[2]){if(F===e&&!(C in n))return!1}else{var D=new Vi;if(p)var Q=p(F,B,C,n,o,D);if(!(Q===e?Uo(B,F,x|b,p,D):Q))return!1}}return!0}function dp(n){if(!Jt(n)||j_(n))return!1;var o=Bs(n)?dw:La;return o.test(Zn(n))}function f_(n){return te(n)&&Fe(n)==ns}function p_(n){return te(n)&&Ae(n)==Re}function m_(n){return te(n)&&xl(n.length)&&!!Gt[Fe(n)]}function fp(n){return typeof n=="function"?n:n==null?Xe:typeof n=="object"?wt(n)?gp(n[0],n[1]):mp(n):Rm(n)}function Wu(n){if(!Ho(n))return yw(n);var o=[];for(var h in Vt(n))Ut.call(n,h)&&h!="constructor"&&o.push(h);return o}function g_(n){if(!Jt(n))return J_(n);var o=Ho(n),h=[];for(var p in n)p=="constructor"&&(o||!Ut.call(n,p))||h.push(p);return h}function qu(n,o){return n<o}function pp(n,o){var h=-1,p=je(n)?T(n.length):[];return un(n,function(y,_,M){p[++h]=o(y,_,M)}),p}function mp(n){var o=oc(n);return o.length==1&&o[0][2]?Zp(o[0][0],o[0][1]):function(h){return h===n||Hu(h,n,o)}}function gp(n,o){return lc(n)&&jp(o)?Zp(cs(n),o):function(h){var p=yc(h,n);return p===e&&p===o?xc(h,n):Uo(o,p,x|b)}}function sl(n,o,h,p,y){n!==o&&Nu(o,function(_,M){if(y||(y=new Vi),Jt(_))v_(n,o,M,h,sl,p,y);else{var A=p?p(uc(n,M),_,M+"",n,o,y):e;A===e&&(A=_),$u(n,M,A)}},Ze)}function v_(n,o,h,p,y,_,M){var A=uc(n,h),C=uc(o,h),F=M.get(C);if(F){$u(n,h,F);return}var B=_?_(A,C,h+"",n,o,M):e,D=B===e;if(D){var Q=wt(C),rt=!Q&&pn(C),dt=!Q&&!rt&&Or(C);B=C,Q||rt||dt?wt(A)?B=A:ie(A)?B=Ye(A):rt?(D=!1,B=Cp(C,!0)):dt?(D=!1,B=zp(C,!0)):B=[]:qo(C)||Xn(C)?(B=A,Xn(A)?B=Sm(A):(!Jt(A)||Bs(A))&&(B=Yp(C))):D=!1}D&&(M.set(C,B),y(B,C,p,_,M),M.delete(C)),$u(n,h,B)}function vp(n,o){var h=n.length;if(!!h)return o+=o<0?h:0,$s(o,h)?n[o]:e}function yp(n,o,h){o.length?o=Zt(o,function(_){return wt(_)?function(M){return Yn(M,_.length===1?_[0]:_)}:_}):o=[Xe];var p=-1;o=Zt(o,ni(ct()));var y=pp(n,function(_,M,A){var C=Zt(o,function(F){return F(_)});return{criteria:C,index:++p,value:_}});return Wx(y,function(_,M){return T_(_,M,h)})}function y_(n,o){return xp(n,o,function(h,p){return xc(n,p)})}function xp(n,o,h){for(var p=-1,y=o.length,_={};++p<y;){var M=o[p],A=Yn(n,M);h(A,M)&&Do(_,dn(M,n),A)}return _}function x_(n){return function(o){return Yn(o,n)}}function Gu(n,o,h,p){var y=p?Hx:wr,_=-1,M=o.length,A=n;for(n===o&&(o=Ye(o)),h&&(A=Zt(n,ni(h)));++_<M;)for(var C=0,F=o[_],B=h?h(F):F;(C=y(A,B,C,p))>-1;)A!==n&&Ya.call(A,C,1),Ya.call(n,C,1);return n}function wp(n,o){for(var h=n?o.length:0,p=h-1;h--;){var y=o[h];if(h==p||y!==_){var _=y;$s(y)?Ya.call(n,y,1):Xu(n,y)}}return n}function Yu(n,o){return n+Xa(tp()*(o-n+1))}function w_(n,o,h,p){for(var y=-1,_=de(Za((o-n)/(h||1)),0),M=T(_);_--;)M[p?_:++y]=n,n+=h;return M}function ju(n,o){var h="";if(!n||o<1||o>J)return h;do o%2&&(h+=n),o=Xa(o/2),o&&(n+=n);while(o);return h}function St(n,o){return cc(Xp(n,o,Xe),n+"")}function __(n){return sp(Ir(n))}function b_(n,o){var h=Ir(n);return fl(h,Gn(o,0,h.length))}function Do(n,o,h,p){if(!Jt(n))return n;o=dn(o,n);for(var y=-1,_=o.length,M=_-1,A=n;A!=null&&++y<_;){var C=cs(o[y]),F=h;if(C==="__proto__"||C==="constructor"||C==="prototype")return n;if(y!=M){var B=A[C];F=p?p(B,C,A):e,F===e&&(F=Jt(B)?B:$s(o[y+1])?[]:{})}$o(A,C,F),A=A[C]}return n}var _p=Qa?function(n,o){return Qa.set(n,o),n}:Xe,M_=ja?function(n,o){return ja(n,"toString",{configurable:!0,enumerable:!1,value:_c(o),writable:!0})}:Xe;function E_(n){return fl(Ir(n))}function Mi(n,o,h){var p=-1,y=n.length;o<0&&(o=-o>y?0:y+o),h=h>y?y:h,h<0&&(h+=y),y=o>h?0:h-o>>>0,o>>>=0;for(var _=T(y);++p<y;)_[p]=n[p+o];return _}function S_(n,o){var h;return un(n,function(p,y,_){return h=o(p,y,_),!h}),!!h}function nl(n,o,h){var p=0,y=n==null?p:n.length;if(typeof o=="number"&&o===o&&y<=mi){for(;p<y;){var _=p+y>>>1,M=n[_];M!==null&&!oi(M)&&(h?M<=o:M<o)?p=_+1:y=_}return y}return Zu(n,o,Xe,h)}function Zu(n,o,h,p){var y=0,_=n==null?0:n.length;if(_===0)return 0;o=h(o);for(var M=o!==o,A=o===null,C=oi(o),F=o===e;y<_;){var B=Xa((y+_)/2),D=h(n[B]),Q=D!==e,rt=D===null,dt=D===D,Et=oi(D);if(M)var ft=p||dt;else F?ft=dt&&(p||Q):A?ft=dt&&Q&&(p||!rt):C?ft=dt&&Q&&!rt&&(p||!Et):rt||Et?ft=!1:ft=p?D<=o:D<o;ft?y=B+1:_=B}return Se(_,ss)}function bp(n,o){for(var h=-1,p=n.length,y=0,_=[];++h<p;){var M=n[h],A=o?o(M):M;if(!h||!Hi(A,C)){var C=A;_[y++]=M===0?0:M}}return _}function Mp(n){return typeof n=="number"?n:oi(n)?mt:+n}function ri(n){if(typeof n=="string")return n;if(wt(n))return Zt(n,ri)+"";if(oi(n))return ep?ep.call(n):"";var o=n+"";return o=="0"&&1/n==-V?"-0":o}function cn(n,o,h){var p=-1,y=$a,_=n.length,M=!0,A=[],C=A;if(h)M=!1,y=Eu;else if(_>=r){var F=o?null:F_(n);if(F)return Na(F);M=!1,y=Oo,C=new qn}else C=o?[]:A;t:for(;++p<_;){var B=n[p],D=o?o(B):B;if(B=h||B!==0?B:0,M&&D===D){for(var Q=C.length;Q--;)if(C[Q]===D)continue t;o&&C.push(D),A.push(B)}else y(C,D,h)||(C!==A&&C.push(D),A.push(B))}return A}function Xu(n,o){return o=dn(o,n),n=Qp(n,o),n==null||delete n[cs(Ei(o))]}function Ep(n,o,h,p){return Do(n,o,h(Yn(n,o)),p)}function rl(n,o,h,p){for(var y=n.length,_=p?y:-1;(p?_--:++_<y)&&o(n[_],_,n););return h?Mi(n,p?0:_,p?_+1:y):Mi(n,p?_+1:0,p?y:_)}function Sp(n,o){var h=n;return h instanceof kt&&(h=h.value()),Su(o,function(p,y){return y.func.apply(y.thisArg,an([p],y.args))},h)}function Qu(n,o,h){var p=n.length;if(p<2)return p?cn(n[0]):[];for(var y=-1,_=T(p);++y<p;)for(var M=n[y],A=-1;++A<p;)A!=y&&(_[y]=Bo(_[y]||M,n[A],o,h));return cn(xe(_,1),o,h)}function Ap(n,o,h){for(var p=-1,y=n.length,_=o.length,M={};++p<y;){var A=p<_?o[p]:e;h(M,n[p],A)}return M}function Ju(n){return ie(n)?n:[]}function Ku(n){return typeof n=="function"?n:Xe}function dn(n,o){return wt(n)?n:lc(n,o)?[n]:em($t(n))}var A_=St;function fn(n,o,h){var p=n.length;return h=h===e?p:h,!o&&h>=p?n:Mi(n,o,h)}var kp=fw||function(n){return ye.clearTimeout(n)};function Cp(n,o){if(o)return n.slice();var h=n.length,p=Zf?Zf(h):new n.constructor(h);return n.copy(p),p}function tc(n){var o=new n.constructor(n.byteLength);return new qa(o).set(new qa(n)),o}function k_(n,o){var h=o?tc(n.buffer):n.buffer;return new n.constructor(h,n.byteOffset,n.byteLength)}function C_(n){var o=new n.constructor(n.source,Ts.exec(n));return o.lastIndex=n.lastIndex,o}function z_(n){return Fo?Vt(Fo.call(n)):{}}function zp(n,o){var h=o?tc(n.buffer):n.buffer;return new n.constructor(h,n.byteOffset,n.length)}function Tp(n,o){if(n!==o){var h=n!==e,p=n===null,y=n===n,_=oi(n),M=o!==e,A=o===null,C=o===o,F=oi(o);if(!A&&!F&&!_&&n>o||_&&M&&C&&!A&&!F||p&&M&&C||!h&&C||!y)return 1;if(!p&&!_&&!F&&n<o||F&&h&&y&&!p&&!_||A&&h&&y||!M&&y||!C)return-1}return 0}function T_(n,o,h){for(var p=-1,y=n.criteria,_=o.criteria,M=y.length,A=h.length;++p<M;){var C=Tp(y[p],_[p]);if(C){if(p>=A)return C;var F=h[p];return C*(F=="desc"?-1:1)}}return n.index-o.index}function Op(n,o,h,p){for(var y=-1,_=n.length,M=h.length,A=-1,C=o.length,F=de(_-M,0),B=T(C+F),D=!p;++A<C;)B[A]=o[A];for(;++y<M;)(D||y<_)&&(B[h[y]]=n[y]);for(;F--;)B[A++]=n[y++];return B}function Ip(n,o,h,p){for(var y=-1,_=n.length,M=-1,A=h.length,C=-1,F=o.length,B=de(_-A,0),D=T(B+F),Q=!p;++y<B;)D[y]=n[y];for(var rt=y;++C<F;)D[rt+C]=o[C];for(;++M<A;)(Q||y<_)&&(D[rt+h[M]]=n[y++]);return D}function Ye(n,o){var h=-1,p=n.length;for(o||(o=T(p));++h<p;)o[h]=n[h];return o}function us(n,o,h,p){var y=!h;h||(h={});for(var _=-1,M=o.length;++_<M;){var A=o[_],C=p?p(h[A],n[A],A,h,n):e;C===e&&(C=n[A]),y?Ps(h,A,C):$o(h,A,C)}return h}function O_(n,o){return us(n,ac(n),o)}function I_(n,o){return us(n,qp(n),o)}function ol(n,o){return function(h,p){var y=wt(h)?$x:t_,_=o?o():{};return y(h,n,ct(p,2),_)}}function Cr(n){return St(function(o,h){var p=-1,y=h.length,_=y>1?h[y-1]:e,M=y>2?h[2]:e;for(_=n.length>3&&typeof _=="function"?(y--,_):e,M&&$e(h[0],h[1],M)&&(_=y<3?e:_,y=1),o=Vt(o);++p<y;){var A=h[p];A&&n(o,A,p,_)}return o})}function Lp(n,o){return function(h,p){if(h==null)return h;if(!je(h))return n(h,p);for(var y=h.length,_=o?y:-1,M=Vt(h);(o?_--:++_<y)&&p(M[_],_,M)!==!1;);return h}}function Pp(n){return function(o,h,p){for(var y=-1,_=Vt(o),M=p(o),A=M.length;A--;){var C=M[n?A:++y];if(h(_[C],C,_)===!1)break}return o}}function L_(n,o,h){var p=o&E,y=Vo(n);function _(){var M=this&&this!==ye&&this instanceof _?y:n;return M.apply(p?h:this,arguments)}return _}function Rp(n){return function(o){o=$t(o);var h=_r(o)?Di(o):e,p=h?h[0]:o.charAt(0),y=h?fn(h,1).join(""):o.slice(1);return p[n]()+y}}function zr(n){return function(o){return Su(Lm(Im(o).replace(Mx,"")),n,"")}}function Vo(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var h=kr(n.prototype),p=n.apply(h,o);return Jt(p)?p:h}}function P_(n,o,h){var p=Vo(n);function y(){for(var _=arguments.length,M=T(_),A=_,C=Tr(y);A--;)M[A]=arguments[A];var F=_<3&&M[0]!==C&&M[_-1]!==C?[]:ln(M,C);if(_-=F.length,_<h)return Up(n,o,al,y.placeholder,e,M,F,e,e,h-_);var B=this&&this!==ye&&this instanceof y?p:n;return si(B,this,M)}return y}function Fp(n){return function(o,h,p){var y=Vt(o);if(!je(o)){var _=ct(h,3);o=pe(o),h=function(A){return _(y[A],A,y)}}var M=n(o,h,p);return M>-1?y[_?o[M]:M]:e}}function $p(n){return Fs(function(o){var h=o.length,p=h,y=_i.prototype.thru;for(n&&o.reverse();p--;){var _=o[p];if(typeof _!="function")throw new wi(l);if(y&&!M&&cl(_)=="wrapper")var M=new _i([],!0)}for(p=M?p:h;++p<h;){_=o[p];var A=cl(_),C=A=="wrapper"?rc(_):e;C&&hc(C[0])&&C[1]==($|I|P|_t)&&!C[4].length&&C[9]==1?M=M[cl(C[0])].apply(M,C[3]):M=_.length==1&&hc(_)?M[A]():M.thru(_)}return function(){var F=arguments,B=F[0];if(M&&F.length==1&&wt(B))return M.plant(B).value();for(var D=0,Q=h?o[D].apply(this,F):B;++D<h;)Q=o[D].call(this,Q);return Q}})}function al(n,o,h,p,y,_,M,A,C,F){var B=o&$,D=o&E,Q=o&S,rt=o&(I|O),dt=o&zt,Et=Q?e:Vo(n);function ft(){for(var At=arguments.length,It=T(At),ai=At;ai--;)It[ai]=arguments[ai];if(rt)var Be=Tr(ft),li=Gx(It,Be);if(p&&(It=Op(It,p,y,rt)),_&&(It=Ip(It,_,M,rt)),At-=li,rt&&At<F){var se=ln(It,Be);return Up(n,o,al,ft.placeholder,h,It,se,A,C,F-At)}var Wi=D?h:this,Us=Q?Wi[n]:n;return At=It.length,A?It=tb(It,A):dt&&At>1&&It.reverse(),B&&C<At&&(It.length=C),this&&this!==ye&&this instanceof ft&&(Us=Et||Vo(Us)),Us.apply(Wi,It)}return ft}function Bp(n,o){return function(h,p){return l_(h,n,o(p),{})}}function ll(n,o){return function(h,p){var y;if(h===e&&p===e)return o;if(h!==e&&(y=h),p!==e){if(y===e)return p;typeof h=="string"||typeof p=="string"?(h=ri(h),p=ri(p)):(h=Mp(h),p=Mp(p)),y=n(h,p)}return y}}function ec(n){return Fs(function(o){return o=Zt(o,ni(ct())),St(function(h){var p=this;return n(o,function(y){return si(y,p,h)})})})}function hl(n,o){o=o===e?" ":ri(o);var h=o.length;if(h<2)return h?ju(o,n):o;var p=ju(o,Za(n/br(o)));return _r(o)?fn(Di(p),0,n).join(""):p.slice(0,n)}function R_(n,o,h,p){var y=o&E,_=Vo(n);function M(){for(var A=-1,C=arguments.length,F=-1,B=p.length,D=T(B+C),Q=this&&this!==ye&&this instanceof M?_:n;++F<B;)D[F]=p[F];for(;C--;)D[F++]=arguments[++A];return si(Q,y?h:this,D)}return M}function Np(n){return function(o,h,p){return p&&typeof p!="number"&&$e(o,h,p)&&(h=p=e),o=Ns(o),h===e?(h=o,o=0):h=Ns(h),p=p===e?o<h?1:-1:Ns(p),w_(o,h,p,n)}}function ul(n){return function(o,h){return typeof o=="string"&&typeof h=="string"||(o=Si(o),h=Si(h)),n(o,h)}}function Up(n,o,h,p,y,_,M,A,C,F){var B=o&I,D=B?M:e,Q=B?e:M,rt=B?_:e,dt=B?e:_;o|=B?P:G,o&=~(B?G:P),o&z||(o&=~(E|S));var Et=[n,o,y,rt,D,dt,Q,A,C,F],ft=h.apply(e,Et);return hc(n)&&Jp(ft,Et),ft.placeholder=p,Kp(ft,n,o)}function ic(n){var o=ce[n];return function(h,p){if(h=Si(h),p=p==null?0:Se(bt(p),292),p&&Kf(h)){var y=($t(h)+"e").split("e"),_=o(y[0]+"e"+(+y[1]+p));return y=($t(_)+"e").split("e"),+(y[0]+"e"+(+y[1]-p))}return o(h)}}var F_=Sr&&1/Na(new Sr([,-0]))[1]==V?function(n){return new Sr(n)}:Ec;function Dp(n){return function(o){var h=Ae(o);return h==Ee?Iu(o):h==Re?Kx(o):qx(o,n(o))}}function Rs(n,o,h,p,y,_,M,A){var C=o&S;if(!C&&typeof n!="function")throw new wi(l);var F=p?p.length:0;if(F||(o&=~(P|G),p=y=e),M=M===e?M:de(bt(M),0),A=A===e?A:bt(A),F-=y?y.length:0,o&G){var B=p,D=y;p=y=e}var Q=C?e:rc(n),rt=[n,o,h,p,y,B,D,_,M,A];if(Q&&Q_(rt,Q),n=rt[0],o=rt[1],h=rt[2],p=rt[3],y=rt[4],A=rt[9]=rt[9]===e?C?0:n.length:de(rt[9]-F,0),!A&&o&(I|O)&&(o&=~(I|O)),!o||o==E)var dt=L_(n,o,h);else o==I||o==O?dt=P_(n,o,A):(o==P||o==(E|P))&&!y.length?dt=R_(n,o,h,p):dt=al.apply(e,rt);var Et=Q?_p:Jp;return Kp(Et(dt,rt),n,o)}function Vp(n,o,h,p){return n===e||Hi(n,Er[h])&&!Ut.call(p,h)?o:n}function Hp(n,o,h,p,y,_){return Jt(n)&&Jt(o)&&(_.set(o,n),sl(n,o,e,Hp,_),_.delete(o)),n}function $_(n){return qo(n)?e:n}function Wp(n,o,h,p,y,_){var M=h&x,A=n.length,C=o.length;if(A!=C&&!(M&&C>A))return!1;var F=_.get(n),B=_.get(o);if(F&&B)return F==o&&B==n;var D=-1,Q=!0,rt=h&b?new qn:e;for(_.set(n,o),_.set(o,n);++D<A;){var dt=n[D],Et=o[D];if(p)var ft=M?p(Et,dt,D,o,n,_):p(dt,Et,D,n,o,_);if(ft!==e){if(ft)continue;Q=!1;break}if(rt){if(!Au(o,function(At,It){if(!Oo(rt,It)&&(dt===At||y(dt,At,h,p,_)))return rt.push(It)})){Q=!1;break}}else if(!(dt===Et||y(dt,Et,h,p,_))){Q=!1;break}}return _.delete(n),_.delete(o),Q}function B_(n,o,h,p,y,_,M){switch(h){case os:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case Ui:return!(n.byteLength!=o.byteLength||!_(new qa(n),new qa(o)));case We:case Ni:case gi:return Hi(+n,+o);case Pe:return n.name==o.name&&n.message==o.message;case ns:case As:return n==o+"";case Ee:var A=Iu;case Re:var C=p&x;if(A||(A=Na),n.size!=o.size&&!C)return!1;var F=M.get(n);if(F)return F==o;p|=b,M.set(n,o);var B=Wp(A(n),A(o),p,y,_,M);return M.delete(n),B;case nn:if(Fo)return Fo.call(n)==Fo.call(o)}return!1}function N_(n,o,h,p,y,_){var M=h&x,A=sc(n),C=A.length,F=sc(o),B=F.length;if(C!=B&&!M)return!1;for(var D=C;D--;){var Q=A[D];if(!(M?Q in o:Ut.call(o,Q)))return!1}var rt=_.get(n),dt=_.get(o);if(rt&&dt)return rt==o&&dt==n;var Et=!0;_.set(n,o),_.set(o,n);for(var ft=M;++D<C;){Q=A[D];var At=n[Q],It=o[Q];if(p)var ai=M?p(It,At,Q,o,n,_):p(At,It,Q,n,o,_);if(!(ai===e?At===It||y(At,It,h,p,_):ai)){Et=!1;break}ft||(ft=Q=="constructor")}if(Et&&!ft){var Be=n.constructor,li=o.constructor;Be!=li&&"constructor"in n&&"constructor"in o&&!(typeof Be=="function"&&Be instanceof Be&&typeof li=="function"&&li instanceof li)&&(Et=!1)}return _.delete(n),_.delete(o),Et}function Fs(n){return cc(Xp(n,e,rm),n+"")}function sc(n){return up(n,pe,ac)}function nc(n){return up(n,Ze,qp)}var rc=Qa?function(n){return Qa.get(n)}:Ec;function cl(n){for(var o=n.name+"",h=Ar[o],p=Ut.call(Ar,o)?h.length:0;p--;){var y=h[p],_=y.func;if(_==null||_==n)return y.name}return o}function Tr(n){var o=Ut.call(w,"placeholder")?w:n;return o.placeholder}function ct(){var n=w.iteratee||bc;return n=n===bc?fp:n,arguments.length?n(arguments[0],arguments[1]):n}function dl(n,o){var h=n.__data__;return Y_(o)?h[typeof o=="string"?"string":"hash"]:h.map}function oc(n){for(var o=pe(n),h=o.length;h--;){var p=o[h],y=n[p];o[h]=[p,y,jp(y)]}return o}function jn(n,o){var h=Xx(n,o);return dp(h)?h:e}function U_(n){var o=Ut.call(n,Hn),h=n[Hn];try{n[Hn]=e;var p=!0}catch{}var y=Ha.call(n);return p&&(o?n[Hn]=h:delete n[Hn]),y}var ac=Pu?function(n){return n==null?[]:(n=Vt(n),on(Pu(n),function(o){return Qf.call(n,o)}))}:Sc,qp=Pu?function(n){for(var o=[];n;)an(o,ac(n)),n=Ga(n);return o}:Sc,Ae=Fe;(Ru&&Ae(new Ru(new ArrayBuffer(1)))!=os||Lo&&Ae(new Lo)!=Ee||Fu&&Ae(Fu.resolve())!=Ss||Sr&&Ae(new Sr)!=Re||Po&&Ae(new Po)!=rs)&&(Ae=function(n){var o=Fe(n),h=o==qe?n.constructor:e,p=h?Zn(h):"";if(p)switch(p){case bw:return os;case Mw:return Ee;case Ew:return Ss;case Sw:return Re;case Aw:return rs}return o});function D_(n,o,h){for(var p=-1,y=h.length;++p<y;){var _=h[p],M=_.size;switch(_.type){case"drop":n+=M;break;case"dropRight":o-=M;break;case"take":o=Se(o,n+M);break;case"takeRight":n=de(n,o-M);break}}return{start:n,end:o}}function V_(n){var o=n.match(at);return o?o[1].split(Ot):[]}function Gp(n,o,h){o=dn(o,n);for(var p=-1,y=o.length,_=!1;++p<y;){var M=cs(o[p]);if(!(_=n!=null&&h(n,M)))break;n=n[M]}return _||++p!=y?_:(y=n==null?0:n.length,!!y&&xl(y)&&$s(M,y)&&(wt(n)||Xn(n)))}function H_(n){var o=n.length,h=new n.constructor(o);return o&&typeof n[0]=="string"&&Ut.call(n,"index")&&(h.index=n.index,h.input=n.input),h}function Yp(n){return typeof n.constructor=="function"&&!Ho(n)?kr(Ga(n)):{}}function W_(n,o,h){var p=n.constructor;switch(o){case Ui:return tc(n);case We:case Ni:return new p(+n);case os:return k_(n,h);case Bn:case Nn:case Un:case Dn:case H:case gt:case Pt:case Nt:case Kt:return zp(n,h);case Ee:return new p;case gi:case As:return new p(n);case ns:return C_(n);case Re:return new p;case nn:return z_(n)}}function q_(n,o){var h=o.length;if(!h)return n;var p=h-1;return o[p]=(h>1?"& ":"")+o[p],o=o.join(h>2?", ":" "),n.replace(W,`{
/* [wrapped with `+o+`] */
`)}function G_(n){return wt(n)||Xn(n)||!!(Jf&&n&&n[Jf])}function $s(n,o){var h=typeof n;return o=o==null?J:o,!!o&&(h=="number"||h!="symbol"&&Pa.test(n))&&n>-1&&n%1==0&&n<o}function $e(n,o,h){if(!Jt(h))return!1;var p=typeof o;return(p=="number"?je(h)&&$s(o,h.length):p=="string"&&o in h)?Hi(h[o],n):!1}function lc(n,o){if(wt(n))return!1;var h=typeof n;return h=="number"||h=="symbol"||h=="boolean"||n==null||oi(n)?!0:pu.test(n)||!fu.test(n)||o!=null&&n in Vt(o)}function Y_(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function hc(n){var o=cl(n),h=w[o];if(typeof h!="function"||!(o in kt.prototype))return!1;if(n===h)return!0;var p=rc(h);return!!p&&n===p[0]}function j_(n){return!!jf&&jf in n}var Z_=Da?Bs:Ac;function Ho(n){var o=n&&n.constructor,h=typeof o=="function"&&o.prototype||Er;return n===h}function jp(n){return n===n&&!Jt(n)}function Zp(n,o){return function(h){return h==null?!1:h[n]===o&&(o!==e||n in Vt(h))}}function X_(n){var o=vl(n,function(p){return h.size===d&&h.clear(),p}),h=o.cache;return o}function Q_(n,o){var h=n[1],p=o[1],y=h|p,_=y<(E|S|$),M=p==$&&h==I||p==$&&h==_t&&n[7].length<=o[8]||p==($|_t)&&o[7].length<=o[8]&&h==I;if(!(_||M))return n;p&E&&(n[2]=o[2],y|=h&E?0:z);var A=o[3];if(A){var C=n[3];n[3]=C?Op(C,A,o[4]):A,n[4]=C?ln(n[3],f):o[4]}return A=o[5],A&&(C=n[5],n[5]=C?Ip(C,A,o[6]):A,n[6]=C?ln(n[5],f):o[6]),A=o[7],A&&(n[7]=A),p&$&&(n[8]=n[8]==null?o[8]:Se(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=y,n}function J_(n){var o=[];if(n!=null)for(var h in Vt(n))o.push(h);return o}function K_(n){return Ha.call(n)}function Xp(n,o,h){return o=de(o===e?n.length-1:o,0),function(){for(var p=arguments,y=-1,_=de(p.length-o,0),M=T(_);++y<_;)M[y]=p[o+y];y=-1;for(var A=T(o+1);++y<o;)A[y]=p[y];return A[o]=h(M),si(n,this,A)}}function Qp(n,o){return o.length<2?n:Yn(n,Mi(o,0,-1))}function tb(n,o){for(var h=n.length,p=Se(o.length,h),y=Ye(n);p--;){var _=o[p];n[p]=$s(_,h)?y[_]:e}return n}function uc(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var Jp=tm(_p),Wo=mw||function(n,o){return ye.setTimeout(n,o)},cc=tm(M_);function Kp(n,o,h){var p=o+"";return cc(n,q_(p,eb(V_(p),h)))}function tm(n){var o=0,h=0;return function(){var p=xw(),y=ht-(p-h);if(h=p,y>0){if(++o>=ut)return arguments[0]}else o=0;return n.apply(e,arguments)}}function fl(n,o){var h=-1,p=n.length,y=p-1;for(o=o===e?p:o;++h<o;){var _=Yu(h,y),M=n[_];n[_]=n[h],n[h]=M}return n.length=o,n}var em=X_(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(mu,function(h,p,y,_){o.push(y?_.replace(zs,"$1"):p||h)}),o});function cs(n){if(typeof n=="string"||oi(n))return n;var o=n+"";return o=="0"&&1/n==-V?"-0":o}function Zn(n){if(n!=null){try{return Va.call(n)}catch{}try{return n+""}catch{}}return""}function eb(n,o){return xi(ot,function(h){var p="_."+h[0];o&h[1]&&!$a(n,p)&&n.push(p)}),n.sort()}function im(n){if(n instanceof kt)return n.clone();var o=new _i(n.__wrapped__,n.__chain__);return o.__actions__=Ye(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function ib(n,o,h){(h?$e(n,o,h):o===e)?o=1:o=de(bt(o),0);var p=n==null?0:n.length;if(!p||o<1)return[];for(var y=0,_=0,M=T(Za(p/o));y<p;)M[_++]=Mi(n,y,y+=o);return M}function sb(n){for(var o=-1,h=n==null?0:n.length,p=0,y=[];++o<h;){var _=n[o];_&&(y[p++]=_)}return y}function nb(){var n=arguments.length;if(!n)return[];for(var o=T(n-1),h=arguments[0],p=n;p--;)o[p-1]=arguments[p];return an(wt(h)?Ye(h):[h],xe(o,1))}var rb=St(function(n,o){return ie(n)?Bo(n,xe(o,1,ie,!0)):[]}),ob=St(function(n,o){var h=Ei(o);return ie(h)&&(h=e),ie(n)?Bo(n,xe(o,1,ie,!0),ct(h,2)):[]}),ab=St(function(n,o){var h=Ei(o);return ie(h)&&(h=e),ie(n)?Bo(n,xe(o,1,ie,!0),e,h):[]});function lb(n,o,h){var p=n==null?0:n.length;return p?(o=h||o===e?1:bt(o),Mi(n,o<0?0:o,p)):[]}function hb(n,o,h){var p=n==null?0:n.length;return p?(o=h||o===e?1:bt(o),o=p-o,Mi(n,0,o<0?0:o)):[]}function ub(n,o){return n&&n.length?rl(n,ct(o,3),!0,!0):[]}function cb(n,o){return n&&n.length?rl(n,ct(o,3),!0):[]}function db(n,o,h,p){var y=n==null?0:n.length;return y?(h&&typeof h!="number"&&$e(n,o,h)&&(h=0,p=y),n_(n,o,h,p)):[]}function sm(n,o,h){var p=n==null?0:n.length;if(!p)return-1;var y=h==null?0:bt(h);return y<0&&(y=de(p+y,0)),Ba(n,ct(o,3),y)}function nm(n,o,h){var p=n==null?0:n.length;if(!p)return-1;var y=p-1;return h!==e&&(y=bt(h),y=h<0?de(p+y,0):Se(y,p-1)),Ba(n,ct(o,3),y,!0)}function rm(n){var o=n==null?0:n.length;return o?xe(n,1):[]}function fb(n){var o=n==null?0:n.length;return o?xe(n,V):[]}function pb(n,o){var h=n==null?0:n.length;return h?(o=o===e?1:bt(o),xe(n,o)):[]}function mb(n){for(var o=-1,h=n==null?0:n.length,p={};++o<h;){var y=n[o];p[y[0]]=y[1]}return p}function om(n){return n&&n.length?n[0]:e}function gb(n,o,h){var p=n==null?0:n.length;if(!p)return-1;var y=h==null?0:bt(h);return y<0&&(y=de(p+y,0)),wr(n,o,y)}function vb(n){var o=n==null?0:n.length;return o?Mi(n,0,-1):[]}var yb=St(function(n){var o=Zt(n,Ju);return o.length&&o[0]===n[0]?Vu(o):[]}),xb=St(function(n){var o=Ei(n),h=Zt(n,Ju);return o===Ei(h)?o=e:h.pop(),h.length&&h[0]===n[0]?Vu(h,ct(o,2)):[]}),wb=St(function(n){var o=Ei(n),h=Zt(n,Ju);return o=typeof o=="function"?o:e,o&&h.pop(),h.length&&h[0]===n[0]?Vu(h,e,o):[]});function _b(n,o){return n==null?"":vw.call(n,o)}function Ei(n){var o=n==null?0:n.length;return o?n[o-1]:e}function bb(n,o,h){var p=n==null?0:n.length;if(!p)return-1;var y=p;return h!==e&&(y=bt(h),y=y<0?de(p+y,0):Se(y,p-1)),o===o?ew(n,o,y):Ba(n,Uf,y,!0)}function Mb(n,o){return n&&n.length?vp(n,bt(o)):e}var Eb=St(am);function am(n,o){return n&&n.length&&o&&o.length?Gu(n,o):n}function Sb(n,o,h){return n&&n.length&&o&&o.length?Gu(n,o,ct(h,2)):n}function Ab(n,o,h){return n&&n.length&&o&&o.length?Gu(n,o,e,h):n}var kb=Fs(function(n,o){var h=n==null?0:n.length,p=Bu(n,o);return wp(n,Zt(o,function(y){return $s(y,h)?+y:y}).sort(Tp)),p});function Cb(n,o){var h=[];if(!(n&&n.length))return h;var p=-1,y=[],_=n.length;for(o=ct(o,3);++p<_;){var M=n[p];o(M,p,n)&&(h.push(M),y.push(p))}return wp(n,y),h}function dc(n){return n==null?n:_w.call(n)}function zb(n,o,h){var p=n==null?0:n.length;return p?(h&&typeof h!="number"&&$e(n,o,h)?(o=0,h=p):(o=o==null?0:bt(o),h=h===e?p:bt(h)),Mi(n,o,h)):[]}function Tb(n,o){return nl(n,o)}function Ob(n,o,h){return Zu(n,o,ct(h,2))}function Ib(n,o){var h=n==null?0:n.length;if(h){var p=nl(n,o);if(p<h&&Hi(n[p],o))return p}return-1}function Lb(n,o){return nl(n,o,!0)}function Pb(n,o,h){return Zu(n,o,ct(h,2),!0)}function Rb(n,o){var h=n==null?0:n.length;if(h){var p=nl(n,o,!0)-1;if(Hi(n[p],o))return p}return-1}function Fb(n){return n&&n.length?bp(n):[]}function $b(n,o){return n&&n.length?bp(n,ct(o,2)):[]}function Bb(n){var o=n==null?0:n.length;return o?Mi(n,1,o):[]}function Nb(n,o,h){return n&&n.length?(o=h||o===e?1:bt(o),Mi(n,0,o<0?0:o)):[]}function Ub(n,o,h){var p=n==null?0:n.length;return p?(o=h||o===e?1:bt(o),o=p-o,Mi(n,o<0?0:o,p)):[]}function Db(n,o){return n&&n.length?rl(n,ct(o,3),!1,!0):[]}function Vb(n,o){return n&&n.length?rl(n,ct(o,3)):[]}var Hb=St(function(n){return cn(xe(n,1,ie,!0))}),Wb=St(function(n){var o=Ei(n);return ie(o)&&(o=e),cn(xe(n,1,ie,!0),ct(o,2))}),qb=St(function(n){var o=Ei(n);return o=typeof o=="function"?o:e,cn(xe(n,1,ie,!0),e,o)});function Gb(n){return n&&n.length?cn(n):[]}function Yb(n,o){return n&&n.length?cn(n,ct(o,2)):[]}function jb(n,o){return o=typeof o=="function"?o:e,n&&n.length?cn(n,e,o):[]}function fc(n){if(!(n&&n.length))return[];var o=0;return n=on(n,function(h){if(ie(h))return o=de(h.length,o),!0}),Tu(o,function(h){return Zt(n,ku(h))})}function lm(n,o){if(!(n&&n.length))return[];var h=fc(n);return o==null?h:Zt(h,function(p){return si(o,e,p)})}var Zb=St(function(n,o){return ie(n)?Bo(n,o):[]}),Xb=St(function(n){return Qu(on(n,ie))}),Qb=St(function(n){var o=Ei(n);return ie(o)&&(o=e),Qu(on(n,ie),ct(o,2))}),Jb=St(function(n){var o=Ei(n);return o=typeof o=="function"?o:e,Qu(on(n,ie),e,o)}),Kb=St(fc);function tM(n,o){return Ap(n||[],o||[],$o)}function eM(n,o){return Ap(n||[],o||[],Do)}var iM=St(function(n){var o=n.length,h=o>1?n[o-1]:e;return h=typeof h=="function"?(n.pop(),h):e,lm(n,h)});function hm(n){var o=w(n);return o.__chain__=!0,o}function sM(n,o){return o(n),n}function pl(n,o){return o(n)}var nM=Fs(function(n){var o=n.length,h=o?n[0]:0,p=this.__wrapped__,y=function(_){return Bu(_,n)};return o>1||this.__actions__.length||!(p instanceof kt)||!$s(h)?this.thru(y):(p=p.slice(h,+h+(o?1:0)),p.__actions__.push({func:pl,args:[y],thisArg:e}),new _i(p,this.__chain__).thru(function(_){return o&&!_.length&&_.push(e),_}))});function rM(){return hm(this)}function oM(){return new _i(this.value(),this.__chain__)}function aM(){this.__values__===e&&(this.__values__=Mm(this.value()));var n=this.__index__>=this.__values__.length,o=n?e:this.__values__[this.__index__++];return{done:n,value:o}}function lM(){return this}function hM(n){for(var o,h=this;h instanceof Ka;){var p=im(h);p.__index__=0,p.__values__=e,o?y.__wrapped__=p:o=p;var y=p;h=h.__wrapped__}return y.__wrapped__=n,o}function uM(){var n=this.__wrapped__;if(n instanceof kt){var o=n;return this.__actions__.length&&(o=new kt(this)),o=o.reverse(),o.__actions__.push({func:pl,args:[dc],thisArg:e}),new _i(o,this.__chain__)}return this.thru(dc)}function cM(){return Sp(this.__wrapped__,this.__actions__)}var dM=ol(function(n,o,h){Ut.call(n,h)?++n[h]:Ps(n,h,1)});function fM(n,o,h){var p=wt(n)?Bf:s_;return h&&$e(n,o,h)&&(o=e),p(n,ct(o,3))}function pM(n,o){var h=wt(n)?on:lp;return h(n,ct(o,3))}var mM=Fp(sm),gM=Fp(nm);function vM(n,o){return xe(ml(n,o),1)}function yM(n,o){return xe(ml(n,o),V)}function xM(n,o,h){return h=h===e?1:bt(h),xe(ml(n,o),h)}function um(n,o){var h=wt(n)?xi:un;return h(n,ct(o,3))}function cm(n,o){var h=wt(n)?Bx:ap;return h(n,ct(o,3))}var wM=ol(function(n,o,h){Ut.call(n,h)?n[h].push(o):Ps(n,h,[o])});function _M(n,o,h,p){n=je(n)?n:Ir(n),h=h&&!p?bt(h):0;var y=n.length;return h<0&&(h=de(y+h,0)),wl(n)?h<=y&&n.indexOf(o,h)>-1:!!y&&wr(n,o,h)>-1}var bM=St(function(n,o,h){var p=-1,y=typeof o=="function",_=je(n)?T(n.length):[];return un(n,function(M){_[++p]=y?si(o,M,h):No(M,o,h)}),_}),MM=ol(function(n,o,h){Ps(n,h,o)});function ml(n,o){var h=wt(n)?Zt:pp;return h(n,ct(o,3))}function EM(n,o,h,p){return n==null?[]:(wt(o)||(o=o==null?[]:[o]),h=p?e:h,wt(h)||(h=h==null?[]:[h]),yp(n,o,h))}var SM=ol(function(n,o,h){n[h?0:1].push(o)},function(){return[[],[]]});function AM(n,o,h){var p=wt(n)?Su:Vf,y=arguments.length<3;return p(n,ct(o,4),h,y,un)}function kM(n,o,h){var p=wt(n)?Nx:Vf,y=arguments.length<3;return p(n,ct(o,4),h,y,ap)}function CM(n,o){var h=wt(n)?on:lp;return h(n,yl(ct(o,3)))}function zM(n){var o=wt(n)?sp:__;return o(n)}function TM(n,o,h){(h?$e(n,o,h):o===e)?o=1:o=bt(o);var p=wt(n)?Jw:b_;return p(n,o)}function OM(n){var o=wt(n)?Kw:E_;return o(n)}function IM(n){if(n==null)return 0;if(je(n))return wl(n)?br(n):n.length;var o=Ae(n);return o==Ee||o==Re?n.size:Wu(n).length}function LM(n,o,h){var p=wt(n)?Au:S_;return h&&$e(n,o,h)&&(o=e),p(n,ct(o,3))}var PM=St(function(n,o){if(n==null)return[];var h=o.length;return h>1&&$e(n,o[0],o[1])?o=[]:h>2&&$e(o[0],o[1],o[2])&&(o=[o[0]]),yp(n,xe(o,1),[])}),gl=pw||function(){return ye.Date.now()};function RM(n,o){if(typeof o!="function")throw new wi(l);return n=bt(n),function(){if(--n<1)return o.apply(this,arguments)}}function dm(n,o,h){return o=h?e:o,o=n&&o==null?n.length:o,Rs(n,$,e,e,e,e,o)}function fm(n,o){var h;if(typeof o!="function")throw new wi(l);return n=bt(n),function(){return--n>0&&(h=o.apply(this,arguments)),n<=1&&(o=e),h}}var pc=St(function(n,o,h){var p=E;if(h.length){var y=ln(h,Tr(pc));p|=P}return Rs(n,p,o,h,y)}),pm=St(function(n,o,h){var p=E|S;if(h.length){var y=ln(h,Tr(pm));p|=P}return Rs(o,p,n,h,y)});function mm(n,o,h){o=h?e:o;var p=Rs(n,I,e,e,e,e,e,o);return p.placeholder=mm.placeholder,p}function gm(n,o,h){o=h?e:o;var p=Rs(n,O,e,e,e,e,e,o);return p.placeholder=gm.placeholder,p}function vm(n,o,h){var p,y,_,M,A,C,F=0,B=!1,D=!1,Q=!0;if(typeof n!="function")throw new wi(l);o=Si(o)||0,Jt(h)&&(B=!!h.leading,D="maxWait"in h,_=D?de(Si(h.maxWait)||0,o):_,Q="trailing"in h?!!h.trailing:Q);function rt(se){var Wi=p,Us=y;return p=y=e,F=se,M=n.apply(Us,Wi),M}function dt(se){return F=se,A=Wo(At,o),B?rt(se):M}function Et(se){var Wi=se-C,Us=se-F,Fm=o-Wi;return D?Se(Fm,_-Us):Fm}function ft(se){var Wi=se-C,Us=se-F;return C===e||Wi>=o||Wi<0||D&&Us>=_}function At(){var se=gl();if(ft(se))return It(se);A=Wo(At,Et(se))}function It(se){return A=e,Q&&p?rt(se):(p=y=e,M)}function ai(){A!==e&&kp(A),F=0,p=C=y=A=e}function Be(){return A===e?M:It(gl())}function li(){var se=gl(),Wi=ft(se);if(p=arguments,y=this,C=se,Wi){if(A===e)return dt(C);if(D)return kp(A),A=Wo(At,o),rt(C)}return A===e&&(A=Wo(At,o)),M}return li.cancel=ai,li.flush=Be,li}var FM=St(function(n,o){return op(n,1,o)}),$M=St(function(n,o,h){return op(n,Si(o)||0,h)});function BM(n){return Rs(n,zt)}function vl(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new wi(l);var h=function(){var p=arguments,y=o?o.apply(this,p):p[0],_=h.cache;if(_.has(y))return _.get(y);var M=n.apply(this,p);return h.cache=_.set(y,M)||_,M};return h.cache=new(vl.Cache||Ls),h}vl.Cache=Ls;function yl(n){if(typeof n!="function")throw new wi(l);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function NM(n){return fm(2,n)}var UM=A_(function(n,o){o=o.length==1&&wt(o[0])?Zt(o[0],ni(ct())):Zt(xe(o,1),ni(ct()));var h=o.length;return St(function(p){for(var y=-1,_=Se(p.length,h);++y<_;)p[y]=o[y].call(this,p[y]);return si(n,this,p)})}),mc=St(function(n,o){var h=ln(o,Tr(mc));return Rs(n,P,e,o,h)}),ym=St(function(n,o){var h=ln(o,Tr(ym));return Rs(n,G,e,o,h)}),DM=Fs(function(n,o){return Rs(n,_t,e,e,e,o)});function VM(n,o){if(typeof n!="function")throw new wi(l);return o=o===e?o:bt(o),St(n,o)}function HM(n,o){if(typeof n!="function")throw new wi(l);return o=o==null?0:de(bt(o),0),St(function(h){var p=h[o],y=fn(h,0,o);return p&&an(y,p),si(n,this,y)})}function WM(n,o,h){var p=!0,y=!0;if(typeof n!="function")throw new wi(l);return Jt(h)&&(p="leading"in h?!!h.leading:p,y="trailing"in h?!!h.trailing:y),vm(n,o,{leading:p,maxWait:o,trailing:y})}function qM(n){return dm(n,1)}function GM(n,o){return mc(Ku(o),n)}function YM(){if(!arguments.length)return[];var n=arguments[0];return wt(n)?n:[n]}function jM(n){return bi(n,v)}function ZM(n,o){return o=typeof o=="function"?o:e,bi(n,v,o)}function XM(n){return bi(n,m|v)}function QM(n,o){return o=typeof o=="function"?o:e,bi(n,m|v,o)}function JM(n,o){return o==null||rp(n,o,pe(o))}function Hi(n,o){return n===o||n!==n&&o!==o}var KM=ul(Du),t2=ul(function(n,o){return n>=o}),Xn=cp(function(){return arguments}())?cp:function(n){return te(n)&&Ut.call(n,"callee")&&!Qf.call(n,"callee")},wt=T.isArray,e2=If?ni(If):h_;function je(n){return n!=null&&xl(n.length)&&!Bs(n)}function ie(n){return te(n)&&je(n)}function i2(n){return n===!0||n===!1||te(n)&&Fe(n)==We}var pn=gw||Ac,s2=Lf?ni(Lf):u_;function n2(n){return te(n)&&n.nodeType===1&&!qo(n)}function r2(n){if(n==null)return!0;if(je(n)&&(wt(n)||typeof n=="string"||typeof n.splice=="function"||pn(n)||Or(n)||Xn(n)))return!n.length;var o=Ae(n);if(o==Ee||o==Re)return!n.size;if(Ho(n))return!Wu(n).length;for(var h in n)if(Ut.call(n,h))return!1;return!0}function o2(n,o){return Uo(n,o)}function a2(n,o,h){h=typeof h=="function"?h:e;var p=h?h(n,o):e;return p===e?Uo(n,o,e,h):!!p}function gc(n){if(!te(n))return!1;var o=Fe(n);return o==Pe||o==mr||typeof n.message=="string"&&typeof n.name=="string"&&!qo(n)}function l2(n){return typeof n=="number"&&Kf(n)}function Bs(n){if(!Jt(n))return!1;var o=Fe(n);return o==sn||o==Rn||o==fe||o==$n}function xm(n){return typeof n=="number"&&n==bt(n)}function xl(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=J}function Jt(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function te(n){return n!=null&&typeof n=="object"}var wm=Pf?ni(Pf):d_;function h2(n,o){return n===o||Hu(n,o,oc(o))}function u2(n,o,h){return h=typeof h=="function"?h:e,Hu(n,o,oc(o),h)}function c2(n){return _m(n)&&n!=+n}function d2(n){if(Z_(n))throw new yt(a);return dp(n)}function f2(n){return n===null}function p2(n){return n==null}function _m(n){return typeof n=="number"||te(n)&&Fe(n)==gi}function qo(n){if(!te(n)||Fe(n)!=qe)return!1;var o=Ga(n);if(o===null)return!0;var h=Ut.call(o,"constructor")&&o.constructor;return typeof h=="function"&&h instanceof h&&Va.call(h)==uw}var vc=Rf?ni(Rf):f_;function m2(n){return xm(n)&&n>=-J&&n<=J}var bm=Ff?ni(Ff):p_;function wl(n){return typeof n=="string"||!wt(n)&&te(n)&&Fe(n)==As}function oi(n){return typeof n=="symbol"||te(n)&&Fe(n)==nn}var Or=$f?ni($f):m_;function g2(n){return n===e}function v2(n){return te(n)&&Ae(n)==rs}function y2(n){return te(n)&&Fe(n)==So}var x2=ul(qu),w2=ul(function(n,o){return n<=o});function Mm(n){if(!n)return[];if(je(n))return wl(n)?Di(n):Ye(n);if(Io&&n[Io])return Jx(n[Io]());var o=Ae(n),h=o==Ee?Iu:o==Re?Na:Ir;return h(n)}function Ns(n){if(!n)return n===0?n:0;if(n=Si(n),n===V||n===-V){var o=n<0?-1:1;return o*pt}return n===n?n:0}function bt(n){var o=Ns(n),h=o%1;return o===o?h?o-h:o:0}function Em(n){return n?Gn(bt(n),0,Tt):0}function Si(n){if(typeof n=="number")return n;if(oi(n))return mt;if(Jt(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=Jt(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=Hf(n);var h=he.test(n);return h||zo.test(n)?Rx(n.slice(2),h?2:8):ls.test(n)?mt:+n}function Sm(n){return us(n,Ze(n))}function _2(n){return n?Gn(bt(n),-J,J):n===0?n:0}function $t(n){return n==null?"":ri(n)}var b2=Cr(function(n,o){if(Ho(o)||je(o)){us(o,pe(o),n);return}for(var h in o)Ut.call(o,h)&&$o(n,h,o[h])}),Am=Cr(function(n,o){us(o,Ze(o),n)}),_l=Cr(function(n,o,h,p){us(o,Ze(o),n,p)}),M2=Cr(function(n,o,h,p){us(o,pe(o),n,p)}),E2=Fs(Bu);function S2(n,o){var h=kr(n);return o==null?h:np(h,o)}var A2=St(function(n,o){n=Vt(n);var h=-1,p=o.length,y=p>2?o[2]:e;for(y&&$e(o[0],o[1],y)&&(p=1);++h<p;)for(var _=o[h],M=Ze(_),A=-1,C=M.length;++A<C;){var F=M[A],B=n[F];(B===e||Hi(B,Er[F])&&!Ut.call(n,F))&&(n[F]=_[F])}return n}),k2=St(function(n){return n.push(e,Hp),si(km,e,n)});function C2(n,o){return Nf(n,ct(o,3),hs)}function z2(n,o){return Nf(n,ct(o,3),Uu)}function T2(n,o){return n==null?n:Nu(n,ct(o,3),Ze)}function O2(n,o){return n==null?n:hp(n,ct(o,3),Ze)}function I2(n,o){return n&&hs(n,ct(o,3))}function L2(n,o){return n&&Uu(n,ct(o,3))}function P2(n){return n==null?[]:il(n,pe(n))}function R2(n){return n==null?[]:il(n,Ze(n))}function yc(n,o,h){var p=n==null?e:Yn(n,o);return p===e?h:p}function F2(n,o){return n!=null&&Gp(n,o,r_)}function xc(n,o){return n!=null&&Gp(n,o,o_)}var $2=Bp(function(n,o,h){o!=null&&typeof o.toString!="function"&&(o=Ha.call(o)),n[o]=h},_c(Xe)),B2=Bp(function(n,o,h){o!=null&&typeof o.toString!="function"&&(o=Ha.call(o)),Ut.call(n,o)?n[o].push(h):n[o]=[h]},ct),N2=St(No);function pe(n){return je(n)?ip(n):Wu(n)}function Ze(n){return je(n)?ip(n,!0):g_(n)}function U2(n,o){var h={};return o=ct(o,3),hs(n,function(p,y,_){Ps(h,o(p,y,_),p)}),h}function D2(n,o){var h={};return o=ct(o,3),hs(n,function(p,y,_){Ps(h,y,o(p,y,_))}),h}var V2=Cr(function(n,o,h){sl(n,o,h)}),km=Cr(function(n,o,h,p){sl(n,o,h,p)}),H2=Fs(function(n,o){var h={};if(n==null)return h;var p=!1;o=Zt(o,function(_){return _=dn(_,n),p||(p=_.length>1),_}),us(n,nc(n),h),p&&(h=bi(h,m|g|v,$_));for(var y=o.length;y--;)Xu(h,o[y]);return h});function W2(n,o){return Cm(n,yl(ct(o)))}var q2=Fs(function(n,o){return n==null?{}:y_(n,o)});function Cm(n,o){if(n==null)return{};var h=Zt(nc(n),function(p){return[p]});return o=ct(o),xp(n,h,function(p,y){return o(p,y[0])})}function G2(n,o,h){o=dn(o,n);var p=-1,y=o.length;for(y||(y=1,n=e);++p<y;){var _=n==null?e:n[cs(o[p])];_===e&&(p=y,_=h),n=Bs(_)?_.call(n):_}return n}function Y2(n,o,h){return n==null?n:Do(n,o,h)}function j2(n,o,h,p){return p=typeof p=="function"?p:e,n==null?n:Do(n,o,h,p)}var zm=Dp(pe),Tm=Dp(Ze);function Z2(n,o,h){var p=wt(n),y=p||pn(n)||Or(n);if(o=ct(o,4),h==null){var _=n&&n.constructor;y?h=p?new _:[]:Jt(n)?h=Bs(_)?kr(Ga(n)):{}:h={}}return(y?xi:hs)(n,function(M,A,C){return o(h,M,A,C)}),h}function X2(n,o){return n==null?!0:Xu(n,o)}function Q2(n,o,h){return n==null?n:Ep(n,o,Ku(h))}function J2(n,o,h,p){return p=typeof p=="function"?p:e,n==null?n:Ep(n,o,Ku(h),p)}function Ir(n){return n==null?[]:Ou(n,pe(n))}function K2(n){return n==null?[]:Ou(n,Ze(n))}function tE(n,o,h){return h===e&&(h=o,o=e),h!==e&&(h=Si(h),h=h===h?h:0),o!==e&&(o=Si(o),o=o===o?o:0),Gn(Si(n),o,h)}function eE(n,o,h){return o=Ns(o),h===e?(h=o,o=0):h=Ns(h),n=Si(n),a_(n,o,h)}function iE(n,o,h){if(h&&typeof h!="boolean"&&$e(n,o,h)&&(o=h=e),h===e&&(typeof o=="boolean"?(h=o,o=e):typeof n=="boolean"&&(h=n,n=e)),n===e&&o===e?(n=0,o=1):(n=Ns(n),o===e?(o=n,n=0):o=Ns(o)),n>o){var p=n;n=o,o=p}if(h||n%1||o%1){var y=tp();return Se(n+y*(o-n+Px("1e-"+((y+"").length-1))),o)}return Yu(n,o)}var sE=zr(function(n,o,h){return o=o.toLowerCase(),n+(h?Om(o):o)});function Om(n){return wc($t(n).toLowerCase())}function Im(n){return n=$t(n),n&&n.replace(Ra,Yx).replace(Ex,"")}function nE(n,o,h){n=$t(n),o=ri(o);var p=n.length;h=h===e?p:Gn(bt(h),0,p);var y=h;return h-=o.length,h>=0&&n.slice(h,y)==o}function rE(n){return n=$t(n),n&&gr.test(n)?n.replace(as,jx):n}function oE(n){return n=$t(n),n&&ko.test(n)?n.replace(vr,"\\$&"):n}var aE=zr(function(n,o,h){return n+(h?"-":"")+o.toLowerCase()}),lE=zr(function(n,o,h){return n+(h?" ":"")+o.toLowerCase()}),hE=Rp("toLowerCase");function uE(n,o,h){n=$t(n),o=bt(o);var p=o?br(n):0;if(!o||p>=o)return n;var y=(o-p)/2;return hl(Xa(y),h)+n+hl(Za(y),h)}function cE(n,o,h){n=$t(n),o=bt(o);var p=o?br(n):0;return o&&p<o?n+hl(o-p,h):n}function dE(n,o,h){n=$t(n),o=bt(o);var p=o?br(n):0;return o&&p<o?hl(o-p,h)+n:n}function fE(n,o,h){return h||o==null?o=0:o&&(o=+o),ww($t(n).replace(Co,""),o||0)}function pE(n,o,h){return(h?$e(n,o,h):o===e)?o=1:o=bt(o),ju($t(n),o)}function mE(){var n=arguments,o=$t(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var gE=zr(function(n,o,h){return n+(h?"_":"")+o.toLowerCase()});function vE(n,o,h){return h&&typeof h!="number"&&$e(n,o,h)&&(o=h=e),h=h===e?Tt:h>>>0,h?(n=$t(n),n&&(typeof o=="string"||o!=null&&!vc(o))&&(o=ri(o),!o&&_r(n))?fn(Di(n),0,h):n.split(o,h)):[]}var yE=zr(function(n,o,h){return n+(h?" ":"")+wc(o)});function xE(n,o,h){return n=$t(n),h=h==null?0:Gn(bt(h),0,n.length),o=ri(o),n.slice(h,h+o.length)==o}function wE(n,o,h){var p=w.templateSettings;h&&$e(n,o,h)&&(o=e),n=$t(n),o=_l({},o,p,Vp);var y=_l({},o.imports,p.imports,Vp),_=pe(y),M=Ou(y,_),A,C,F=0,B=o.interpolate||yr,D="__p += '",Q=Lu((o.escape||yr).source+"|"+B.source+"|"+(B===Ia?ee:yr).source+"|"+(o.evaluate||yr).source+"|$","g"),rt="//# sourceURL="+(Ut.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zx+"]")+`
`;n.replace(Q,function(ft,At,It,ai,Be,li){return It||(It=ai),D+=n.slice(F,li).replace(To,Zx),At&&(A=!0,D+=`' +
__e(`+At+`) +
'`),Be&&(C=!0,D+=`';
`+Be+`;
__p += '`),It&&(D+=`' +
((__t = (`+It+`)) == null ? '' : __t) +
'`),F=li+ft.length,ft}),D+=`';
`;var dt=Ut.call(o,"variable")&&o.variable;if(!dt)D=`with (obj) {
`+D+`
}
`;else if(Cs.test(dt))throw new yt(u);D=(C?D.replace(vi,""):D).replace(ks,"$1").replace(rn,"$1;"),D="function("+(dt||"obj")+`) {
`+(dt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(A?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+D+`return __p
}`;var Et=Pm(function(){return Rt(_,rt+"return "+D).apply(e,M)});if(Et.source=D,gc(Et))throw Et;return Et}function _E(n){return $t(n).toLowerCase()}function bE(n){return $t(n).toUpperCase()}function ME(n,o,h){if(n=$t(n),n&&(h||o===e))return Hf(n);if(!n||!(o=ri(o)))return n;var p=Di(n),y=Di(o),_=Wf(p,y),M=qf(p,y)+1;return fn(p,_,M).join("")}function EE(n,o,h){if(n=$t(n),n&&(h||o===e))return n.slice(0,Yf(n)+1);if(!n||!(o=ri(o)))return n;var p=Di(n),y=qf(p,Di(o))+1;return fn(p,0,y).join("")}function SE(n,o,h){if(n=$t(n),n&&(h||o===e))return n.replace(Co,"");if(!n||!(o=ri(o)))return n;var p=Di(n),y=Wf(p,Di(o));return fn(p,y).join("")}function AE(n,o){var h=j,p=lt;if(Jt(o)){var y="separator"in o?o.separator:y;h="length"in o?bt(o.length):h,p="omission"in o?ri(o.omission):p}n=$t(n);var _=n.length;if(_r(n)){var M=Di(n);_=M.length}if(h>=_)return n;var A=h-br(p);if(A<1)return p;var C=M?fn(M,0,A).join(""):n.slice(0,A);if(y===e)return C+p;if(M&&(A+=C.length-A),vc(y)){if(n.slice(A).search(y)){var F,B=C;for(y.global||(y=Lu(y.source,$t(Ts.exec(y))+"g")),y.lastIndex=0;F=y.exec(B);)var D=F.index;C=C.slice(0,D===e?A:D)}}else if(n.indexOf(ri(y),A)!=A){var Q=C.lastIndexOf(y);Q>-1&&(C=C.slice(0,Q))}return C+p}function kE(n){return n=$t(n),n&&Ao.test(n)?n.replace(Oa,iw):n}var CE=zr(function(n,o,h){return n+(h?" ":"")+o.toUpperCase()}),wc=Rp("toUpperCase");function Lm(n,o,h){return n=$t(n),o=h?e:o,o===e?Qx(n)?rw(n):Vx(n):n.match(o)||[]}var Pm=St(function(n,o){try{return si(n,e,o)}catch(h){return gc(h)?h:new yt(h)}}),zE=Fs(function(n,o){return xi(o,function(h){h=cs(h),Ps(n,h,pc(n[h],n))}),n});function TE(n){var o=n==null?0:n.length,h=ct();return n=o?Zt(n,function(p){if(typeof p[1]!="function")throw new wi(l);return[h(p[0]),p[1]]}):[],St(function(p){for(var y=-1;++y<o;){var _=n[y];if(si(_[0],this,p))return si(_[1],this,p)}})}function OE(n){return i_(bi(n,m))}function _c(n){return function(){return n}}function IE(n,o){return n==null||n!==n?o:n}var LE=$p(),PE=$p(!0);function Xe(n){return n}function bc(n){return fp(typeof n=="function"?n:bi(n,m))}function RE(n){return mp(bi(n,m))}function FE(n,o){return gp(n,bi(o,m))}var $E=St(function(n,o){return function(h){return No(h,n,o)}}),BE=St(function(n,o){return function(h){return No(n,h,o)}});function Mc(n,o,h){var p=pe(o),y=il(o,p);h==null&&!(Jt(o)&&(y.length||!p.length))&&(h=o,o=n,n=this,y=il(o,pe(o)));var _=!(Jt(h)&&"chain"in h)||!!h.chain,M=Bs(n);return xi(y,function(A){var C=o[A];n[A]=C,M&&(n.prototype[A]=function(){var F=this.__chain__;if(_||F){var B=n(this.__wrapped__),D=B.__actions__=Ye(this.__actions__);return D.push({func:C,args:arguments,thisArg:n}),B.__chain__=F,B}return C.apply(n,an([this.value()],arguments))})}),n}function NE(){return ye._===this&&(ye._=cw),this}function Ec(){}function UE(n){return n=bt(n),St(function(o){return vp(o,n)})}var DE=ec(Zt),VE=ec(Bf),HE=ec(Au);function Rm(n){return lc(n)?ku(cs(n)):x_(n)}function WE(n){return function(o){return n==null?e:Yn(n,o)}}var qE=Np(),GE=Np(!0);function Sc(){return[]}function Ac(){return!1}function YE(){return{}}function jE(){return""}function ZE(){return!0}function XE(n,o){if(n=bt(n),n<1||n>J)return[];var h=Tt,p=Se(n,Tt);o=ct(o),n-=Tt;for(var y=Tu(p,o);++h<n;)o(h);return y}function QE(n){return wt(n)?Zt(n,cs):oi(n)?[n]:Ye(em($t(n)))}function JE(n){var o=++hw;return $t(n)+o}var KE=ll(function(n,o){return n+o},0),tS=ic("ceil"),eS=ll(function(n,o){return n/o},1),iS=ic("floor");function sS(n){return n&&n.length?el(n,Xe,Du):e}function nS(n,o){return n&&n.length?el(n,ct(o,2),Du):e}function rS(n){return Df(n,Xe)}function oS(n,o){return Df(n,ct(o,2))}function aS(n){return n&&n.length?el(n,Xe,qu):e}function lS(n,o){return n&&n.length?el(n,ct(o,2),qu):e}var hS=ll(function(n,o){return n*o},1),uS=ic("round"),cS=ll(function(n,o){return n-o},0);function dS(n){return n&&n.length?zu(n,Xe):0}function fS(n,o){return n&&n.length?zu(n,ct(o,2)):0}return w.after=RM,w.ary=dm,w.assign=b2,w.assignIn=Am,w.assignInWith=_l,w.assignWith=M2,w.at=E2,w.before=fm,w.bind=pc,w.bindAll=zE,w.bindKey=pm,w.castArray=YM,w.chain=hm,w.chunk=ib,w.compact=sb,w.concat=nb,w.cond=TE,w.conforms=OE,w.constant=_c,w.countBy=dM,w.create=S2,w.curry=mm,w.curryRight=gm,w.debounce=vm,w.defaults=A2,w.defaultsDeep=k2,w.defer=FM,w.delay=$M,w.difference=rb,w.differenceBy=ob,w.differenceWith=ab,w.drop=lb,w.dropRight=hb,w.dropRightWhile=ub,w.dropWhile=cb,w.fill=db,w.filter=pM,w.flatMap=vM,w.flatMapDeep=yM,w.flatMapDepth=xM,w.flatten=rm,w.flattenDeep=fb,w.flattenDepth=pb,w.flip=BM,w.flow=LE,w.flowRight=PE,w.fromPairs=mb,w.functions=P2,w.functionsIn=R2,w.groupBy=wM,w.initial=vb,w.intersection=yb,w.intersectionBy=xb,w.intersectionWith=wb,w.invert=$2,w.invertBy=B2,w.invokeMap=bM,w.iteratee=bc,w.keyBy=MM,w.keys=pe,w.keysIn=Ze,w.map=ml,w.mapKeys=U2,w.mapValues=D2,w.matches=RE,w.matchesProperty=FE,w.memoize=vl,w.merge=V2,w.mergeWith=km,w.method=$E,w.methodOf=BE,w.mixin=Mc,w.negate=yl,w.nthArg=UE,w.omit=H2,w.omitBy=W2,w.once=NM,w.orderBy=EM,w.over=DE,w.overArgs=UM,w.overEvery=VE,w.overSome=HE,w.partial=mc,w.partialRight=ym,w.partition=SM,w.pick=q2,w.pickBy=Cm,w.property=Rm,w.propertyOf=WE,w.pull=Eb,w.pullAll=am,w.pullAllBy=Sb,w.pullAllWith=Ab,w.pullAt=kb,w.range=qE,w.rangeRight=GE,w.rearg=DM,w.reject=CM,w.remove=Cb,w.rest=VM,w.reverse=dc,w.sampleSize=TM,w.set=Y2,w.setWith=j2,w.shuffle=OM,w.slice=zb,w.sortBy=PM,w.sortedUniq=Fb,w.sortedUniqBy=$b,w.split=vE,w.spread=HM,w.tail=Bb,w.take=Nb,w.takeRight=Ub,w.takeRightWhile=Db,w.takeWhile=Vb,w.tap=sM,w.throttle=WM,w.thru=pl,w.toArray=Mm,w.toPairs=zm,w.toPairsIn=Tm,w.toPath=QE,w.toPlainObject=Sm,w.transform=Z2,w.unary=qM,w.union=Hb,w.unionBy=Wb,w.unionWith=qb,w.uniq=Gb,w.uniqBy=Yb,w.uniqWith=jb,w.unset=X2,w.unzip=fc,w.unzipWith=lm,w.update=Q2,w.updateWith=J2,w.values=Ir,w.valuesIn=K2,w.without=Zb,w.words=Lm,w.wrap=GM,w.xor=Xb,w.xorBy=Qb,w.xorWith=Jb,w.zip=Kb,w.zipObject=tM,w.zipObjectDeep=eM,w.zipWith=iM,w.entries=zm,w.entriesIn=Tm,w.extend=Am,w.extendWith=_l,Mc(w,w),w.add=KE,w.attempt=Pm,w.camelCase=sE,w.capitalize=Om,w.ceil=tS,w.clamp=tE,w.clone=jM,w.cloneDeep=XM,w.cloneDeepWith=QM,w.cloneWith=ZM,w.conformsTo=JM,w.deburr=Im,w.defaultTo=IE,w.divide=eS,w.endsWith=nE,w.eq=Hi,w.escape=rE,w.escapeRegExp=oE,w.every=fM,w.find=mM,w.findIndex=sm,w.findKey=C2,w.findLast=gM,w.findLastIndex=nm,w.findLastKey=z2,w.floor=iS,w.forEach=um,w.forEachRight=cm,w.forIn=T2,w.forInRight=O2,w.forOwn=I2,w.forOwnRight=L2,w.get=yc,w.gt=KM,w.gte=t2,w.has=F2,w.hasIn=xc,w.head=om,w.identity=Xe,w.includes=_M,w.indexOf=gb,w.inRange=eE,w.invoke=N2,w.isArguments=Xn,w.isArray=wt,w.isArrayBuffer=e2,w.isArrayLike=je,w.isArrayLikeObject=ie,w.isBoolean=i2,w.isBuffer=pn,w.isDate=s2,w.isElement=n2,w.isEmpty=r2,w.isEqual=o2,w.isEqualWith=a2,w.isError=gc,w.isFinite=l2,w.isFunction=Bs,w.isInteger=xm,w.isLength=xl,w.isMap=wm,w.isMatch=h2,w.isMatchWith=u2,w.isNaN=c2,w.isNative=d2,w.isNil=p2,w.isNull=f2,w.isNumber=_m,w.isObject=Jt,w.isObjectLike=te,w.isPlainObject=qo,w.isRegExp=vc,w.isSafeInteger=m2,w.isSet=bm,w.isString=wl,w.isSymbol=oi,w.isTypedArray=Or,w.isUndefined=g2,w.isWeakMap=v2,w.isWeakSet=y2,w.join=_b,w.kebabCase=aE,w.last=Ei,w.lastIndexOf=bb,w.lowerCase=lE,w.lowerFirst=hE,w.lt=x2,w.lte=w2,w.max=sS,w.maxBy=nS,w.mean=rS,w.meanBy=oS,w.min=aS,w.minBy=lS,w.stubArray=Sc,w.stubFalse=Ac,w.stubObject=YE,w.stubString=jE,w.stubTrue=ZE,w.multiply=hS,w.nth=Mb,w.noConflict=NE,w.noop=Ec,w.now=gl,w.pad=uE,w.padEnd=cE,w.padStart=dE,w.parseInt=fE,w.random=iE,w.reduce=AM,w.reduceRight=kM,w.repeat=pE,w.replace=mE,w.result=G2,w.round=uS,w.runInContext=k,w.sample=zM,w.size=IM,w.snakeCase=gE,w.some=LM,w.sortedIndex=Tb,w.sortedIndexBy=Ob,w.sortedIndexOf=Ib,w.sortedLastIndex=Lb,w.sortedLastIndexBy=Pb,w.sortedLastIndexOf=Rb,w.startCase=yE,w.startsWith=xE,w.subtract=cS,w.sum=dS,w.sumBy=fS,w.template=wE,w.times=XE,w.toFinite=Ns,w.toInteger=bt,w.toLength=Em,w.toLower=_E,w.toNumber=Si,w.toSafeInteger=_2,w.toString=$t,w.toUpper=bE,w.trim=ME,w.trimEnd=EE,w.trimStart=SE,w.truncate=AE,w.unescape=kE,w.uniqueId=JE,w.upperCase=CE,w.upperFirst=wc,w.each=um,w.eachRight=cm,w.first=om,Mc(w,function(){var n={};return hs(w,function(o,h){Ut.call(w.prototype,h)||(n[h]=o)}),n}(),{chain:!1}),w.VERSION=s,xi(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){w[n].placeholder=w}),xi(["drop","take"],function(n,o){kt.prototype[n]=function(h){h=h===e?1:de(bt(h),0);var p=this.__filtered__&&!o?new kt(this):this.clone();return p.__filtered__?p.__takeCount__=Se(h,p.__takeCount__):p.__views__.push({size:Se(h,Tt),type:n+(p.__dir__<0?"Right":"")}),p},kt.prototype[n+"Right"]=function(h){return this.reverse()[n](h).reverse()}}),xi(["filter","map","takeWhile"],function(n,o){var h=o+1,p=h==Ft||h==Lt;kt.prototype[n]=function(y){var _=this.clone();return _.__iteratees__.push({iteratee:ct(y,3),type:h}),_.__filtered__=_.__filtered__||p,_}}),xi(["head","last"],function(n,o){var h="take"+(o?"Right":"");kt.prototype[n]=function(){return this[h](1).value()[0]}}),xi(["initial","tail"],function(n,o){var h="drop"+(o?"":"Right");kt.prototype[n]=function(){return this.__filtered__?new kt(this):this[h](1)}}),kt.prototype.compact=function(){return this.filter(Xe)},kt.prototype.find=function(n){return this.filter(n).head()},kt.prototype.findLast=function(n){return this.reverse().find(n)},kt.prototype.invokeMap=St(function(n,o){return typeof n=="function"?new kt(this):this.map(function(h){return No(h,n,o)})}),kt.prototype.reject=function(n){return this.filter(yl(ct(n)))},kt.prototype.slice=function(n,o){n=bt(n);var h=this;return h.__filtered__&&(n>0||o<0)?new kt(h):(n<0?h=h.takeRight(-n):n&&(h=h.drop(n)),o!==e&&(o=bt(o),h=o<0?h.dropRight(-o):h.take(o-n)),h)},kt.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},kt.prototype.toArray=function(){return this.take(Tt)},hs(kt.prototype,function(n,o){var h=/^(?:filter|find|map|reject)|While$/.test(o),p=/^(?:head|last)$/.test(o),y=w[p?"take"+(o=="last"?"Right":""):o],_=p||/^find/.test(o);!y||(w.prototype[o]=function(){var M=this.__wrapped__,A=p?[1]:arguments,C=M instanceof kt,F=A[0],B=C||wt(M),D=function(At){var It=y.apply(w,an([At],A));return p&&Q?It[0]:It};B&&h&&typeof F=="function"&&F.length!=1&&(C=B=!1);var Q=this.__chain__,rt=!!this.__actions__.length,dt=_&&!Q,Et=C&&!rt;if(!_&&B){M=Et?M:new kt(this);var ft=n.apply(M,A);return ft.__actions__.push({func:pl,args:[D],thisArg:e}),new _i(ft,Q)}return dt&&Et?n.apply(this,A):(ft=this.thru(D),dt?p?ft.value()[0]:ft.value():ft)})}),xi(["pop","push","shift","sort","splice","unshift"],function(n){var o=Ua[n],h=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",p=/^(?:pop|shift)$/.test(n);w.prototype[n]=function(){var y=arguments;if(p&&!this.__chain__){var _=this.value();return o.apply(wt(_)?_:[],y)}return this[h](function(M){return o.apply(wt(M)?M:[],y)})}}),hs(kt.prototype,function(n,o){var h=w[o];if(h){var p=h.name+"";Ut.call(Ar,p)||(Ar[p]=[]),Ar[p].push({name:o,func:h})}}),Ar[al(e,S).name]=[{name:"wrapper",func:e}],kt.prototype.clone=kw,kt.prototype.reverse=Cw,kt.prototype.value=zw,w.prototype.at=nM,w.prototype.chain=rM,w.prototype.commit=oM,w.prototype.next=aM,w.prototype.plant=hM,w.prototype.reverse=uM,w.prototype.toJSON=w.prototype.valueOf=w.prototype.value=cM,w.prototype.first=w.prototype.head,Io&&(w.prototype[Io]=lM),w},Mr=ow();Vn?((Vn.exports=Mr)._=Mr,bu._=Mr):ye._=Mr}).call(Yo)})(Zm,Zm.exports);/*!
 * PhotoSphereViewer.CompassPlugin 5.1.5
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var t3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="50" fill="rgba(61, 61, 61, .5)"/><path fill="rgba(255, 255, 255, .7)" d="M50 97.1A47 47 0 0 1 32.5 6.5l.8 1.8a45 45 0 1 0 33.4 0l.8-1.8A47 47 0 0 1 50 97Zm0-42a5 5 0 1 1 5-5 5 5 0 0 1-5 5Zm4-41.7h-1.6a.4.4 0 0 1-.4-.2l-4.6-7.7V13a.3.3 0 0 1-.3.3h-1.6a.3.3 0 0 1-.3-.3V1.8a.3.3 0 0 1 .3-.3h1.6a.3.3 0 0 1 .4.2L52 9.4V1.8a.3.3 0 0 1 .3-.3H54c.2 0 .3 0 .3.3V13c0 .2-.1.3-.3.3Z"/></svg>
`,Xm=1/40,e3=class extends Ea{constructor(i,t){super(i,{}),this.plugin=t,this.state={visible:!0,mouse:null,mousedown:!1,markers:[]},this.background=document.createElement("div"),this.canvas=document.createElement("canvas"),this.container.appendChild(this.background),this.container.appendChild(this.canvas),this.config.navigation&&(this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("mousemove",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseup",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("touchmove",this),this.container.addEventListener("touchend",this)),this.applyConfig(),this.hide()}get config(){return this.plugin.config}handleEvent(i){var t,e;switch(i.type){case"mouseenter":case"mousemove":case"touchmove":this.state.mouse=((t=i.changedTouches)==null?void 0:t[0])||i,this.state.mousedown?this.click():this.update(),i.stopPropagation(),i.preventDefault();break;case"mousedown":case"touchstart":this.state.mousedown=!0,i.stopPropagation(),i.preventDefault();break;case"mouseup":case"touchend":this.state.mouse=((e=i.changedTouches)==null?void 0:e[0])||i,this.state.mousedown=!1,this.click(),i.changedTouches&&(this.state.mouse=null,this.update()),i.stopPropagation(),i.preventDefault();break;case"mouseleave":this.state.mouse=null,this.state.mousedown=!1,this.update();break}}applyConfig(){this.container.className=`psv-compass psv-compass--${this.config.position.join("-")}`,this.background.innerHTML=this.config.backgroundSvg,this.container.style.width=this.config.size,this.container.style.height=this.config.size,this.container.style.marginTop=this.config.position[0]==="center"?`calc(-${this.config.size} / 2)`:"",this.container.style.marginLeft=this.config.position[1]==="center"?`calc(-${this.config.size} / 2)`:""}show(){super.show(),this.update()}setMarkers(i){this.state.markers=i,this.update()}update(){var r;if(!this.isVisible())return;this.canvas.width=this.container.clientWidth*ne.pixelRatio,this.canvas.height=this.container.clientWidth*ne.pixelRatio;const i=this.canvas.getContext("2d");i.clearRect(0,0,this.canvas.width,this.canvas.height);const t=this.viewer.getPosition().yaw,e=qh.degToRad(this.viewer.state.hFov);this.__drawCone(i,this.config.coneColor,t,e);const s=this.__getMouseAngle();s!==null&&this.__drawCone(i,this.config.navigationColor,s,e),this.state.markers.forEach(a=>{this.__drawMarker(i,a)}),(r=this.config.hotspots)==null||r.forEach(a=>{"yaw"in a&&!("pitch"in a)&&(a.pitch=0);const l=this.viewer.dataHelper.cleanPosition(a);this.__drawPoint(i,a.color||this.config.hotspotColor,l.yaw,l.pitch)})}click(){const i=this.__getMouseAngle();i!==null&&this.viewer.rotate({yaw:i,pitch:0})}__drawCone(i,t,e,s){const r=e-Math.PI/2-s/2,a=r+s,l=this.canvas.width/2;i.beginPath(),i.moveTo(l,l),i.lineTo(l+Math.cos(r)*l,l+Math.sin(r)*l),i.arc(l,l,l,r,a,!1),i.lineTo(l,l),i.fillStyle=t,i.fill()}__drawMarker(i,t){let e=this.config.hotspotColor;if(typeof t.data.compass=="string"&&(e=t.data.compass),t.isPoly())i.beginPath(),t.definition.forEach(([s,r],a)=>{const l=s-Math.PI/2,u=(r+Math.PI/2)/Math.PI,c=this.canvas.width/2;i[a===0?"moveTo":"lineTo"](c+Math.cos(l)*c*u,c+Math.sin(l)*c*u)}),t.isPolygon()?(i.fillStyle=e,i.fill()):(i.strokeStyle=e,i.lineWidth=Math.max(1,this.canvas.width*Xm/2),i.stroke());else{const s=t.state.position;this.__drawPoint(i,e,s.yaw,s.pitch)}}__drawPoint(i,t,e,s){const r=e-Math.PI/2,a=(s+Math.PI/2)/Math.PI,l=this.canvas.width/2,u=Math.max(2,this.canvas.width*Xm);i.beginPath(),i.ellipse(l+Math.cos(r)*l*a,l+Math.sin(r)*l*a,u,u,0,0,Math.PI*2),i.fillStyle=t,i.fill()}__getMouseAngle(){if(!this.state.mouse)return null;const i=this.container.getBoundingClientRect(),t=this.state.mouse.clientX-i.left-i.width/2,e=this.state.mouse.clientY-i.top-i.width/2;return Math.sqrt(t*t+e*e)>i.width/2?null:Math.atan2(e,t)+Math.PI/2}},i3=it.getConfigParser({size:"120px",position:["top","left"],backgroundSvg:t3,coneColor:"rgba(255, 255, 255, 0.5)",navigation:!0,navigationColor:"rgba(255, 0, 0, 0.2)",hotspots:[],hotspotColor:"rgba(0, 0, 0, 0.5)"},{position:(i,{defValue:t})=>it.cleanCssPosition(i,{allowCenter:!0,cssOrder:!0})||t}),va=class extends Ma{constructor(i,t){super(i,t),this.component=new e3(this.viewer,this)}init(){super.init(),this.markers=this.viewer.getPlugin("markers"),this.viewer.addEventListener(st.RenderEvent.type,this),this.viewer.addEventListener(st.ReadyEvent.type,this,{once:!0}),this.markers&&this.markers.addEventListener("set-markers",this)}destroy(){this.viewer.removeEventListener(st.RenderEvent.type,this),this.viewer.removeEventListener(st.ReadyEvent.type,this),this.markers&&this.markers.removeEventListener("set-markers",this),this.component.destroy(),delete this.markers,super.destroy()}setOptions(i){super.setOptions(i),this.component.applyConfig(),this.component.update()}handleEvent(i){switch(i.type){case st.ReadyEvent.type:this.component.show();break;case st.RenderEvent.type:this.component.update();break;case"set-markers":this.component.setMarkers(i.markers.filter(t=>{var e;return(e=t.data)==null?void 0:e.compass}));break}}hide(){this.component.hide()}show(){this.component.show()}setHotspots(i){this.config.hotspots=i,this.component.update()}clearHotspots(){this.setHotspots(null)}};va.id="compass";va.configParser=i3;va.readonlyOptions=["navigation"];/*!
 * PhotoSphereViewer.GalleryPlugin 5.1.5
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var s3=Object.defineProperty,n3=(i,t)=>{for(var e in t)s3(i,e,{get:t[e],enumerable:!0})},r3={};n3(r3,{HideGalleryEvent:()=>lo,ShowGalleryEvent:()=>ar});var _g=class extends Sa{constructor(){super(_g.type)}},ar=_g;ar.type="show-gallery";var lo=class extends Sa{constructor(){super(ar.type)}};lo.type="hide-gallery";var o3='<svg viewBox="185 115 330 330" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M186.7 326.7V163.3c0-15 8.3-23.3 23.3-23.3h210c15 0 23.3 8.3 23.3 23.3v163.4c0 15-8.3 23.3-23.3 23.3H210c-15 0-23.3-8.3-23.3-23.3zm70 70v-23.4H420c30.2 0 46.7-16.4 46.7-46.6V210H490c15 0 23.3 8.3 23.3 23.3v163.4c0 15-8.3 23.3-23.3 23.3H280c-15 0-23.3-8.3-23.3-23.3zm-23.8-105H397l-40-50.4-26.7 29.7-44.3-54.5zm106.7-76c9.6 0 17.8-7.8 17.8-17.2a18 18 0 0 0-17.8-17.8c-9.4 0-17.2 8.2-17.2 17.8 0 9.4 7.8 17.2 17.2 17.2z"/><!--Created by Wolf B\xF6se from the Noun Project--></svg>',jh=class extends Yh{constructor(i){super(i,{className:"psv-gallery-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:o3}),this.plugin=this.viewer.getPlugin("gallery"),this.plugin&&(this.plugin.addEventListener(ar.type,this),this.plugin.addEventListener(lo.type,this))}destroy(){this.plugin&&(this.plugin.removeEventListener(ar.type,this),this.plugin.removeEventListener(lo.type,this)),super.destroy()}handleEvent(i){i instanceof ar?this.toggleActive(!0):i instanceof lo&&this.toggleActive(!1)}isSupported(){return!!this.plugin}onClick(){this.plugin.toggle()}};jh.id="gallery";var bg="psvGalleryItem",Ad=it.dasherize(bg),Pc="psv-gallery-item--active",a3=(i,t)=>`
${i.map(e=>`
<div class="psv-gallery-item" data-${Ad}="${e.id}" style="width:${t.width}px">
  <div class="psv-gallery-item-wrapper" style="padding-bottom:calc(100% * ${t.height} / ${t.width})">
    ${e.name?`<div class="psv-gallery-item-title"><span>${e.name}</span></div>`:""}
    <svg class="psv-gallery-item-thumb" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid slice"><use href="#psvGalleryBlankIcon"></use></svg>
    ${e.thumbnail?`<div class="psv-gallery-item-thumb" data-src="${e.thumbnail}"></div>`:""}
  </div>
</div>
`).join("")}
`,l3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">
  <defs>
    <symbol id="psvGalleryBlankIcon" viewBox="0 0 200 200">
      <rect x="0" y="0" width="200" height="200" fill="#666"/>
      <g transform="scale(0.25) translate(25 20) " fill="#eee">
        <path d="M376 220.61c-85.84 0-155.39 69.56-155.39 155.39 0 85.84 69.56 155.39 155.39 155.39 85.84 0 155.39-69.56 155.39-155.39 0-85.84-69.56-155.39-155.39-155.39zm0 300.92c-80.41 0-145.53-65.12-145.53-145.53S295.59 230.47 376 230.47 521.53 295.59 521.53 376 456.41 521.53 376 521.53z"/>
        <path d="M467.27 300.03H284.74a18.21 18.21 0 0 0-18.25 18.25v115.43a18.21 18.21 0 0 0 18.25 18.26h182.53a18.21 18.21 0 0 0 18.25-18.26V318.28a18.2 18.2 0 0 0-18.25-18.25zm-190.91 18.25a8.64 8.64 0 0 1 8.39-8.38h182.53a8.64 8.64 0 0 1 8.38 8.38V413l-44.89-35.52c-.49-.5-.99-.5-1.48-.99h-2.46c-.5 0-1 0-1.48.5l-37.5 21.2-43.9-58.7-.5-.5s0-.48-.49-.48c0 0-.49 0-.49-.5-.49 0-.49-.49-.99-.49-.49 0-.49 0-.98-.49H337.53c-.5 0-.5.5-.99.5h-.49l-.5.48s-.48 0-.48.5l-58.7 65.12zM467.27 442.1H284.74a8.64 8.64 0 0 1-8.39-8.38v-15.3l63.15-68.07 42.92 57.22 1.48 1.48h.49c.5.5 1.48.5 1.97.5H388.83l38.47-21.72 46.37 36.5c.5.5 1.49 1 1.98 1v8.88c0 3.95-3.45 7.9-8.38 7.9z"/>
        <path d="M429.77 333.58a13.81 13.81 0 1 1-27.63 0 13.81 13.81 0 0 1 27.63 0"/>
      </g>
    </symbol>
  </defs>
</svg>`,h3=class extends Ea{constructor(i,t){super(t,{className:`psv-gallery ${bs.CAPTURE_EVENTS_CLASS}`}),this.plugin=i,this.state={visible:!0,mousedown:!1,initMouseX:null,mouseX:null},this.container.innerHTML=l3,this.container.querySelector("svg").style.display="none";const e=document.createElement("div");e.className="psv-panel-close-button",e.innerHTML=bs.ICONS.close,this.container.appendChild(e),this.items=document.createElement("div"),this.items.className="psv-gallery-container",this.container.appendChild(this.items),this.observer=new IntersectionObserver(s=>{s.forEach(r=>{if(r.intersectionRatio>0){const a=r.target;a.style.backgroundImage=`url(${a.dataset.src})`,delete a.dataset.src,this.observer.unobserve(r.target)}})},{root:this.viewer.container}),this.container.addEventListener("wheel",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mousemove",this),this.container.addEventListener("click",this),window.addEventListener("mouseup",this),e.addEventListener("click",()=>this.plugin.hide()),this.hide()}destroy(){window.removeEventListener("mouseup",this),this.observer.disconnect(),super.destroy()}handleEvent(i){switch(i.type){case"wheel":this.container.scrollLeft+=i.deltaY*50,i.preventDefault();break;case"mousedown":this.state.mousedown=!0,this.state.initMouseX=i.clientX,this.state.mouseX=i.clientX;break;case"mousemove":if(this.state.mousedown){const t=this.state.mouseX-i.clientX;this.container.scrollLeft+=t,this.state.mouseX=i.clientX}break;case"mouseup":this.state.mousedown=!1,this.state.mouseX=null,i.preventDefault();break;case"click":if(Math.abs(this.state.initMouseX-i.clientX)<10){const t=it.getClosest(i.target,`[data-${Ad}]`);t&&this.plugin.__click(t.dataset[bg])}break}}show(){this.container.classList.add("psv-gallery--open"),this.state.visible=!0}hide(){this.container.classList.remove("psv-gallery--open"),this.state.visible=!1}setItems(i){this.items.innerHTML=a3(i,this.plugin.config.thumbnailSize),this.observer&&(this.observer.disconnect(),this.items.querySelectorAll("[data-src]").forEach(t=>{this.observer.observe(t)}))}setActive(i){const t=this.items.querySelector("."+Pc);if(t==null||t.classList.remove(Pc),i){const e=this.items.querySelector(`[data-${Ad}="${i}"]`);e==null||e.classList.add(Pc)}}},u3=it.getConfigParser({items:[],visibleOnLoad:!1,hideOnClick:!0,thumbnailSize:{width:200,height:100}}),Cn=class extends Ma{constructor(i,t){super(i,t),this.items=[],this.gallery=new h3(this,this.viewer)}init(){super.init(),this.viewer.addEventListener(st.PanoramaLoadedEvent.type,this),this.viewer.addEventListener(st.ShowPanelEvent.type,this),this.config.visibleOnLoad&&this.viewer.addEventListener(st.ReadyEvent.type,()=>{this.show()},{once:!0}),this.setItems(this.config.items),delete this.config.items,setTimeout(()=>this.__updateButton())}destroy(){this.viewer.removeEventListener(st.PanoramaLoadedEvent.type,this),this.viewer.removeEventListener(st.ShowPanelEvent.type,this),this.gallery.destroy(),super.destroy()}setOptions(i){super.setOptions(i),i.thumbnailSize&&this.gallery.setItems(this.items)}handleEvent(i){if(i instanceof st.PanoramaLoadedEvent){const t=this.items.find(e=>it.deepEqual(e.panorama,i.data.panorama));this.currentId=t==null?void 0:t.id,this.gallery.setActive(t==null?void 0:t.id)}else i instanceof st.ShowPanelEvent&&this.gallery.isVisible()&&this.hide()}show(){return this.dispatchEvent(new ar),this.gallery.show()}hide(){return this.dispatchEvent(new lo),this.gallery.hide()}toggle(){this.gallery.isVisible()?this.hide():this.show()}setItems(i,t){i?i.forEach((e,s)=>{if(!e.id)throw new _e(`Item ${s} has no "id".`);if(!e.panorama)throw new _e(`Item ${e.id} has no "panorama".`)}):i=[],this.handler=t,this.items=i.map(e=>({...e,id:`${e.id}`})),this.gallery.setItems(this.items),this.__updateButton()}__click(i){if(i!==this.currentId){if(this.handler)this.handler(i);else{const t=this.items.find(e=>e.id===i);this.viewer.setPanorama(t.panorama,{caption:t.name,...t.options})}this.currentId=i,this.gallery.setActive(i),this.config.hideOnClick&&this.hide()}}__updateButton(){var i;(i=this.viewer.navbar.getButton(jh.id,!1))==null||i.toggle(this.items.length>0)}};Cn.id="gallery";Cn.configParser=u3;Cn.readonlyOptions=["visibleOnLoad","items"];In.lang[jh.id]="Gallery";Gh(jh,"caption:left");/*!
 * PhotoSphereViewer.MapPlugin 5.1.5
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var c3=Object.defineProperty,d3=(i,t)=>{for(var e in t)c3(i,e,{get:t[e],enumerable:!0})},f3={};d3(f3,{SelectHotspot:()=>$d});var Mg=class extends Sa{constructor(i){super(Mg.type),this.hotspotId=i}},$d=Mg;$d.type="select-hotspot";var Qm="map",p3="__generated__",ph="__marker__",kl=2,Jm=4,m3=10;function g3(i){const t=document.createElement("img");if(!i.includes("<svg"))t.src=i;else{if(!/<svg[^>]*width="/.test(i)&&i.includes("viewBox")){const[,,,s,r]=/viewBox="([0-9-]+) ([0-9-]+) ([0-9]+) ([0-9]+)"/.exec(i);i=i.replace("<svg",`<svg width="${s}px" height="${r}px"`)}const e=`data:image/svg+xml;base64,${window.btoa(i)}`;t.src=e}return t}function v3(i){return i?i.includes("<svg")?i:`<img src="${i}">`:""}function y3(i,t,e){return{x:(Math.cos(t)*i.x-Math.sin(t)*i.y)/e,y:(Math.sin(t)*i.x+Math.cos(t)*i.y)/e}}function Km(i,t,e){return{x:(Math.cos(-t)*i.x-Math.sin(-t)*i.y)*e,y:(Math.sin(-t)*i.x+Math.cos(-t)*i.y)*e}}function Rc(i,t,e,s,r="black"){i.shadowOffsetX=t*ne.pixelRatio,i.shadowOffsetY=e*ne.pixelRatio,i.shadowBlur=s*ne.pixelRatio,i.shadowColor=r}function t0(i,t,e){const s=t.width,r=t.height;Eg(i,t,-e/2,-(r/s*e)/2,e,r/s*e)}function Eg(i,t,e,s,r,a){i.drawImage(t,0,0,t.width,t.height,e*ne.pixelRatio,s*ne.pixelRatio,r*ne.pixelRatio,a*ne.pixelRatio)}var x3='<svg viewBox="114 45 472 472" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M383.6 196a67.3 67.3 0 1 0-134.5.1 67.3 67.3 0 0 0 134.5-.1zm-100.8 0a33.6 33.6 0 1 1 67.3 0 33.6 33.6 0 0 1-67.3 0z"/><path d="M584 340.8a16.8 16.8 0 0 0-15.6-10.4H403.8c25.2-40.2 47-88 47-133.4A135 135 0 0 0 316.4 61.6 135 135 0 0 0 182 197c0 55.8 33 115.3 64.7 159.8L120.4 469a16.8 16.8 0 0 0 11.2 29.4H434c4.5 0 8.7-1.8 11.9-5l134.4-134.3c4.8-4.8 6.2-12 3.6-18.3zM215.5 197c0-56.1 45.2-101.8 100.8-101.8 55.6 0 100.8 45.6 100.8 101.8 0 65-57.1 144.2-100.8 192.8C273 341.7 215.6 262.3 215.6 197zM427 464.8H175.8l91.3-81.1a575.6 575.6 0 0 0 37.4 42.6 16.8 16.8 0 0 0 23.8 0c2.2-2.2 26.3-26.7 52.6-62.3h147z"/></g><!-- Created by Ayub Irawan from Noun Project --></svg>',Cl={top:"bottom",bottom:"top",left:"right",right:"left"};function w3(i,t){switch(t){case 1:return[Cl[i[0]],Cl[i[1]]];case 2:return[i[0],Cl[i[1]]];case 3:return[Cl[i[0]],i[1]];default:return i}}var Zh=class extends Ea{constructor(i,t){super(i,{}),this.map=i,this.position=t}applyConfig(){this.container.className=`psv-map__button psv-map__button--${w3(this.map.config.position,this.position).join("-")}`,this.update()}update(){}},_3=class extends Zh{constructor(i){super(i,0),this.container.addEventListener("click",t=>{i.toggleCollapse(),t.stopPropagation()})}applyConfig(){super.applyConfig(),this.container.classList.add("psv-map__button-close")}update(){this.container.innerHTML=this.map.collapsed?x3:bs.ICONS.close,this.container.title=this.map.collapsed?this.viewer.config.lang.map:this.viewer.config.lang.close}},b3='<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50,0L70,50L50,100L30,50Z M50,86L64,50L36,50Z" fill="currentColor"/></svg>',M3=class extends Zh{constructor(i){super(i,3),this.container.innerHTML=b3,this.container.querySelector("svg").style.width="80%",this.container.addEventListener("click",t=>{this.viewer.dynamics.position.goto({yaw:-i.config.rotation},2),t.stopPropagation()})}rotate(i){this.container.querySelector("svg").style.transform=`rotate3d(0, 0, 1, ${-i}rad)`}},E3='<svg viewBox="95 25 510 510" xmlns="http://www.w3.org/2000/svg"><path d="M604.2 39.8v481c0 7.8-6.1 14-14 14H358.4c-7.8 0-14-6.2-14-14s6.2-14 14-14h217.8v-453H123.8v216.7c0 7.8-6.2 14-14 14-7.9 0-14-6.2-14-14V39.8c0-7.9 6.1-14 14-14h481c7.3 0 13.4 6.1 13.4 14zm-304 304v176.4c0 7.9-6.2 14-14 14H109.8c-7.9 0-14-6.1-14-14V343.8c0-7.8 6.1-14 14-14h176.4c7.2 0 14 6.8 14 14zm-28 14H123.8v148.4h148.4zm215.6-195.4v79.5c0 7.9 6.1 14 14 14 7.8 0 14-6.1 14-14V128.2c0-7.8-6.2-14-14-14H388.6c-7.8 0-14 6.2-14 14 0 7.9 6.2 14 14 14h79L326.5 283.4a13.5 13.5 0 0 0 0 19.6c2.8 2.8 6.1 3.9 10 3.9 4 0 7.3-1.1 10.1-4z" fill="currentColor"/><!-- Created by Gregor Cresnar from Noun Project --></svg>',S3='<svg viewBox="95 25 510 510" xmlns="http://www.w3.org/2000/svg"><path d="M109.8 25.8h481c7.8 0 14 6.1 14 14v481c0 7.8-6.2 14-14 14H358.4c-7.8 0-14-6.2-14-14s6.2-14 14-14h217.8v-453H123.8v216.7c0 7.8-6.2 14-14 14-7.9 0-14-6.2-14-14V39.8c0-7.9 6.1-14 14-14zm176.4 508.4H109.8c-7.9 0-14-6.1-14-14V343.8c0-7.8 6.1-14 14-14h176.4c7.8 0 14 6.2 14 14v176.4c0 7.9-6.8 14-14 14zm-14-176.4H123.8v148.4h148.4zm64.4-191.5c-7.9 0-14 6.2-14 14v113.1c0 7.9 6.1 14 14 14h113c8 0 14-6.1 14-14s-6-14-14-14h-79.4l141-141a13.5 13.5 0 0 0 0-19.7 13.5 13.5 0 0 0-19.5 0L350.6 259.8v-79.5c0-7.8-6.2-14-14-14z" fill="currentColor"/><!-- Created by Gregor Cresnar from Noun Project --></svg>',A3={"bottom-left":0,"bottom-right":-90,"top-right":180,"top-left":90},k3=class extends Zh{constructor(i){super(i,1),this.container.addEventListener("click",t=>{i.toggleMaximized(),t.stopPropagation()})}update(){this.container.innerHTML=this.map.maximized?S3:E3,this.container.querySelector("svg").style.transform=`rotate3d(0, 0, 1, ${A3[this.map.config.position.join("-")]}deg)`,this.container.title=this.map.maximized?this.viewer.config.lang.mapMinimize:this.viewer.config.lang.mapMaximize}},C3='<svg viewBox="170 100 360 360" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M518.6 269h-18.5a150.8 150.8 0 0 0-138-137.9v-20.9c0-5.8-4.7-10.6-10.5-10.6h-3.2c-5.8 0-10.6 4.8-10.6 10.6v21A150.8 150.8 0 0 0 200 269h-18.5c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h18.5c6 73.4 64.6 132 138 138v18.5c0 5.8 4.7 10.6 10.5 10.6h3.2c5.8 0 10.6-4.8 10.6-10.6v-18.6c73.3-5.9 132-64.5 137.9-137.9h18.5c5.9 0 10.6-4.7 10.6-10.5v-3.2c0-5.9-4.7-10.6-10.6-10.6zM362.2 414.4v-9.8c0-5.9-4.8-10.6-10.6-10.6h-3.2c-5.8 0-10.6 4.7-10.6 10.6v9.8a134 134 0 0 1-121-121h9.8c5.9 0 10.6-4.8 10.6-10.6v-3.2c0-5.9-4.7-10.6-10.6-10.6h-9.8a134 134 0 0 1 121-121v7.5c0 5.8 4.8 10.5 10.6 10.5h3.2c5.8 0 10.6-4.7 10.6-10.5V148a134 134 0 0 1 121 121h-9.8c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h9.8a134 134 0 0 1-121 121z"/><path d="M355.4 222a6 6 0 0 0-10.7 0L291 320a8.3 8.3 0 0 0 9.7 12l39.2-11.7c6.6-2 13.6-2 20.2 0l39.2 11.7a8.3 8.3 0 0 0 9.7-12z"/></g><!-- Created by muhammad benani from Noun Project --></svg>',z3=class extends Zh{constructor(i){super(i,2),this.container.title=this.viewer.config.lang.mapReset,this.container.innerHTML=C3,this.container.querySelector("svg").style.width="80%",this.container.addEventListener("click",t=>{i.reset(),t.stopPropagation()})}},T3='<svg viewBox="128 58 444 444" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M350 58.2a221.8 221.8 0 1 0 0 443.6 221.8 221.8 0 0 0 0-443.6zm130.3 252.7H219.7a31 31 0 1 1 0-61.8h260.6a31 31 0 1 1 0 61.8z"/><!-- Created by Iconika from Noun Project --></svg>',O3='<svg viewBox="143.8 73.8 412.5 412.5" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M350 73.8a206.2 206.2 0 1 0 0 412.4 206.2 206.2 0 0 0 0-412.4zm117.3 234H378v89.5a27.9 27.9 0 1 1-55.8 0V308h-89.4a27.9 27.9 0 1 1 0-55.8H322v-89.5a27.9 27.9 0 1 1 55.8 0v89.5h89.5a27.9 27.9 0 1 1 0 55.8z"/><!-- Created by Iconika from Noun Project --></svg>',I3=class extends Ea{constructor(i){super(i,{className:"psv-map__toolbar"}),this.map=i,this.handler=new it.PressHandler(100),this.container.innerHTML=`${T3}<span class="psv-map__toolbar-text">100%</span>${O3}`,this.zoomIndicator=this.container.querySelector(".psv-map__toolbar-text");const t=this.container.querySelectorAll("svg");t[0].dataset.delta="-1",t[1].dataset.delta="1",this.container.addEventListener("mousedown",this),window.addEventListener("mouseup",this),this.container.addEventListener("touchstart",this),window.addEventListener("touchend",this)}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),super.destroy()}handleEvent(i){switch(i.type){case"mousedown":case"touchstart":{const t=it.getClosest(i.target,"svg"),e=t==null?void 0:t.dataset.delta;e&&(cancelAnimationFrame(this.animation),this.handler.down(),this.time=performance.now(),this.animateZoom(parseInt(e,10)),i.preventDefault(),i.stopPropagation());break}case"mouseup":case"touchend":this.animation&&(this.handler.up(()=>{cancelAnimationFrame(this.animation),this.animation=null}),i.preventDefault(),i.stopPropagation());break}}setText(i){this.zoomIndicator.innerText=`${Math.round(Math.exp(i)*100)}%`}animateZoom(i){this.animation=requestAnimationFrame(t=>{this.map.zoom(i*(t-this.time)/1e3),this.time=t,this.animateZoom(i)})}},L3=class extends Ea{constructor(i,t){super(i,{className:`psv-map ${bs.CAPTURE_EVENTS_CLASS}`}),this.plugin=t,this.state={visible:!1,maximized:!1,collapsed:!1,imgScale:1,zoom:this.config.defaultZoom,offset:{x:0,y:0},mouseX:null,mouseY:null,mousedown:!1,pinchDist:0,pinchAngle:0,hotspotPos:{},hotspotId:null,hotspotTooltip:null,markers:[],forceRender:!1,needsUpdate:!1,renderLoop:null,images:{}};const e=document.createElement("div");e.className="psv-map__container",e.addEventListener("mousedown",this),window.addEventListener("mousemove",this),window.addEventListener("mouseup",this),e.addEventListener("touchstart",this),window.addEventListener("touchmove",this),window.addEventListener("touchend",this),e.addEventListener("wheel",this),this.canvas=document.createElement("canvas"),e.appendChild(this.canvas),this.overlay=document.createElement("div"),this.overlay.className="psv-map__overlay",e.appendChild(this.overlay),this.container.appendChild(e),this.container.addEventListener("transitionstart",this),this.container.addEventListener("transitionend",this),this.resetButton=new z3(this),this.maximizeButton=new k3(this),this.closeButton=new _3(this),this.compassButton=new M3(this),this.zoomToolbar=new I3(this);const s=()=>{this.isVisible()&&(this.state.needsUpdate||this.state.forceRender)&&(this.render(),this.state.needsUpdate=!1),this.state.renderLoop=requestAnimationFrame(s)};s(),this.applyConfig(),this.hide(),this.config.visibleOnLoad||this.toggleCollapse()}get config(){return this.plugin.config}get maximized(){return this.state.maximized}get collapsed(){return this.state.collapsed}destroy(){window.removeEventListener("touchmove",this),window.removeEventListener("mousemove",this),window.removeEventListener("touchend",this),window.removeEventListener("mouseup",this),cancelAnimationFrame(this.state.renderLoop),super.destroy()}handleEvent(i){var t;if(!it.getClosest(i.target,`.${bs.CAPTURE_EVENTS_CLASS}:not(.psv-map)`))switch(i.type){case"mousedown":{const e=i;this.state.mouseX=e.clientX,this.state.mouseY=e.clientY,this.state.mousedown=!0,i.stopPropagation();break}case"touchstart":{const e=i;e.touches.length===1?(this.state.mouseX=e.touches[0].clientX,this.state.mouseY=e.touches[0].clientY,this.state.mousedown=!0):e.touches.length===2&&({distance:this.state.pinchDist,angle:this.state.pinchAngle,center:{x:this.state.mouseX,y:this.state.mouseY}}=it.getTouchData(e)),i.stopPropagation(),i.preventDefault();break}case"mousemove":{const e=i;this.state.mousedown?(this.__move(e.clientX,e.clientY),i.stopPropagation()):this.__handleHotspots(e.clientX,e.clientY);break}case"touchmove":{const e=i;if(this.state.mousedown&&e.touches.length===1)this.__move(e.touches[0].clientX,e.touches[0].clientY),i.stopPropagation();else if(this.state.mousedown&&e.touches.length===2){const s=it.getTouchData(e),r=(s.distance-this.state.pinchDist)/ne.pixelRatio;this.zoom(r/100),this.__move(s.center.x,s.center.y),this.state.maximized&&!this.config.static&&this.viewer.dynamics.position.step({yaw:this.state.pinchAngle-s.angle},0),{distance:this.state.pinchDist,angle:this.state.pinchAngle}=s,i.stopPropagation()}break}case"mouseup":case"touchend":{const e=((t=i.changedTouches)==null?void 0:t[0])||i;this.state.mousedown&&(this.state.mousedown=!1,i.stopPropagation()),this.__clickHotspot(e.clientX,e.clientY);break}case"wheel":{const e=i,s=e.deltaY/Math.abs(e.deltaY);this.zoom(-s/10),i.stopPropagation(),i.preventDefault();break}case"transitionstart":this.state.forceRender=!0;break;case"transitionend":this.state.maximized||(this.overlay.style.display=""),this.state.forceRender=!1,this.update();break}}applyConfig(){this.container.classList.remove("psv-map--top-right","psv-map--top-left","psv-map--bottom-right","psv-map--bottom-left"),this.container.classList.add(`psv-map--${this.config.position.join("-")}`),this.container.style.width=this.config.size,this.container.style.height=this.config.size,this.overlay.innerHTML=v3(this.config.overlayImage),this.resetButton.applyConfig(),this.closeButton.applyConfig(),this.compassButton.applyConfig(),this.maximizeButton.applyConfig(),this.config.static&&(this.compassButton.rotate(0),this.overlay.style.transform=""),this.update()}isVisible(){return this.state.visible&&!this.state.collapsed}show(){super.show(),this.update(),this.state.maximized||(this.overlay.style.display="")}hide(){super.hide(),this.state.forceRender=!1}update(){this.state.needsUpdate=!0}reload(i){delete this.state.images[this.config.imageUrl],this.config.imageUrl=i,this.state.imgScale=1,this.__loadImage(this.config.imageUrl,!0),this.recenter()}reset(){this.state.zoom=this.config.defaultZoom,this.recenter()}recenter(){this.state.offset.x=0,this.state.offset.y=0,this.update()}toggleCollapse(){this.state.maximized&&this.toggleMaximized(),this.state.collapsed=!this.state.collapsed,it.toggleClass(this.container,"psv-map--collapsed",this.state.collapsed),this.state.collapsed||this.reset(),this.closeButton.update()}toggleMaximized(){this.state.collapsed||(this.state.maximized=!this.state.maximized,it.toggleClass(this.container,"psv-map--maximized",this.state.maximized),this.state.maximized&&(this.overlay.style.display="none"),this.maximizeButton.update())}zoom(i){this.state.zoom=qh.clamp(this.state.zoom+i,this.config.minZoom,this.config.maxZoom),this.update()}setMarkers(i){this.state.markers=i,this.update()}render(){if(!this.config.center)return;const i=this.__loadImage(this.config.imageUrl);if(!i)return;this.state.hotspotPos={},this.__resetHotspot();const t=this.viewer.getPosition().yaw,e=Math.exp(this.state.zoom)/this.state.imgScale,s={x:this.config.center.x*this.state.imgScale,y:this.config.center.y*this.state.imgScale},r={x:this.state.offset.x*this.state.imgScale,y:this.state.offset.y*this.state.imgScale},a=this.config.rotation,l=this.config.static?0:t+a;this.config.static||(this.overlay.style.transform=`rotate(${-l}rad)`,this.compassButton.rotate(l)),this.zoomToolbar.setText(this.state.zoom),this.canvas.width=this.container.clientWidth*ne.pixelRatio,this.canvas.height=this.container.clientHeight*ne.pixelRatio;const u=it.getPosition(this.canvas),c=this.canvas.width,d=this.canvas.height,f=c/2/ne.pixelRatio,m=d/2/ne.pixelRatio,g=this.canvas.getContext("2d");g.clearRect(0,0,c,d);const v=i.width,x=i.height;g.save(),g.translate(c/2,d/2),g.rotate(-l),g.scale(e,e),Rc(g,0,0,m3),Eg(g,i,-s.x-r.x,-s.y-r.y,v,x),g.restore(),[...this.config.hotspots,...this.state.markers].forEach(E=>{const S=this.__loadImage(E.image||this.config.spotImage),z={...r};if("yaw"in E&&"distance"in E){const $=it.parseAngle(E.yaw)+a;z.x+=Math.sin(-$)*E.distance*this.state.imgScale,z.y+=Math.cos(-$)*E.distance*this.state.imgScale}else if("x"in E&&"y"in E)z.x+=s.x-E.x*this.state.imgScale,z.y+=s.y-E.y*this.state.imgScale;else{it.logWarn(`Hotspot ${E.id} is missing position (yaw+distance or x+y)`);return}const I=Km(z,l,e),O=f-I.x,P=m-I.y,G=E.size||this.config.spotSize;this.state.hotspotPos[E.id]={x:O+u.x,y:P+u.y,s:G},g.save(),g.translate(O*ne.pixelRatio,P*ne.pixelRatio),Rc(g,kl,kl,Jm),S?t0(g,S,G):(g.fillStyle=E.color||this.config.spotColor,g.beginPath(),g.arc(0,0,G*ne.pixelRatio/2,0,2*Math.PI),g.fill()),g.restore()});const b=this.__loadImage(this.config.pinImage);if(b){const E=Km(r,l,e),S=f-E.x,z=m-E.y,I=this.config.pinSize,O=this.config.static?t+a:0;g.save(),g.translate(S*ne.pixelRatio,z*ne.pixelRatio),g.rotate(O),Rc(g,kl,kl,Jm),t0(g,b,I),g.restore()}}__move(i,t){const e=this.viewer.getPosition().yaw,s=Math.exp(this.state.zoom),r=y3({x:this.state.mouseX-i,y:this.state.mouseY-t},this.config.static?0:e+this.config.rotation,s);this.state.offset.x+=r.x,this.state.offset.y+=r.y,this.update(),this.state.mouseX=i,this.state.mouseY=t}__findHotspot(i,t){const e=this.config.spotSize/2;let s=null;for(const[r,{x:a,y:l}]of Object.entries(this.state.hotspotPos))if(i>a-e&&i<a+e&&t>l-e&&t<l+e){s=r;break}return s}__handleHotspots(i,t){var s,r;const e=this.__findHotspot(i,t);if(this.state.hotspotId!==e){if(this.__resetHotspot(),e){let a;if(e.startsWith(ph)?a=(s=this.state.markers.find(({id:l})=>l===e))==null?void 0:s.tooltip:a=(r=this.config.hotspots.find(({id:l})=>l===e))==null?void 0:r.tooltip,a){const l=this.state.hotspotPos[e],u=it.getPosition(this.viewer.container);this.state.hotspotTooltip=this.viewer.createTooltip({content:a,left:l.x-u.x,top:l.y-u.y,box:{width:l.s,height:l.s}})}}this.state.hotspotId=e}}__clickHotspot(i,t){const e=this.__findHotspot(i,t);if(e){if(this.plugin.dispatchEvent(new $d(e)),e.startsWith(ph)){const s=e.substring(ph.length);this.viewer.getPlugin("markers").gotoMarker(s)}this.maximized&&this.toggleMaximized()}this.__resetHotspot()}__resetHotspot(){var i;(i=this.state.hotspotTooltip)==null||i.hide(),this.state.hotspotTooltip=null,this.state.hotspotId=null}__loadImage(i,t=!1){if(!i)return null;if(!this.state.images[i]){const e=g3(i);return this.state.images[i]={loading:!0,value:e},e.onload=()=>{if(t&&Math.max(e.width,e.height)>ne.maxCanvasWidth){this.state.imgScale=ne.maxCanvasWidth/Math.max(e.width,e.height);const s=document.createElement("canvas");s.width=e.width*this.state.imgScale,s.height=e.height*this.state.imgScale,s.getContext("2d").drawImage(e,0,0,s.width,s.height),this.state.images[i].value=s}this.state.images[i].loading=!1,this.update(),t&&this.show()},null}return this.state.images[i].loading?null:this.state.images[i].value}},P3=`<svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
    <defs>
        <radialGradient id="gradient">
            <stop offset="80%" stop-color="rgba(255, 255, 255, 0)"/>
            <stop offset="90%" stop-color="rgba(255, 255, 255, .5)"/>
        </radialGradient>
    </defs>
    <circle cx="250" cy="250" r="250" fill="url(#gradient)"/>
    <circle cx="250" cy="250" r="245" fill="none" stroke="rgba(255, 255, 255, 0.8)" stroke-width="10"/>
    <g fill="#222">
        <rect x="1" y="248" width="18" height="4"/>
        <rect x="481" y="248" width="18" height="4"/>
        <rect x="248" y="1" width="4" height="18"/>
        <rect x="248" y="481" width="4" height="18"/>
    </g>
</svg>`,R3=`<svg viewBox="-20 -20 740 740" xmlns="http://www.w3.org/2000/svg">
    <path d="M350 540a189.4 189.4 0 0 1-189.2-189.1c0-92.4 47.7-143 98.3-225L350-20l90.9 146c50.6 81.9 98.2 132.5 98.2 224.9A189.4 189.4 0 0 1 350 540z" fill="white"/>
    <circle cx="350" cy="350" r="150" fill="#1E78E6"/>
</svg>
`,F3=it.getConfigParser({imageUrl:null,center:null,rotation:0,size:"200px",position:["bottom","left"],visibleOnLoad:!0,overlayImage:P3,compassImage:null,pinImage:R3,pinSize:35,spotColor:"white",spotImage:null,spotSize:15,static:!1,defaultZoom:100,minZoom:20,maxZoom:200,hotspots:[]},{overlayImage:(i,{rawConfig:t})=>t.compassImage?(it.logWarn('map: "compassImage" is deprecated, use "overlayImage" instead'),t.compassImage):i,position:(i,{defValue:t})=>it.cleanCssPosition(i,{allowCenter:!1,cssOrder:!0})||t,rotation:i=>it.parseAngle(i),defaultZoom:i=>Math.log(i/100),maxZoom:i=>Math.log(i/100),minZoom:i=>Math.log(i/100)}),ho=class extends Ma{constructor(i,t){super(i,t),this.component=new L3(this.viewer,this)}init(){super.init(),this.markers=this.viewer.getPlugin("markers"),this.viewer.addEventListener(st.PositionUpdatedEvent.type,this),this.viewer.addEventListener(st.SizeUpdatedEvent.type,this),this.viewer.addEventListener(st.ReadyEvent.type,this,{once:!0}),this.setHotspots(this.config.hotspots,!1),this.markers&&this.markers.addEventListener("set-markers",this)}destroy(){this.viewer.removeEventListener(st.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(st.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(st.ReadyEvent.type,this),this.markers&&this.markers.removeEventListener("set-markers",this),this.component.destroy(),delete this.markers,super.destroy()}handleEvent(i){switch(i.type){case st.ReadyEvent.type:this.component.reload(this.config.imageUrl);break;case st.PositionUpdatedEvent.type:this.component.update();break;case st.SizeUpdatedEvent.type:this.component.maximized&&this.component.update();break;case"set-markers":this.component.setMarkers(this.__markersToHotspots(i.markers));break}}setOptions(i){super.setOptions(i),this.component.applyConfig()}hide(){this.component.hide()}show(){this.component.show()}close(){this.component.collapsed||this.component.toggleCollapse()}open(){this.component.collapsed&&this.component.toggleCollapse()}minimize(){this.component.maximized&&this.component.toggleMaximized()}maximize(){this.component.maximized||this.component.toggleMaximized()}setImage(i,t,e){it.isNil(e)||(this.config.rotation=it.parseAngle(e)),it.isNil(t)||(this.config.center=t),this.component.reload(i)}setCenter(i){this.config.center=i,this.component.recenter()}setHotspots(i,t=!0){const e=[];let s=1;i==null||i.forEach(r=>{r.id?e.includes(r.id)?it.logWarn(`Duplicated hotspot id "${r.id}`):e.push(r.id):r.id=p3+s++}),this.config.hotspots=i||[],t&&this.component.update()}clearHotspots(){this.setHotspots(null)}__markersToHotspots(i){return i.filter(t=>{var e;return(e=t.data)==null?void 0:e[Qm]}).map(t=>{var r;const e=t.data[Qm],s={...e,id:ph+t.id,tooltip:(r=t.config.tooltip)==null?void 0:r.content};if("distance"in e)s.yaw=t.state.position.yaw;else if(!("x"in e)||!("y"in e))return it.logWarn(`Marker ${t.id} "map" data is missing position (distance or x+y)`),null;return s}).filter(t=>t)}};ho.id="map";ho.configParser=F3;ho.readonlyOptions=["imageUrl","center","visibleOnLoad","hotspots","defaultZoom"];In.lang.map="Map";In.lang.mapMaximize="Maximize";In.lang.mapMinimize="Minimize";In.lang.mapReset="Reset";/*!
 * PhotoSphereViewer.MarkersPlugin 5.1.5
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var $3=Object.defineProperty,B3=(i,t)=>{for(var e in t)$3(i,e,{get:t[e],enumerable:!0})},N3={};B3(N3,{EnterMarkerEvent:()=>Fh,GotoMarkerDoneEvent:()=>Ph,HideMarkersEvent:()=>uo,LeaveMarkerEvent:()=>Rh,MarkerVisibilityEvent:()=>Bd,MarkersPluginEvent:()=>Bi,RenderMarkersListEvent:()=>Hd,SelectMarkerEvent:()=>Nd,SelectMarkerListEvent:()=>Ud,SetMarkersEvent:()=>Vd,ShowMarkersEvent:()=>co,UnselectMarkerEvent:()=>Dd});var Bi=class extends Sa{},Sg=class extends Bi{constructor(i,t){super(Sg.type),this.marker=i,this.visible=t}},Bd=Sg;Bd.type="marker-visibility";var Ag=class extends Bi{constructor(i){super(Ag.type),this.marker=i}},Ph=Ag;Ph.type="goto-marker-done";var kg=class extends Bi{constructor(i){super(kg.type),this.marker=i}},Rh=kg;Rh.type="leave-marker";var Cg=class extends Bi{constructor(i){super(Cg.type),this.marker=i}},Fh=Cg;Fh.type="enter-marker";var zg=class extends Bi{constructor(i,t,e){super(zg.type),this.marker=i,this.doubleClick=t,this.rightClick=e}},Nd=zg;Nd.type="select-marker";var Tg=class extends Bi{constructor(i){super(Tg.type),this.marker=i}},Ud=Tg;Ud.type="select-marker-list";var Og=class extends Bi{constructor(i){super(Og.type),this.marker=i}},Dd=Og;Dd.type="unselect-marker";var Ig=class extends Bi{constructor(){super(Ig.type)}},uo=Ig;uo.type="hide-markers";var Lg=class extends Bi{constructor(i){super(Lg.type),this.markers=i}},Vd=Lg;Vd.type="set-markers";var Pg=class extends Bi{constructor(){super(Pg.type)}},co=Pg;co.type="show-markers";var Rg=class extends Bi{constructor(i){super(Rg.type),this.markers=i}},Hd=Rg;Hd.type="render-markers-list";var U3=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,ya=class extends Yh{constructor(i){super(i,{className:"psv-markers-button",icon:U3,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(co.type,this),this.plugin.addEventListener(uo.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(co.type,this),this.plugin.removeEventListener(uo.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(i){i instanceof co?this.toggleActive(!0):i instanceof uo&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};ya.id="markers";var Fg=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/><!--Created by Rohith M S from the Noun Project--></svg>
`,mh="http://www.w3.org/2000/svg",Oe="psvMarker",D3=it.dasherize(Oe),jo="marker",oo="markersList",V3=(i,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
 <h1 class="psv-panel-menu-title">${Fg} ${t}</h1>
 <ul class="psv-panel-menu-list">
   ${i.map(e=>`
   <li data-${D3}="${e.id}" class="psv-panel-menu-item" tabindex="0">
     ${e.type==="image"?`<span class="psv-panel-menu-item-icon"><img src="${e.definition}"/></span>`:""}
     <span class="psv-panel-menu-item-label">${e.getListContent()}</span>
   </li>
   `).join("")}
 </ul>
</div>
`,Xh=class extends Yh{constructor(i){super(i,{className:" psv-markers-list-button",icon:Fg,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(st.ShowPanelEvent.type,this),this.viewer.addEventListener(st.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(st.ShowPanelEvent.type,this),this.viewer.removeEventListener(st.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(i){i instanceof st.ShowPanelEvent?this.toggleActive(i.panelId===oo):i instanceof st.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};Xh.id="markersList";function H3(i,t,e){const[s,r]=i,[a,l]=t,u=it.greatArcDistance(i,t),c=Math.sin((1-e)*u)/Math.sin(u),d=Math.sin(e*u)/Math.sin(u),f=c*Math.cos(r)*Math.cos(s)+d*Math.cos(l)*Math.cos(a),m=c*Math.cos(r)*Math.sin(s)+d*Math.cos(l)*Math.sin(a),g=c*Math.sin(r)+d*Math.sin(l);return[Math.atan2(m,f),Math.atan2(g,Math.sqrt(f*f+m*m))]}function $g(i){const t=[i[0]];let e=0;for(let s=1;s<i.length;s++){const r=i[s-1][0]-i[s][0];r>Math.PI?e+=1:r<-Math.PI&&(e-=1),t.push([i[s][0]+e*2*Math.PI,i[s][1]])}return t}function W3(i){const e=$g(i).reduce((s,r)=>[s[0]+r[0],s[1]+r[1]]);return[it.parseAngle(e[0]/i.length),e[1]/i.length]}function q3(i){const t=$g(i);let e=0;const s=[];for(let a=0;a<t.length-1;a++){const l=it.greatArcDistance(t[a],t[a+1])*bs.SPHERE_RADIUS;s.push(l),e+=l}let r=0;for(let a=0;a<t.length-1;a++){if(r+s[a]>e/2){const l=(e/2-r)/s[a];return H3(t[a],t[a+1],l)}r+=s[a]}return t[Math.round(t.length/2)]}var gh=(i=>(i.image="image",i.imageLayer="imageLayer",i.html="html",i.polygon="polygon",i.polygonPixels="polygonPixels",i.polyline="polyline",i.polylinePixels="polylinePixels",i.square="square",i.rect="rect",i.circle="circle",i.ellipse="ellipse",i.path="path",i))(gh||{}),kd=class{constructor(i,t){if(this.viewer=i,this.visible=!0,this.state={dynamicSize:!1,anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!t.id)throw new _e("missing marker id");if(this.type=kd.getType(t),this.isNormal())this.element=document.createElement("div");else if(this.isPolygon())this.element=document.createElementNS(mh,"polygon");else if(this.isPolyline())this.element=document.createElementNS(mh,"polyline");else if(this.isSvg()){const e=this.type==="square"?"rect":this.type;this.element=document.createElementNS(mh,e)}else this.is3d()&&(this.element=this.__createMesh(),this.loader=new $S,this.viewer.config.withCredentials&&this.loader.setWithCredentials(!0));this.is3d()||(this.element.id=`psv-marker-${t.id}`,this.element[Oe]=this),this.update(t)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return this.is3d()?null:this.element}get threeElement(){return this.is3d()?this.element:null}destroy(){this.hideTooltip(),this.is3d()?delete this.threeElement.children[0].userData[Oe]:delete this.element[Oe]}is3d(){return this.type==="imageLayer"}isNormal(){return this.type==="image"||this.type==="html"}isPoly(){return this.isPolygon()||this.isPolyline()}isPolyPixels(){return this.type==="polygonPixels"||this.type==="polylinePixels"}isPolyAngles(){return this.type==="polygon"||this.type==="polyline"}isPolygon(){return this.type==="polygon"||this.type==="polygonPixels"}isPolyline(){return this.type==="polyline"||this.type==="polylinePixels"}isSvg(){return this.type==="square"||this.type==="rect"||this.type==="circle"||this.type==="ellipse"||this.type==="path"}getScale(i,t){if(!this.config.scale)return 1;if(typeof this.config.scale=="function")return this.config.scale(i,t);let e=1;if(Array.isArray(this.config.scale.zoom)){const[s,r]=this.config.scale.zoom;e*=s+(r-s)*bs.EASINGS.inQuad(i/100)}if(Array.isArray(this.config.scale.yaw)){const[s,r]=this.config.scale.yaw,a=qh.degToRad(this.viewer.state.hFov)/2,l=Math.abs(it.getShortestArc(this.state.position.yaw,t.yaw));e*=r+(s-r)*bs.EASINGS.outQuad(Math.max(0,(a-l)/a))}return e}getListContent(){var i;return this.config.listContent?this.config.listContent:(i=this.config.tooltip)!=null&&i.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(i,t){var e;if(this.state.visible&&((e=this.config.tooltip)==null?void 0:e.content)&&this.state.position2D){const s={...this.config.tooltip,data:this,top:0,left:0};if(this.isPoly())if(i||t){const r=it.getPosition(this.viewer.container);s.top=t-r.y,s.left=i-r.x,s.box={width:20,height:20}}else s.top=this.state.position2D.y,s.left=this.state.position2D.x;else s.top=this.state.position2D.y+this.state.size.height/2,s.left=this.state.position2D.x+this.state.size.width/2,s.box={width:this.state.size.width,height:this.state.size.height};this.tooltip?this.tooltip.move(s):this.tooltip=this.viewer.createTooltip(s)}}refreshTooltip(){this.tooltip&&this.showTooltip()}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}update(i){var e;const t=kd.getType(i,!0);if(t!==void 0&&t!==this.type)throw new _e("cannot change marker type");if(it.isExtendedPosition(i)&&(it.logWarn('Use the "position" property to configure the position of a marker'),i.position=this.viewer.dataHelper.cleanPosition(i)),"width"in i&&"height"in i&&(it.logWarn('Use the "size" property to configure the size of a marker'),i.size={width:i.width,height:i.height}),this.config=it.deepmerge(this.config,i),typeof this.config.tooltip=="string"&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),this.visible=this.config.visible!==!1,this.state.anchor=it.parsePoint(this.config.anchor),!this.is3d()){const s=this.domElement;this.isNormal()?s.setAttribute("class","psv-marker psv-marker--normal"):s.setAttribute("class","psv-marker psv-marker--svg"),this.config.className&&it.addClasses(s,this.config.className),this.config.tooltip&&s.classList.add("psv-marker--has-tooltip"),this.config.content&&s.classList.add("psv-marker--has-content"),s.style.opacity=`${(e=this.config.opacity)!=null?e:1}`,this.config.style&&Object.assign(s.style,this.config.style)}this.isNormal()?this.__updateNormal():this.isPoly()?this.__updatePoly():this.isSvg()?this.__updateSvg():this.is3d()&&this.__update3d()}__updateNormal(){const i=this.domElement;if(!it.isExtendedPosition(this.config.position))throw new _e("missing marker position");if(this.config.image&&!this.config.size)throw new _e("missing marker size");this.config.size?(this.state.dynamicSize=!1,this.state.size=this.config.size,i.style.width=this.config.size.width+"px",i.style.height=this.config.size.height+"px"):this.state.dynamicSize=!0,this.config.image?(this.definition=this.config.image,i.style.backgroundImage=`url(${this.config.image})`):this.config.html&&(this.definition=this.config.html,i.innerHTML=this.config.html),i.style.transformOrigin=`${this.state.anchor.x*100}% ${this.state.anchor.y*100}%`,this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position),this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)]}__updateSvg(){const i=this.domElement;if(!it.isExtendedPosition(this.config.position))throw new _e("missing marker position");switch(this.state.dynamicSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path};break}Object.entries(this.definition).forEach(([t,e])=>{i.setAttributeNS(null,t,e)}),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach(([t,e])=>{i.setAttributeNS(null,it.dasherize(t),e)}):i.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"),this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position),this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)]}__updatePoly(){const i=this.domElement;this.state.dynamicSize=!0,this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach(([s,r])=>{i.setAttributeNS(null,it.dasherize(s),r)}),this.isPolyline()&&!this.config.svgStyle.fill&&i.setAttributeNS(null,"fill","none")):this.isPolygon()?i.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline()&&(i.setAttributeNS(null,"fill","none"),i.setAttributeNS(null,"stroke","rgb(0,0,0)"));const t=this.config[this.type];if(!Array.isArray(t[0]))for(let s=0;s<t.length;s++)t.splice(s,2,[t[s],t[s+1]]);this.isPolyPixels()?this.definition=t.map(s=>{const r=this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:s[0],textureY:s[1]});return[r.yaw,r.pitch]}):this.definition=t.map(s=>[it.parseAngle(s[0]),it.parseAngle(s[1],!0)]);const e=this.isPolygon()?W3(this.definition):q3(this.definition);this.state.position={yaw:e[0],pitch:e[1]},this.state.positions3D=this.definition.map(s=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:s[0],pitch:s[1]}))}__update3d(){var t;const i=this.threeElement;if(!it.isExtendedPosition(this.config.position))throw new _e("missing marker position");if(!this.config.size)throw new _e("missing marker size");switch(this.state.dynamicSize=!1,this.state.size=this.config.size,this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position),this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)],this.type){case"imageLayer":switch(this.definition!==this.config.imageLayer&&(this.viewer.config.requestHeaders&&this.loader.setRequestHeader(this.viewer.config.requestHeaders(this.config.imageLayer)),i.children[0].material.map=this.loader.load(this.config.imageLayer,e=>{e.anisotropy=4,this.viewer.needsUpdate()}),this.definition=this.config.imageLayer),i.children[0].position.set(this.state.anchor.x-.5,this.state.anchor.y-.5,0),i.children[0].material.opacity=(t=this.config.opacity)!=null?t:1,i.position.copy(this.state.positions3D[0]),this.config.orientation){case"horizontal":i.lookAt(0,i.position.y,0),i.rotateX(this.state.position.pitch<0?-Math.PI/2:Math.PI/2);break;case"vertical-left":i.lookAt(0,0,0),i.rotateY(-Math.PI*.4);break;case"vertical-right":i.lookAt(0,0,0),i.rotateY(Math.PI*.4);break;default:i.lookAt(0,0,0);break}i.scale.set(this.config.size.width/100,this.config.size.height/100,1);break}}__createMesh(){const i=new BS({transparent:!0,opacity:1,depthTest:!1}),t=new NS(1,1),e=new US(t,i);e.userData={[Oe]:this};const s=new DS().add(e);return Object.defineProperty(s,"visible",{enumerable:!0,get:function(){return this.children[0].userData[Oe].visible},set:function(r){this.children[0].userData[Oe].visible=r}}),s}static getType(i,t=!1){const e=[];if(Object.keys(gh).forEach(s=>{i[s]&&e.push(s)}),e.length===0&&!t)throw new _e(`missing marker content, either ${Object.keys(gh).join(", ")}`);if(e.length>1)throw new _e(`multiple marker content, either ${Object.keys(gh).join(", ")}`);return e[0]}},G3=it.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null}),Ke=class extends Ma{constructor(i,t){super(i,t),this.markers={},this.state={visible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.container.style.cursor=this.viewer.config.mousemove?"move":"default",this.svgContainer=document.createElementNS(mh,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("contextmenu",this)}init(){super.init(),this.viewer.container.appendChild(this.container),this.viewer.addEventListener(st.ClickEvent.type,this),this.viewer.addEventListener(st.DoubleClickEvent.type,this),this.viewer.addEventListener(st.RenderEvent.type,this),this.viewer.addEventListener(st.ConfigChangedEvent.type,this),this.viewer.addEventListener(st.ObjectEnterEvent.type,this),this.viewer.addEventListener(st.ObjectHoverEvent.type,this),this.viewer.addEventListener(st.ObjectLeaveEvent.type,this),this.viewer.addEventListener(st.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(Oe),this.viewer.removeEventListener(st.ClickEvent.type,this),this.viewer.removeEventListener(st.DoubleClickEvent.type,this),this.viewer.removeEventListener(st.RenderEvent.type,this),this.viewer.removeEventListener(st.ConfigChangedEvent.type,this),this.viewer.removeEventListener(st.ObjectEnterEvent.type,this),this.viewer.removeEventListener(st.ObjectHoverEvent.type,this),this.viewer.removeEventListener(st.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(st.ReadyEvent.type,this),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(i){switch(i.type){case st.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case st.RenderEvent.type:this.renderMarkers();break;case st.ClickEvent.type:this.__onClick(i,!1);break;case st.DoubleClickEvent.type:this.__onClick(i,!0);break;case st.ConfigChangedEvent.type:this.container.style.cursor=this.viewer.config.mousemove?"move":"default";break;case st.ObjectEnterEvent.type:case st.ObjectLeaveEvent.type:case st.ObjectHoverEvent.type:if(i.userDataKey===Oe){const t=i.originalEvent,e=i.object.userData[Oe];switch(i.type){case st.ObjectEnterEvent.type:this.__onMouseEnter(t,e);break;case st.ObjectLeaveEvent.type:this.__onMouseLeave(t,e);break;case st.ObjectHoverEvent.type:this.__onMouseMove(t,e);break}}break;case"mouseenter":this.__onMouseEnter(i,this.__getTargetMarker(i.target));break;case"mouseleave":this.__onMouseLeave(i,this.__getTargetMarker(i.target));break;case"mousemove":this.__onMouseMove(i,this.__getTargetMarker(i.target));break;case"contextmenu":i.preventDefault();break}}toggleAllMarkers(){this.state.visible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.visible=!0,this.renderMarkers(),this.dispatchEvent(new co)}hideAllMarkers(){this.state.visible=!1,this.renderMarkers(),this.dispatchEvent(new uo)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach(i=>{i.state.staticTooltip=!0,i.showTooltip()})}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach(i=>{i.state.staticTooltip=!1,i.hideTooltip()})}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(i,t=!0){if(this.markers[i.id])throw new _e(`marker "${i.id}" already exists`);const e=new kd(this.viewer,i);if(e.isNormal())this.container.appendChild(e.domElement);else if(e.isPoly()||e.isSvg())this.svgContainer.appendChild(e.domElement);else if(e.is3d())this.viewer.renderer.addObject(e.threeElement);else throw new _e("invalid state");this.markers[e.id]=e,t&&this.__afterChangerMarkers()}getMarker(i){const t=typeof i=="object"?i.id:i;if(!this.markers[t])throw new _e(`cannot find marker "${t}"`);return this.markers[t]}getCurrentMarker(){return this.state.currentMarker}updateMarker(i,t=!0){this.getMarker(i.id).update(i),t&&this.__afterChangerMarkers()}removeMarker(i,t=!0){const e=this.getMarker(i);e.isNormal()?this.container.removeChild(e.domElement):e.isPoly()||e.isSvg()?this.svgContainer.removeChild(e.domElement):e.is3d()&&this.viewer.renderer.removeObject(e.threeElement),this.state.hoveringMarker===e&&(this.state.hoveringMarker=null),this.state.currentMarker===e&&(this.state.currentMarker=null),e.destroy(),delete this.markers[e.id],t&&this.__afterChangerMarkers()}removeMarkers(i,t=!0){i.forEach(e=>this.removeMarker(e,!1)),t&&this.__afterChangerMarkers()}setMarkers(i,t=!0){this.clearMarkers(!1),i==null||i.forEach(e=>{this.addMarker(e,!1)}),t&&this.__afterChangerMarkers()}clearMarkers(i=!0){Object.keys(this.markers).forEach(t=>{this.removeMarker(t,!1)}),i&&this.__afterChangerMarkers()}gotoMarker(i,t=this.config.gotoMarkerSpeed){const e=this.getMarker(i);return t?this.viewer.animate({...e.state.position,zoom:e.config.zoomLvl,speed:t}).then(()=>{this.dispatchEvent(new Ph(e))}):(this.viewer.rotate(e.state.position),it.isNil(e.config.zoomLvl)||this.viewer.zoom(e.config.zoomLvl),this.dispatchEvent(new Ph(e)),Promise.resolve())}hideMarker(i){this.toggleMarker(i,!1)}showMarker(i){this.toggleMarker(i,!0)}showMarkerTooltip(i){const t=this.getMarker(i);t.state.staticTooltip=!0,t.showTooltip()}hideMarkerTooltip(i){const t=this.getMarker(i);t.state.staticTooltip=!1,t.hideTooltip()}toggleMarker(i,t){const e=this.getMarker(i);e.visible=t===null?!e.visible:t,this.viewer.needsUpdate()}showMarkerPanel(i){var e;const t=this.getMarker(i);(e=t==null?void 0:t.config)!=null&&e.content?this.viewer.panel.show({id:jo,content:t.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(jo)}toggleMarkersList(){this.viewer.panel.isVisible(oo)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let i=[];Object.values(this.markers).forEach(e=>{e.visible&&!e.config.hideList&&i.push(e)});const t=new Hd(i);this.dispatchEvent(t),i=t.markers,this.viewer.panel.show({id:oo,content:V3(i,this.viewer.config.lang[ya.id]),noMargin:!0,clickHandler:e=>{const s=it.getClosest(e,"li"),r=s?s.dataset[Oe]:void 0;if(r){const a=this.getMarker(r);this.dispatchEvent(new Ud(a)),this.gotoMarker(a.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(oo)}renderMarkers(){const i=this.viewer.getZoomLevel(),t=this.viewer.getPosition();Object.values(this.markers).forEach(e=>{var l;let s=this.state.visible&&e.visible,r=!1,a=null;if(s&&e.is3d())a=this.__getMarkerPosition(e),s=this.__isMarkerVisible(e,a);else if(s&&e.isPoly()){const u=this.__getPolyPositions(e);if(s=u.length>(e.isPolygon()?2:1),s){a=this.__getMarkerPosition(e);const c=u.map(d=>d.x-a.x+","+(d.y-a.y)).join(" ");e.domElement.setAttributeNS(null,"points",c),e.domElement.setAttributeNS(null,"transform",`translate(${a.x} ${a.y})`)}}else if(s&&(e.state.dynamicSize&&this.__updateMarkerSize(e),a=this.__getMarkerPosition(e),s=this.__isMarkerVisible(e,a),s)){const u=e.getScale(i,t);if(e.isSvg()){const c=a.x+e.state.size.width*e.state.anchor.x*(1-u),d=a.y+e.state.size.height*e.state.anchor.y*(1-u);e.domElement.setAttributeNS(null,"transform",`translate(${c}, ${d}) scale(${u}, ${u})`)}else e.domElement.style.transform=`translate3D(${a.x}px, ${a.y}px, 0px) scale(${u}, ${u})`}r=e.state.visible!==s,e.state.visible=s,e.state.position2D=s?a:null,e.is3d()||it.toggleClass(e.domElement,"psv-marker--visible",s),s?e.state.staticTooltip?e.showTooltip():((l=e.config.tooltip)==null?void 0:l.trigger)==="click"||e===this.state.hoveringMarker&&!e.isPoly()?e.refreshTooltip():e!==this.state.hoveringMarker&&e.hideTooltip():e.hideTooltip(),r&&this.dispatchEvent(new Bd(e,s))})}__isMarkerVisible(i,t){return i.state.positions3D[0].dot(this.viewer.state.direction)>0&&t.x+i.state.size.width>=0&&t.x-i.state.size.width<=this.viewer.state.size.width&&t.y+i.state.size.height>=0&&t.y-i.state.size.height<=this.viewer.state.size.height}__updateMarkerSize(i){const t=i.domElement;t.classList.add("psv-marker--transparent");let e;i.isSvg()?(e=t.getAttributeNS(null,"transform"),t.removeAttributeNS(null,"transform")):(e=t.style.transform,t.style.transform="");const s=t.getBoundingClientRect();i.state.size={width:s.width,height:s.height},t.classList.remove("psv-marker--transparent"),e&&(i.isSvg()?t.setAttributeNS(null,"transform",e):t.style.transform=e),i.state.dynamicSize=!1}__getMarkerPosition(i){if(i.isPoly())return this.viewer.dataHelper.sphericalCoordsToViewerCoords(i.state.position);{const t=this.viewer.dataHelper.vector3ToViewerCoords(i.state.positions3D[0]);return t.x-=i.state.size.width*i.state.anchor.x,t.y-=i.state.size.height*i.state.anchor.y,t}}__getPolyPositions(i){const t=i.state.positions3D.length,e=i.state.positions3D.map(r=>({vector:r,visible:r.dot(this.viewer.state.direction)>0})),s=[];return e.forEach((r,a)=>{r.visible||[a===0?e[t-1]:e[a-1],a===t-1?e[0]:e[a+1]].forEach(u=>{u.visible&&s.push({visible:u.vector,invisible:r.vector,index:a})})}),s.reverse().forEach(r=>{e.splice(r.index,0,{vector:this.__getPolyIntermediaryPoint(r.visible,r.invisible),visible:!0})}),e.filter(r=>r.visible).map(r=>this.viewer.dataHelper.vector3ToViewerCoords(r.vector))}__getPolyIntermediaryPoint(i,t){const e=this.viewer.state.direction.clone().normalize(),s=new El().crossVectors(i,t).normalize(),r=new El().crossVectors(s,i).normalize(),a=i.clone().multiplyScalar(-e.dot(r)),l=r.clone().multiplyScalar(e.dot(i)),u=new El().addVectors(a,l).normalize(),c=new El().crossVectors(u,e);return u.applyAxisAngle(c,.01).multiplyScalar(bs.SPHERE_RADIUS)}__getTargetMarker(i,t=!1){const e=t?it.getClosest(i,".psv-marker"):i;return e?e[Oe]:void 0}__targetOnTooltip(i,t){return i&&t?it.hasParent(i,t.container):!1}__onMouseEnter(i,t){var e;t&&!t.isPoly()&&(this.state.hoveringMarker=t,this.dispatchEvent(new Fh(t)),!t.state.staticTooltip&&((e=t.config.tooltip)==null?void 0:e.trigger)==="hover"&&t.showTooltip(i.clientX,i.clientY))}__onMouseLeave(i,t){var e;t&&!(t.isPoly()&&this.__targetOnTooltip(i.relatedTarget,t.tooltip))&&(this.dispatchEvent(new Rh(t)),this.state.hoveringMarker=null,!t.state.staticTooltip&&((e=t.config.tooltip)==null?void 0:e.trigger)==="hover"&&t.hideTooltip())}__onMouseMove(i,t){var s;let e;t!=null&&t.isPoly()?e=t:this.state.hoveringMarker&&this.__targetOnTooltip(i.target,this.state.hoveringMarker.tooltip)&&(e=this.state.hoveringMarker),e?(this.state.hoveringMarker||(this.dispatchEvent(new Fh(e)),this.state.hoveringMarker=e),e.state.staticTooltip||e.showTooltip(i.clientX,i.clientY)):(s=this.state.hoveringMarker)!=null&&s.isPoly()&&(this.dispatchEvent(new Rh(this.state.hoveringMarker)),this.state.hoveringMarker.state.staticTooltip||this.state.hoveringMarker.hideTooltip(),this.state.hoveringMarker=null)}__onClick(i,t){var s,r,a;let e=(s=i.data.objects.find(l=>l.userData[Oe]))==null?void 0:s.userData[Oe];e||(e=this.__getTargetMarker(i.data.target,!0)),this.state.currentMarker&&this.state.currentMarker!==e&&(this.dispatchEvent(new Dd(this.state.currentMarker)),this.viewer.panel.hide(jo),!this.state.showAllTooltips&&((r=this.state.currentMarker.config.tooltip)==null?void 0:r.trigger)==="click"&&this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),e&&(this.state.currentMarker=e,this.dispatchEvent(new Nd(e,t,i.data.rightclick)),this.config.clickEventOnMarker?i.data.marker=e:i.stopImmediatePropagation(),this.markers[e.id]&&(((a=e.config.tooltip)==null?void 0:a.trigger)==="click"?e.tooltip?this.hideMarkerTooltip(e):this.showMarkerTooltip(e):this.showMarkerPanel(e.id)))}__afterChangerMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new Vd(this.getMarkers()))}__refreshUi(){var t,e;const i=Object.values(this.markers).filter(s=>!s.config.hideList).length;i===0?(this.viewer.panel.isVisible(oo)||this.viewer.panel.isVisible(jo))&&this.viewer.panel.hide():this.viewer.panel.isVisible(oo)?this.showMarkersList():this.viewer.panel.isVisible(jo)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),(t=this.viewer.navbar.getButton(ya.id,!1))==null||t.toggle(i>0),(e=this.viewer.navbar.getButton(Xh.id,!1))==null||e.toggle(i>0)}__checkObjectsObserver(){Object.values(this.markers).some(t=>t.is3d())?this.viewer.observeObjects(Oe):this.viewer.unobserveObjects(Oe)}};Ke.id="markers";Ke.configParser=G3;Ke.readonlyOptions=["markers"];In.lang[ya.id]="Markers";In.lang[Xh.id]="Markers list";Gh(ya,"caption:left");Gh(Xh,"caption:left");/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Bg="153",Cd=0,Y3=1,e0=1,j3=100,Z3=204,X3=205,Q3=3,J3=0,Ng=300,i0=1e3,zl=1001,s0=1002,Ug=1006,K3=1008,tA=1009,eA=1015,iA=1023,sA=3e3,Fc=3001,$c="",Pi="srgb",Wd="srgb-linear",Dg="display-p3",Bc=7680,nA=519,n0=35044,Tl=2e3,r0=2001;class Qh{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[t]===void 0&&(s[t]=[]),s[t].indexOf(e)===-1&&s[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const s=this._listeners;return s[t]!==void 0&&s[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const a=r.indexOf(e);a!==-1&&r.splice(a,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const s=this._listeners[t.type];if(s!==void 0){t.target=this;const r=s.slice(0);for(let a=0,l=r.length;a<l;a++)r[a].call(this,t);t.target=null}}}const ke=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let o0=1234567;const Vg=Math.PI/180,Hg=180/Math.PI;function wo(){const i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(ke[i&255]+ke[i>>8&255]+ke[i>>16&255]+ke[i>>24&255]+"-"+ke[t&255]+ke[t>>8&255]+"-"+ke[t>>16&15|64]+ke[t>>24&255]+"-"+ke[e&63|128]+ke[e>>8&255]+"-"+ke[e>>16&255]+ke[e>>24&255]+ke[s&255]+ke[s>>8&255]+ke[s>>16&255]+ke[s>>24&255]).toLowerCase()}function Ue(i,t,e){return Math.max(t,Math.min(e,i))}function qd(i,t){return(i%t+t)%t}function rA(i,t,e,s,r){return s+(i-t)*(r-s)/(e-t)}function oA(i,t,e){return i!==t?(e-i)/(t-i):0}function fa(i,t,e){return(1-e)*i+e*t}function aA(i,t,e,s){return fa(i,t,1-Math.exp(-e*s))}function lA(i,t=1){return t-Math.abs(qd(i,t*2)-t)}function hA(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*(3-2*i))}function uA(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*i*(i*(i*6-15)+10))}function cA(i,t){return i+Math.floor(Math.random()*(t-i+1))}function dA(i,t){return i+Math.random()*(t-i)}function fA(i){return i*(.5-Math.random())}function pA(i){i!==void 0&&(o0=i);let t=o0+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function mA(i){return i*Vg}function gA(i){return i*Hg}function vA(i){return(i&i-1)===0&&i!==0}function yA(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function xA(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function wA(i,t,e,s,r){const a=Math.cos,l=Math.sin,u=a(e/2),c=l(e/2),d=a((t+s)/2),f=l((t+s)/2),m=a((t-s)/2),g=l((t-s)/2),v=a((s-t)/2),x=l((s-t)/2);switch(r){case"XYX":i.set(u*f,c*m,c*g,u*d);break;case"YZY":i.set(c*g,u*f,c*m,u*d);break;case"ZXZ":i.set(c*m,c*g,u*f,u*d);break;case"XZX":i.set(u*f,c*x,c*v,u*d);break;case"YXY":i.set(c*v,u*f,c*x,u*d);break;case"ZYZ":i.set(c*x,c*v,u*f,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function la(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Qe(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Ve={DEG2RAD:Vg,RAD2DEG:Hg,generateUUID:wo,clamp:Ue,euclideanModulo:qd,mapLinear:rA,inverseLerp:oA,lerp:fa,damp:aA,pingpong:lA,smoothstep:hA,smootherstep:uA,randInt:cA,randFloat:dA,randFloatSpread:fA,seededRandom:pA,degToRad:mA,radToDeg:gA,isPowerOfTwo:vA,ceilPowerOfTwo:yA,floorPowerOfTwo:xA,setQuaternionFromProperEuler:wA,normalize:Qe,denormalize:la};class He{constructor(t=0,e=0){He.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,s=this.y,r=t.elements;return this.x=r[0]*e+r[3]*s+r[6],this.y=r[1]*e+r[4]*s+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(Ue(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y;return e*e+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const s=Math.cos(e),r=Math.sin(e),a=this.x-t.x,l=this.y-t.y;return this.x=a*s-l*r+t.x,this.y=a*r+l*s+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ln{constructor(t,e,s,r,a,l,u,c,d){Ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,s,r,a,l,u,c,d)}set(t,e,s,r,a,l,u,c,d){const f=this.elements;return f[0]=t,f[1]=r,f[2]=u,f[3]=e,f[4]=a,f[5]=c,f[6]=s,f[7]=l,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],this}extractBasis(t,e,s){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,r=e.elements,a=this.elements,l=s[0],u=s[3],c=s[6],d=s[1],f=s[4],m=s[7],g=s[2],v=s[5],x=s[8],b=r[0],E=r[3],S=r[6],z=r[1],I=r[4],O=r[7],P=r[2],G=r[5],$=r[8];return a[0]=l*b+u*z+c*P,a[3]=l*E+u*I+c*G,a[6]=l*S+u*O+c*$,a[1]=d*b+f*z+m*P,a[4]=d*E+f*I+m*G,a[7]=d*S+f*O+m*$,a[2]=g*b+v*z+x*P,a[5]=g*E+v*I+x*G,a[8]=g*S+v*O+x*$,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8];return e*l*f-e*u*d-s*a*f+s*u*c+r*a*d-r*l*c}invert(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8],m=f*l-u*d,g=u*c-f*a,v=d*a-l*c,x=e*m+s*g+r*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/x;return t[0]=m*b,t[1]=(r*d-f*s)*b,t[2]=(u*s-r*l)*b,t[3]=g*b,t[4]=(f*e-r*c)*b,t[5]=(r*a-u*e)*b,t[6]=v*b,t[7]=(s*c-d*e)*b,t[8]=(l*e-s*a)*b,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,s,r,a,l,u){const c=Math.cos(a),d=Math.sin(a);return this.set(s*c,s*d,-s*(c*l+d*u)+l+t,-r*d,r*c,-r*(-d*l+c*u)+u+e,0,0,1),this}scale(t,e){return this.premultiply(Nc.makeScale(t,e)),this}rotate(t){return this.premultiply(Nc.makeRotation(-t)),this}translate(t,e){return this.premultiply(Nc.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,s,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,s=t.elements;for(let r=0;r<9;r++)if(e[r]!==s[r])return!1;return!0}fromArray(t,e=0){for(let s=0;s<9;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Nc=new Ln;function _A(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}function a0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const l0={};function Uc(i){i in l0||(l0[i]=!0,console.warn(i))}function fo(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Dc(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const bA=new Ln().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),MA=new Ln().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function EA(i){return i.convertSRGBToLinear().applyMatrix3(MA)}function SA(i){return i.applyMatrix3(bA).convertLinearToSRGB()}const AA={[Wd]:i=>i,[Pi]:i=>i.convertSRGBToLinear(),[Dg]:EA},kA={[Wd]:i=>i,[Pi]:i=>i.convertLinearToSRGB(),[Dg]:SA},Ci={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return Wd},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,t,e){if(this.enabled===!1||t===e||!t||!e)return i;const s=AA[t],r=kA[e];if(s===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${e}".`);return r(s(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this.workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this.workingColorSpace)}};let Pr;class CA{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Pr===void 0&&(Pr=a0("canvas")),Pr.width=t.width,Pr.height=t.height;const s=Pr.getContext("2d");t instanceof ImageData?s.putImageData(t,0,0):s.drawImage(t,0,0,t.width,t.height),e=Pr}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&t instanceof ImageBitmap){const e=a0("canvas");e.width=t.width,e.height=t.height;const s=e.getContext("2d");s.drawImage(t,0,0,t.width,t.height);const r=s.getImageData(0,0,t.width,t.height),a=r.data;for(let l=0;l<a.length;l++)a[l]=fo(a[l]/255)*255;return s.putImageData(r,0,0),e}else if(t.data){const e=t.data.slice(0);for(let s=0;s<e.length;s++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[s]=Math.floor(fo(e[s]/255)*255):e[s]=fo(e[s]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let zA=0;class TA{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:zA++}),this.uuid=wo(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const s={uuid:this.uuid,url:""},r=this.data;if(r!==null){let a;if(Array.isArray(r)){a=[];for(let l=0,u=r.length;l<u;l++)r[l].isDataTexture?a.push(Vc(r[l].image)):a.push(Vc(r[l]))}else a=Vc(r);s.url=a}return e||(t.images[this.uuid]=s),s}}function Vc(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?CA.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let OA=0;class Fi extends Qh{constructor(t=Fi.DEFAULT_IMAGE,e=Fi.DEFAULT_MAPPING,s=zl,r=zl,a=Ug,l=K3,u=iA,c=tA,d=Fi.DEFAULT_ANISOTROPY,f=$c){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:OA++}),this.uuid=wo(),this.name="",this.source=new TA(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=s,this.wrapT=r,this.magFilter=a,this.minFilter=l,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=c,this.offset=new He(0,0),this.repeat=new He(1,1),this.center=new He(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(Uc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===Fc?Pi:$c),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),e||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Ng)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case i0:t.x=t.x-Math.floor(t.x);break;case zl:t.x=t.x<0?0:1;break;case s0:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case i0:t.y=t.y-Math.floor(t.y);break;case zl:t.y=t.y<0?0:1;break;case s0:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Uc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Pi?Fc:sA}set encoding(t){Uc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Fc?Pi:$c}}Fi.DEFAULT_IMAGE=null;Fi.DEFAULT_MAPPING=Ng;Fi.DEFAULT_ANISOTROPY=1;class Ks{constructor(t=0,e=0,s=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=s,this._w=r}static slerpFlat(t,e,s,r,a,l,u){let c=s[r+0],d=s[r+1],f=s[r+2],m=s[r+3];const g=a[l+0],v=a[l+1],x=a[l+2],b=a[l+3];if(u===0){t[e+0]=c,t[e+1]=d,t[e+2]=f,t[e+3]=m;return}if(u===1){t[e+0]=g,t[e+1]=v,t[e+2]=x,t[e+3]=b;return}if(m!==b||c!==g||d!==v||f!==x){let E=1-u;const S=c*g+d*v+f*x+m*b,z=S>=0?1:-1,I=1-S*S;if(I>Number.EPSILON){const P=Math.sqrt(I),G=Math.atan2(P,S*z);E=Math.sin(E*G)/P,u=Math.sin(u*G)/P}const O=u*z;if(c=c*E+g*O,d=d*E+v*O,f=f*E+x*O,m=m*E+b*O,E===1-u){const P=1/Math.sqrt(c*c+d*d+f*f+m*m);c*=P,d*=P,f*=P,m*=P}}t[e]=c,t[e+1]=d,t[e+2]=f,t[e+3]=m}static multiplyQuaternionsFlat(t,e,s,r,a,l){const u=s[r],c=s[r+1],d=s[r+2],f=s[r+3],m=a[l],g=a[l+1],v=a[l+2],x=a[l+3];return t[e]=u*x+f*m+c*v-d*g,t[e+1]=c*x+f*g+d*m-u*v,t[e+2]=d*x+f*v+u*g-c*m,t[e+3]=f*x-u*m-c*g-d*v,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,s,r){return this._x=t,this._y=e,this._z=s,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const s=t._x,r=t._y,a=t._z,l=t._order,u=Math.cos,c=Math.sin,d=u(s/2),f=u(r/2),m=u(a/2),g=c(s/2),v=c(r/2),x=c(a/2);switch(l){case"XYZ":this._x=g*f*m+d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m-g*v*x;break;case"YXZ":this._x=g*f*m+d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m+g*v*x;break;case"ZXY":this._x=g*f*m-d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m-g*v*x;break;case"ZYX":this._x=g*f*m-d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m+g*v*x;break;case"YZX":this._x=g*f*m+d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m-g*v*x;break;case"XZY":this._x=g*f*m-d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m+g*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const s=e/2,r=Math.sin(s);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,s=e[0],r=e[4],a=e[8],l=e[1],u=e[5],c=e[9],d=e[2],f=e[6],m=e[10],g=s+u+m;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(f-c)*v,this._y=(a-d)*v,this._z=(l-r)*v}else if(s>u&&s>m){const v=2*Math.sqrt(1+s-u-m);this._w=(f-c)/v,this._x=.25*v,this._y=(r+l)/v,this._z=(a+d)/v}else if(u>m){const v=2*Math.sqrt(1+u-s-m);this._w=(a-d)/v,this._x=(r+l)/v,this._y=.25*v,this._z=(c+f)/v}else{const v=2*Math.sqrt(1+m-s-u);this._w=(l-r)/v,this._x=(a+d)/v,this._y=(c+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let s=t.dot(e)+1;return s<Number.EPSILON?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=s):(this._x=0,this._y=-t.z,this._z=t.y,this._w=s)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=s),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ue(this.dot(t),-1,1)))}rotateTowards(t,e){const s=this.angleTo(t);if(s===0)return this;const r=Math.min(1,e/s);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const s=t._x,r=t._y,a=t._z,l=t._w,u=e._x,c=e._y,d=e._z,f=e._w;return this._x=s*f+l*u+r*d-a*c,this._y=r*f+l*c+a*u-s*d,this._z=a*f+l*d+s*c-r*u,this._w=l*f-s*u-r*c-a*d,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const s=this._x,r=this._y,a=this._z,l=this._w;let u=l*t._w+s*t._x+r*t._y+a*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=l,this._x=s,this._y=r,this._z=a,this;const c=1-u*u;if(c<=Number.EPSILON){const v=1-e;return this._w=v*l+e*this._w,this._x=v*s+e*this._x,this._y=v*r+e*this._y,this._z=v*a+e*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(c),f=Math.atan2(d,u),m=Math.sin((1-e)*f)/d,g=Math.sin(e*f)/d;return this._w=l*m+this._w*g,this._x=s*m+this._x*g,this._y=r*m+this._y*g,this._z=a*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(t,e,s){return this.copy(t).slerp(e,s)}random(){const t=Math.random(),e=Math.sqrt(1-t),s=Math.sqrt(t),r=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(e*Math.cos(r),s*Math.sin(a),s*Math.cos(a),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class N{constructor(t=0,e=0,s=0){N.prototype.isVector3=!0,this.x=t,this.y=e,this.z=s}set(t,e,s){return s===void 0&&(s=this.z),this.x=t,this.y=e,this.z=s,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(h0.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(h0.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,s=this.y,r=this.z,a=t.elements;return this.x=a[0]*e+a[3]*s+a[6]*r,this.y=a[1]*e+a[4]*s+a[7]*r,this.z=a[2]*e+a[5]*s+a[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,s=this.y,r=this.z,a=t.elements,l=1/(a[3]*e+a[7]*s+a[11]*r+a[15]);return this.x=(a[0]*e+a[4]*s+a[8]*r+a[12])*l,this.y=(a[1]*e+a[5]*s+a[9]*r+a[13])*l,this.z=(a[2]*e+a[6]*s+a[10]*r+a[14])*l,this}applyQuaternion(t){const e=this.x,s=this.y,r=this.z,a=t.x,l=t.y,u=t.z,c=t.w,d=c*e+l*r-u*s,f=c*s+u*e-a*r,m=c*r+a*s-l*e,g=-a*e-l*s-u*r;return this.x=d*c+g*-a+f*-u-m*-l,this.y=f*c+g*-l+m*-a-d*-u,this.z=m*c+g*-u+d*-l-f*-a,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,s=this.y,r=this.z,a=t.elements;return this.x=a[0]*e+a[4]*s+a[8]*r,this.y=a[1]*e+a[5]*s+a[9]*r,this.z=a[2]*e+a[6]*s+a[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this.z=t.z+(e.z-t.z)*s,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,r=t.y,a=t.z,l=e.x,u=e.y,c=e.z;return this.x=r*c-a*u,this.y=a*l-s*c,this.z=s*u-r*l,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t).multiplyScalar(s)}projectOnPlane(t){return Hc.copy(this).projectOnVector(t),this.sub(Hc)}reflect(t){return this.sub(Hc.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(Ue(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y,r=this.z-t.z;return e*e+s*s+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const r=Math.sin(e)*t;return this.x=r*Math.sin(s),this.y=Math.cos(e)*t,this.z=r*Math.cos(s),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){return this.x=t*Math.sin(e),this.y=s,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=s,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,s=Math.sqrt(1-t**2);return this.x=s*Math.cos(e),this.y=s*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Hc=new N,h0=new Ks;class Aa{constructor(t=new N(1/0,1/0,1/0),e=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e+=3)this.expandByPoint(Vs.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,s=t.count;e<s;e++)this.expandByPoint(Vs.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const s=Vs.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(s),this.max.copy(t).add(s),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),t.boundingBox!==void 0)t.boundingBox===null&&t.computeBoundingBox(),Rr.copy(t.boundingBox),Rr.applyMatrix4(t.matrixWorld),this.union(Rr);else{const r=t.geometry;if(r!==void 0)if(e&&r.attributes!==void 0&&r.attributes.position!==void 0){const a=r.attributes.position;for(let l=0,u=a.count;l<u;l++)Vs.fromBufferAttribute(a,l).applyMatrix4(t.matrixWorld),this.expandByPoint(Vs)}else r.boundingBox===null&&r.computeBoundingBox(),Rr.copy(r.boundingBox),Rr.applyMatrix4(t.matrixWorld),this.union(Rr)}const s=t.children;for(let r=0,a=s.length;r<a;r++)this.expandByObject(s[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Vs),Vs.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,s;return t.normal.x>0?(e=t.normal.x*this.min.x,s=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,s=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,s+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,s+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,s+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,s+=t.normal.z*this.min.z),e<=-t.constant&&s>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Zo),Ol.subVectors(this.max,Zo),Fr.subVectors(t.a,Zo),$r.subVectors(t.b,Zo),Br.subVectors(t.c,Zo),vn.subVectors($r,Fr),yn.subVectors(Br,$r),Qn.subVectors(Fr,Br);let e=[0,-vn.z,vn.y,0,-yn.z,yn.y,0,-Qn.z,Qn.y,vn.z,0,-vn.x,yn.z,0,-yn.x,Qn.z,0,-Qn.x,-vn.y,vn.x,0,-yn.y,yn.x,0,-Qn.y,Qn.x,0];return!Wc(e,Fr,$r,Br,Ol)||(e=[1,0,0,0,1,0,0,0,1],!Wc(e,Fr,$r,Br,Ol))?!1:(Il.crossVectors(vn,yn),e=[Il.x,Il.y,Il.z],Wc(e,Fr,$r,Br,Ol))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Vs).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(Vs).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ds[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ds[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ds[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ds[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ds[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ds[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ds[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ds[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ds),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Ds=[new N,new N,new N,new N,new N,new N,new N,new N],Vs=new N,Rr=new Aa,Fr=new N,$r=new N,Br=new N,vn=new N,yn=new N,Qn=new N,Zo=new N,Ol=new N,Il=new N,Jn=new N;function Wc(i,t,e,s,r){for(let a=0,l=i.length-3;a<=l;a+=3){Jn.fromArray(i,a);const u=r.x*Math.abs(Jn.x)+r.y*Math.abs(Jn.y)+r.z*Math.abs(Jn.z),c=t.dot(Jn),d=e.dot(Jn),f=s.dot(Jn);if(Math.max(-Math.max(c,d,f),Math.min(c,d,f))>u)return!1}return!0}const IA=new Aa,Xo=new N,qc=new N;class Wg{constructor(t=new N,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const s=this.center;e!==void 0?s.copy(e):IA.setFromPoints(t).getCenter(s);let r=0;for(let a=0,l=t.length;a<l;a++)r=Math.max(r,s.distanceToSquared(t[a]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const s=this.center.distanceToSquared(t);return e.copy(t),s>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Xo.subVectors(t,this.center);const e=Xo.lengthSq();if(e>this.radius*this.radius){const s=Math.sqrt(e),r=(s-this.radius)*.5;this.center.addScaledVector(Xo,r/s),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(qc.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Xo.copy(t.center).add(qc)),this.expandByPoint(Xo.copy(t.center).sub(qc))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Hs=new N,Gc=new N,Ll=new N,xn=new N,Yc=new N,Pl=new N,jc=new N;class LA{constructor(t=new N,e=new N(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Hs)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const s=e.dot(this.direction);return s<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Hs.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Hs.copy(this.origin).addScaledVector(this.direction,e),Hs.distanceToSquared(t))}distanceSqToSegment(t,e,s,r){Gc.copy(t).add(e).multiplyScalar(.5),Ll.copy(e).sub(t).normalize(),xn.copy(this.origin).sub(Gc);const a=t.distanceTo(e)*.5,l=-this.direction.dot(Ll),u=xn.dot(this.direction),c=-xn.dot(Ll),d=xn.lengthSq(),f=Math.abs(1-l*l);let m,g,v,x;if(f>0)if(m=l*c-u,g=l*u-c,x=a*f,m>=0)if(g>=-x)if(g<=x){const b=1/f;m*=b,g*=b,v=m*(m+l*g+2*u)+g*(l*m+g+2*c)+d}else g=a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;else g=-a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;else g<=-x?(m=Math.max(0,-(-l*a+u)),g=m>0?-a:Math.min(Math.max(-a,-c),a),v=-m*m+g*(g+2*c)+d):g<=x?(m=0,g=Math.min(Math.max(-a,-c),a),v=g*(g+2*c)+d):(m=Math.max(0,-(l*a+u)),g=m>0?a:Math.min(Math.max(-a,-c),a),v=-m*m+g*(g+2*c)+d);else g=l>0?-a:a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;return s&&s.copy(this.origin).addScaledVector(this.direction,m),r&&r.copy(Gc).addScaledVector(Ll,g),v}intersectSphere(t,e){Hs.subVectors(t.center,this.origin);const s=Hs.dot(this.direction),r=Hs.dot(Hs)-s*s,a=t.radius*t.radius;if(r>a)return null;const l=Math.sqrt(a-r),u=s-l,c=s+l;return c<0?null:u<0?this.at(c,e):this.at(u,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(t.normal)+t.constant)/e;return s>=0?s:null}intersectPlane(t,e){const s=this.distanceToPlane(t);return s===null?null:this.at(s,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let s,r,a,l,u,c;const d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return d>=0?(s=(t.min.x-g.x)*d,r=(t.max.x-g.x)*d):(s=(t.max.x-g.x)*d,r=(t.min.x-g.x)*d),f>=0?(a=(t.min.y-g.y)*f,l=(t.max.y-g.y)*f):(a=(t.max.y-g.y)*f,l=(t.min.y-g.y)*f),s>l||a>r||((a>s||isNaN(s))&&(s=a),(l<r||isNaN(r))&&(r=l),m>=0?(u=(t.min.z-g.z)*m,c=(t.max.z-g.z)*m):(u=(t.max.z-g.z)*m,c=(t.min.z-g.z)*m),s>c||u>r)||((u>s||s!==s)&&(s=u),(c<r||r!==r)&&(r=c),r<0)?null:this.at(s>=0?s:r,e)}intersectsBox(t){return this.intersectBox(t,Hs)!==null}intersectTriangle(t,e,s,r,a){Yc.subVectors(e,t),Pl.subVectors(s,t),jc.crossVectors(Yc,Pl);let l=this.direction.dot(jc),u;if(l>0){if(r)return null;u=1}else if(l<0)u=-1,l=-l;else return null;xn.subVectors(this.origin,t);const c=u*this.direction.dot(Pl.crossVectors(xn,Pl));if(c<0)return null;const d=u*this.direction.dot(Yc.cross(xn));if(d<0||c+d>l)return null;const f=-u*xn.dot(jc);return f<0?null:this.at(f/l,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class ts{constructor(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E){ts.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E)}set(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E){const S=this.elements;return S[0]=t,S[4]=e,S[8]=s,S[12]=r,S[1]=a,S[5]=l,S[9]=u,S[13]=c,S[2]=d,S[6]=f,S[10]=m,S[14]=g,S[3]=v,S[7]=x,S[11]=b,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ts().fromArray(this.elements)}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],this}copyPosition(t){const e=this.elements,s=t.elements;return e[12]=s[12],e[13]=s[13],e[14]=s[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,s){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(t,e,s){return this.set(t.x,e.x,s.x,0,t.y,e.y,s.y,0,t.z,e.z,s.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,s=t.elements,r=1/Nr.setFromMatrixColumn(t,0).length(),a=1/Nr.setFromMatrixColumn(t,1).length(),l=1/Nr.setFromMatrixColumn(t,2).length();return e[0]=s[0]*r,e[1]=s[1]*r,e[2]=s[2]*r,e[3]=0,e[4]=s[4]*a,e[5]=s[5]*a,e[6]=s[6]*a,e[7]=0,e[8]=s[8]*l,e[9]=s[9]*l,e[10]=s[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,s=t.x,r=t.y,a=t.z,l=Math.cos(s),u=Math.sin(s),c=Math.cos(r),d=Math.sin(r),f=Math.cos(a),m=Math.sin(a);if(t.order==="XYZ"){const g=l*f,v=l*m,x=u*f,b=u*m;e[0]=c*f,e[4]=-c*m,e[8]=d,e[1]=v+x*d,e[5]=g-b*d,e[9]=-u*c,e[2]=b-g*d,e[6]=x+v*d,e[10]=l*c}else if(t.order==="YXZ"){const g=c*f,v=c*m,x=d*f,b=d*m;e[0]=g+b*u,e[4]=x*u-v,e[8]=l*d,e[1]=l*m,e[5]=l*f,e[9]=-u,e[2]=v*u-x,e[6]=b+g*u,e[10]=l*c}else if(t.order==="ZXY"){const g=c*f,v=c*m,x=d*f,b=d*m;e[0]=g-b*u,e[4]=-l*m,e[8]=x+v*u,e[1]=v+x*u,e[5]=l*f,e[9]=b-g*u,e[2]=-l*d,e[6]=u,e[10]=l*c}else if(t.order==="ZYX"){const g=l*f,v=l*m,x=u*f,b=u*m;e[0]=c*f,e[4]=x*d-v,e[8]=g*d+b,e[1]=c*m,e[5]=b*d+g,e[9]=v*d-x,e[2]=-d,e[6]=u*c,e[10]=l*c}else if(t.order==="YZX"){const g=l*c,v=l*d,x=u*c,b=u*d;e[0]=c*f,e[4]=b-g*m,e[8]=x*m+v,e[1]=m,e[5]=l*f,e[9]=-u*f,e[2]=-d*f,e[6]=v*m+x,e[10]=g-b*m}else if(t.order==="XZY"){const g=l*c,v=l*d,x=u*c,b=u*d;e[0]=c*f,e[4]=-m,e[8]=d*f,e[1]=g*m+b,e[5]=l*f,e[9]=v*m-x,e[2]=x*m-v,e[6]=u*f,e[10]=b*m+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(PA,t,RA)}lookAt(t,e,s){const r=this.elements;return hi.subVectors(t,e),hi.lengthSq()===0&&(hi.z=1),hi.normalize(),wn.crossVectors(s,hi),wn.lengthSq()===0&&(Math.abs(s.z)===1?hi.x+=1e-4:hi.z+=1e-4,hi.normalize(),wn.crossVectors(s,hi)),wn.normalize(),Rl.crossVectors(hi,wn),r[0]=wn.x,r[4]=Rl.x,r[8]=hi.x,r[1]=wn.y,r[5]=Rl.y,r[9]=hi.y,r[2]=wn.z,r[6]=Rl.z,r[10]=hi.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,r=e.elements,a=this.elements,l=s[0],u=s[4],c=s[8],d=s[12],f=s[1],m=s[5],g=s[9],v=s[13],x=s[2],b=s[6],E=s[10],S=s[14],z=s[3],I=s[7],O=s[11],P=s[15],G=r[0],$=r[4],_t=r[8],zt=r[12],j=r[1],lt=r[5],ut=r[9],ht=r[13],Ft=r[2],tt=r[6],Lt=r[10],V=r[14],J=r[3],pt=r[7],mt=r[11],Tt=r[15];return a[0]=l*G+u*j+c*Ft+d*J,a[4]=l*$+u*lt+c*tt+d*pt,a[8]=l*_t+u*ut+c*Lt+d*mt,a[12]=l*zt+u*ht+c*V+d*Tt,a[1]=f*G+m*j+g*Ft+v*J,a[5]=f*$+m*lt+g*tt+v*pt,a[9]=f*_t+m*ut+g*Lt+v*mt,a[13]=f*zt+m*ht+g*V+v*Tt,a[2]=x*G+b*j+E*Ft+S*J,a[6]=x*$+b*lt+E*tt+S*pt,a[10]=x*_t+b*ut+E*Lt+S*mt,a[14]=x*zt+b*ht+E*V+S*Tt,a[3]=z*G+I*j+O*Ft+P*J,a[7]=z*$+I*lt+O*tt+P*pt,a[11]=z*_t+I*ut+O*Lt+P*mt,a[15]=z*zt+I*ht+O*V+P*Tt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[4],r=t[8],a=t[12],l=t[1],u=t[5],c=t[9],d=t[13],f=t[2],m=t[6],g=t[10],v=t[14],x=t[3],b=t[7],E=t[11],S=t[15];return x*(+a*c*m-r*d*m-a*u*g+s*d*g+r*u*v-s*c*v)+b*(+e*c*v-e*d*g+a*l*g-r*l*v+r*d*f-a*c*f)+E*(+e*d*m-e*u*v-a*l*m+s*l*v+a*u*f-s*d*f)+S*(-r*u*f-e*c*m+e*u*g+r*l*m-s*l*g+s*c*f)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,s){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=s),this}invert(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8],m=t[9],g=t[10],v=t[11],x=t[12],b=t[13],E=t[14],S=t[15],z=m*E*d-b*g*d+b*c*v-u*E*v-m*c*S+u*g*S,I=x*g*d-f*E*d-x*c*v+l*E*v+f*c*S-l*g*S,O=f*b*d-x*m*d+x*u*v-l*b*v-f*u*S+l*m*S,P=x*m*c-f*b*c-x*u*g+l*b*g+f*u*E-l*m*E,G=e*z+s*I+r*O+a*P;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const $=1/G;return t[0]=z*$,t[1]=(b*g*a-m*E*a-b*r*v+s*E*v+m*r*S-s*g*S)*$,t[2]=(u*E*a-b*c*a+b*r*d-s*E*d-u*r*S+s*c*S)*$,t[3]=(m*c*a-u*g*a-m*r*d+s*g*d+u*r*v-s*c*v)*$,t[4]=I*$,t[5]=(f*E*a-x*g*a+x*r*v-e*E*v-f*r*S+e*g*S)*$,t[6]=(x*c*a-l*E*a-x*r*d+e*E*d+l*r*S-e*c*S)*$,t[7]=(l*g*a-f*c*a+f*r*d-e*g*d-l*r*v+e*c*v)*$,t[8]=O*$,t[9]=(x*m*a-f*b*a-x*s*v+e*b*v+f*s*S-e*m*S)*$,t[10]=(l*b*a-x*u*a+x*s*d-e*b*d-l*s*S+e*u*S)*$,t[11]=(f*u*a-l*m*a-f*s*d+e*m*d+l*s*v-e*u*v)*$,t[12]=P*$,t[13]=(f*b*r-x*m*r+x*s*g-e*b*g-f*s*E+e*m*E)*$,t[14]=(x*u*r-l*b*r-x*s*c+e*b*c+l*s*E-e*u*E)*$,t[15]=(l*m*r-f*u*r+f*s*c-e*m*c-l*s*g+e*u*g)*$,this}scale(t){const e=this.elements,s=t.x,r=t.y,a=t.z;return e[0]*=s,e[4]*=r,e[8]*=a,e[1]*=s,e[5]*=r,e[9]*=a,e[2]*=s,e[6]*=r,e[10]*=a,e[3]*=s,e[7]*=r,e[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,s,r))}makeTranslation(t,e,s){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,s,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,e,-s,0,0,s,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,0,s,0,0,1,0,0,-s,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,0,s,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const s=Math.cos(e),r=Math.sin(e),a=1-s,l=t.x,u=t.y,c=t.z,d=a*l,f=a*u;return this.set(d*l+s,d*u-r*c,d*c+r*u,0,d*u+r*c,f*u+s,f*c-r*l,0,d*c-r*u,f*c+r*l,a*c*c+s,0,0,0,0,1),this}makeScale(t,e,s){return this.set(t,0,0,0,0,e,0,0,0,0,s,0,0,0,0,1),this}makeShear(t,e,s,r,a,l){return this.set(1,s,a,0,t,1,l,0,e,r,1,0,0,0,0,1),this}compose(t,e,s){const r=this.elements,a=e._x,l=e._y,u=e._z,c=e._w,d=a+a,f=l+l,m=u+u,g=a*d,v=a*f,x=a*m,b=l*f,E=l*m,S=u*m,z=c*d,I=c*f,O=c*m,P=s.x,G=s.y,$=s.z;return r[0]=(1-(b+S))*P,r[1]=(v+O)*P,r[2]=(x-I)*P,r[3]=0,r[4]=(v-O)*G,r[5]=(1-(g+S))*G,r[6]=(E+z)*G,r[7]=0,r[8]=(x+I)*$,r[9]=(E-z)*$,r[10]=(1-(g+b))*$,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,s){const r=this.elements;let a=Nr.set(r[0],r[1],r[2]).length();const l=Nr.set(r[4],r[5],r[6]).length(),u=Nr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),t.x=r[12],t.y=r[13],t.z=r[14],qi.copy(this);const d=1/a,f=1/l,m=1/u;return qi.elements[0]*=d,qi.elements[1]*=d,qi.elements[2]*=d,qi.elements[4]*=f,qi.elements[5]*=f,qi.elements[6]*=f,qi.elements[8]*=m,qi.elements[9]*=m,qi.elements[10]*=m,e.setFromRotationMatrix(qi),s.x=a,s.y=l,s.z=u,this}makePerspective(t,e,s,r,a,l,u=Tl){const c=this.elements,d=2*a/(e-t),f=2*a/(s-r),m=(e+t)/(e-t),g=(s+r)/(s-r);let v,x;if(u===Tl)v=-(l+a)/(l-a),x=-2*l*a/(l-a);else if(u===r0)v=-l/(l-a),x=-l*a/(l-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return c[0]=d,c[4]=0,c[8]=m,c[12]=0,c[1]=0,c[5]=f,c[9]=g,c[13]=0,c[2]=0,c[6]=0,c[10]=v,c[14]=x,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(t,e,s,r,a,l,u=Tl){const c=this.elements,d=1/(e-t),f=1/(s-r),m=1/(l-a),g=(e+t)*d,v=(s+r)*f;let x,b;if(u===Tl)x=(l+a)*m,b=-2*m;else if(u===r0)x=a*m,b=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return c[0]=2*d,c[4]=0,c[8]=0,c[12]=-g,c[1]=0,c[5]=2*f,c[9]=0,c[13]=-v,c[2]=0,c[6]=0,c[10]=b,c[14]=-x,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(t){const e=this.elements,s=t.elements;for(let r=0;r<16;r++)if(e[r]!==s[r])return!1;return!0}fromArray(t,e=0){for(let s=0;s<16;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t[e+9]=s[9],t[e+10]=s[10],t[e+11]=s[11],t[e+12]=s[12],t[e+13]=s[13],t[e+14]=s[14],t[e+15]=s[15],t}}const Nr=new N,qi=new ts,PA=new N(0,0,0),RA=new N(1,1,1),wn=new N,Rl=new N,hi=new N,u0=new ts,c0=new Ks;class _o{constructor(t=0,e=0,s=0,r=_o.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=s,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,s,r=this._order){return this._x=t,this._y=e,this._z=s,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,s=!0){const r=t.elements,a=r[0],l=r[4],u=r[8],c=r[1],d=r[5],f=r[9],m=r[2],g=r[6],v=r[10];switch(e){case"XYZ":this._y=Math.asin(Ue(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-Ue(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,v),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-m,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ue(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-m,v),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(c,a));break;case"ZYX":this._y=Math.asin(-Ue(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(g,v),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(Ue(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(u,v));break;case"XZY":this._z=Math.asin(-Ue(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,s){return u0.makeRotationFromQuaternion(t),this.setFromRotationMatrix(u0,e,s)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return c0.setFromEuler(this),this.setFromQuaternion(c0,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}_o.DEFAULT_ORDER="XYZ";class FA{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let $A=0;const d0=new N,Ur=new Ks,Ws=new ts,Fl=new N,Qo=new N,BA=new N,NA=new Ks,f0=new N(1,0,0),p0=new N(0,1,0),m0=new N(0,0,1),UA={type:"added"},g0={type:"removed"};class ws extends Qh{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:$A++}),this.uuid=wo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ws.DEFAULT_UP.clone();const t=new N,e=new _o,s=new Ks,r=new N(1,1,1);function a(){s.setFromEuler(e,!1)}function l(){e.setFromQuaternion(s,void 0,!1)}e._onChange(a),s._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new ts},normalMatrix:{value:new Ln}}),this.matrix=new ts,this.matrixWorld=new ts,this.matrixAutoUpdate=ws.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ws.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new FA,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Ur.setFromAxisAngle(t,e),this.quaternion.multiply(Ur),this}rotateOnWorldAxis(t,e){return Ur.setFromAxisAngle(t,e),this.quaternion.premultiply(Ur),this}rotateX(t){return this.rotateOnAxis(f0,t)}rotateY(t){return this.rotateOnAxis(p0,t)}rotateZ(t){return this.rotateOnAxis(m0,t)}translateOnAxis(t,e){return d0.copy(t).applyQuaternion(this.quaternion),this.position.add(d0.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(f0,t)}translateY(t){return this.translateOnAxis(p0,t)}translateZ(t){return this.translateOnAxis(m0,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Ws.copy(this.matrixWorld).invert())}lookAt(t,e,s){t.isVector3?Fl.copy(t):Fl.set(t,e,s);const r=this.parent;this.updateWorldMatrix(!0,!1),Qo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ws.lookAt(Qo,Fl,this.up):Ws.lookAt(Fl,Qo,this.up),this.quaternion.setFromRotationMatrix(Ws),r&&(Ws.extractRotation(r.matrixWorld),Ur.setFromRotationMatrix(Ws),this.quaternion.premultiply(Ur.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(UA)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(g0)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(g0)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Ws.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Ws.multiply(t.parent.matrixWorld)),t.applyMatrix4(Ws),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let s=0,r=this.children.length;s<r;s++){const l=this.children[s].getObjectByProperty(t,e);if(l!==void 0)return l}}getObjectsByProperty(t,e){let s=[];this[t]===e&&s.push(this);for(let r=0,a=this.children.length;r<a;r++){const l=this.children[r].getObjectsByProperty(t,e);l.length>0&&(s=s.concat(l))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qo,t,BA),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qo,NA,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let s=0,r=e.length;s<r;s++)e[s].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let s=0,r=e.length;s<r;s++)e[s].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let s=0,r=e.length;s<r;s++){const a=e[s];(a.matrixWorldAutoUpdate===!0||t===!0)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const s=this.parent;if(t===!0&&s!==null&&s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let a=0,l=r.length;a<l;a++){const u=r[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=t===void 0||typeof t=="string",s={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function a(u,c){return u[c.uuid]===void 0&&(u[c.uuid]=c.toJSON(t)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(t.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const c=u.shapes;if(Array.isArray(c))for(let d=0,f=c.length;d<f;d++){const m=c[d];a(t.shapes,m)}else a(t.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let c=0,d=this.material.length;c<d;c++)u.push(a(t.materials,this.material[c]));r.material=u}else r.material=a(t.materials,this.material);if(this.children.length>0){r.children=[];for(let u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let u=0;u<this.animations.length;u++){const c=this.animations[u];r.animations.push(a(t.animations,c))}}if(e){const u=l(t.geometries),c=l(t.materials),d=l(t.textures),f=l(t.images),m=l(t.shapes),g=l(t.skeletons),v=l(t.animations),x=l(t.nodes);u.length>0&&(s.geometries=u),c.length>0&&(s.materials=c),d.length>0&&(s.textures=d),f.length>0&&(s.images=f),m.length>0&&(s.shapes=m),g.length>0&&(s.skeletons=g),v.length>0&&(s.animations=v),x.length>0&&(s.nodes=x)}return s.object=r,s;function l(u){const c=[];for(const d in u){const f=u[d];delete f.metadata,c.push(f)}return c}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let s=0;s<t.children.length;s++){const r=t.children[s];this.add(r.clone())}return this}}ws.DEFAULT_UP=new N(0,1,0);ws.DEFAULT_MATRIX_AUTO_UPDATE=!0;ws.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Gi=new N,qs=new N,Zc=new N,Gs=new N,Dr=new N,Vr=new N,v0=new N,Xc=new N,Qc=new N,Jc=new N;let $l=!1;class Qi{constructor(t=new N,e=new N,s=new N){this.a=t,this.b=e,this.c=s}static getNormal(t,e,s,r){r.subVectors(s,e),Gi.subVectors(t,e),r.cross(Gi);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(t,e,s,r,a){Gi.subVectors(r,e),qs.subVectors(s,e),Zc.subVectors(t,e);const l=Gi.dot(Gi),u=Gi.dot(qs),c=Gi.dot(Zc),d=qs.dot(qs),f=qs.dot(Zc),m=l*d-u*u;if(m===0)return a.set(-2,-1,-1);const g=1/m,v=(d*c-u*f)*g,x=(l*f-u*c)*g;return a.set(1-v-x,x,v)}static containsPoint(t,e,s,r){return this.getBarycoord(t,e,s,r,Gs),Gs.x>=0&&Gs.y>=0&&Gs.x+Gs.y<=1}static getUV(t,e,s,r,a,l,u,c){return $l===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$l=!0),this.getInterpolation(t,e,s,r,a,l,u,c)}static getInterpolation(t,e,s,r,a,l,u,c){return this.getBarycoord(t,e,s,r,Gs),c.setScalar(0),c.addScaledVector(a,Gs.x),c.addScaledVector(l,Gs.y),c.addScaledVector(u,Gs.z),c}static isFrontFacing(t,e,s,r){return Gi.subVectors(s,e),qs.subVectors(t,e),Gi.cross(qs).dot(r)<0}set(t,e,s){return this.a.copy(t),this.b.copy(e),this.c.copy(s),this}setFromPointsAndIndices(t,e,s,r){return this.a.copy(t[e]),this.b.copy(t[s]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,s,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,s),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Gi.subVectors(this.c,this.b),qs.subVectors(this.a,this.b),Gi.cross(qs).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Qi.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Qi.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,s,r,a){return $l===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$l=!0),Qi.getInterpolation(t,this.a,this.b,this.c,e,s,r,a)}getInterpolation(t,e,s,r,a){return Qi.getInterpolation(t,this.a,this.b,this.c,e,s,r,a)}containsPoint(t){return Qi.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Qi.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const s=this.a,r=this.b,a=this.c;let l,u;Dr.subVectors(r,s),Vr.subVectors(a,s),Xc.subVectors(t,s);const c=Dr.dot(Xc),d=Vr.dot(Xc);if(c<=0&&d<=0)return e.copy(s);Qc.subVectors(t,r);const f=Dr.dot(Qc),m=Vr.dot(Qc);if(f>=0&&m<=f)return e.copy(r);const g=c*m-f*d;if(g<=0&&c>=0&&f<=0)return l=c/(c-f),e.copy(s).addScaledVector(Dr,l);Jc.subVectors(t,a);const v=Dr.dot(Jc),x=Vr.dot(Jc);if(x>=0&&v<=x)return e.copy(a);const b=v*d-c*x;if(b<=0&&d>=0&&x<=0)return u=d/(d-x),e.copy(s).addScaledVector(Vr,u);const E=f*x-v*m;if(E<=0&&m-f>=0&&v-x>=0)return v0.subVectors(a,r),u=(m-f)/(m-f+(v-x)),e.copy(r).addScaledVector(v0,u);const S=1/(E+b+g);return l=b*S,u=g*S,e.copy(s).addScaledVector(Dr,l).addScaledVector(Vr,u)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let DA=0;class qg extends Qh{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:DA++}),this.uuid=wo(),this.name="",this.type="Material",this.blending=e0,this.side=Cd,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Z3,this.blendDst=X3,this.blendEquation=j3,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Q3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=nA,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Bc,this.stencilZFail=Bc,this.stencilZPass=Bc,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const s=t[e];if(s===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];if(r===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(s):r&&r.isVector3&&s&&s.isVector3?r.copy(s):this[e]=s}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const s={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(s.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(s.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(s.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(t).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(t).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(t).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(t).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(t).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==e0&&(s.blending=this.blending),this.side!==Cd&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(s.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(s.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=this.flatShading),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function r(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}if(e){const a=r(t.textures),l=r(t.images);a.length>0&&(s.textures=a),l.length>0&&(s.images=l)}return s}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let s=null;if(e!==null){const r=e.length;s=new Array(r);for(let a=0;a!==r;++a)s[a]=e[a].clone()}return this.clippingPlanes=s,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}const Gg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yi={h:0,s:0,l:0},Bl={h:0,s:0,l:0};function Kc(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}class Gd{constructor(t,e,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,s)}set(t,e,s){if(e===void 0&&s===void 0){const r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,e,s);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Pi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Ci.toWorkingColorSpace(this,e),this}setRGB(t,e,s,r=Ci.workingColorSpace){return this.r=t,this.g=e,this.b=s,Ci.toWorkingColorSpace(this,r),this}setHSL(t,e,s,r=Ci.workingColorSpace){if(t=qd(t,1),e=Ue(e,0,1),s=Ue(s,0,1),e===0)this.r=this.g=this.b=s;else{const a=s<=.5?s*(1+e):s+e-s*e,l=2*s-a;this.r=Kc(l,a,t+1/3),this.g=Kc(l,a,t),this.b=Kc(l,a,t-1/3)}return Ci.toWorkingColorSpace(this,r),this}setStyle(t,e=Pi){function s(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const l=r[1],u=r[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,e);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,e);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=r[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,e);if(l===6)return this.setHex(parseInt(a,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Pi){const s=Gg[t.toLowerCase()];return s!==void 0?this.setHex(s,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=fo(t.r),this.g=fo(t.g),this.b=fo(t.b),this}copyLinearToSRGB(t){return this.r=Dc(t.r),this.g=Dc(t.g),this.b=Dc(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Pi){return Ci.fromWorkingColorSpace(Ce.copy(this),t),Math.round(Ue(Ce.r*255,0,255))*65536+Math.round(Ue(Ce.g*255,0,255))*256+Math.round(Ue(Ce.b*255,0,255))}getHexString(t=Pi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Ci.workingColorSpace){Ci.fromWorkingColorSpace(Ce.copy(this),e);const s=Ce.r,r=Ce.g,a=Ce.b,l=Math.max(s,r,a),u=Math.min(s,r,a);let c,d;const f=(u+l)/2;if(u===l)c=0,d=0;else{const m=l-u;switch(d=f<=.5?m/(l+u):m/(2-l-u),l){case s:c=(r-a)/m+(r<a?6:0);break;case r:c=(a-s)/m+2;break;case a:c=(s-r)/m+4;break}c/=6}return t.h=c,t.s=d,t.l=f,t}getRGB(t,e=Ci.workingColorSpace){return Ci.fromWorkingColorSpace(Ce.copy(this),e),t.r=Ce.r,t.g=Ce.g,t.b=Ce.b,t}getStyle(t=Pi){Ci.fromWorkingColorSpace(Ce.copy(this),t);const e=Ce.r,s=Ce.g,r=Ce.b;return t!==Pi?`color(${t} ${e.toFixed(3)} ${s.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(s*255)},${Math.round(r*255)})`}offsetHSL(t,e,s){return this.getHSL(Yi),Yi.h+=t,Yi.s+=e,Yi.l+=s,this.setHSL(Yi.h,Yi.s,Yi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,s){return this.r=t.r+(e.r-t.r)*s,this.g=t.g+(e.g-t.g)*s,this.b=t.b+(e.b-t.b)*s,this}lerpHSL(t,e){this.getHSL(Yi),t.getHSL(Bl);const s=fa(Yi.h,Bl.h,e),r=fa(Yi.s,Bl.s,e),a=fa(Yi.l,Bl.l,e);return this.setHSL(s,r,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,s=this.g,r=this.b,a=t.elements;return this.r=a[0]*e+a[3]*s+a[6]*r,this.g=a[1]*e+a[4]*s+a[7]*r,this.b=a[2]*e+a[5]*s+a[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ce=new Gd;Gd.NAMES=Gg;class VA extends qg{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Gd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J3,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const oe=new N,Nl=new He;class po{constructor(t,e,s=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=s,this.usage=n0,this.updateRange={offset:0,count:-1},this.gpuType=eA,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,s){t*=this.itemSize,s*=e.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[t+r]=e.array[s+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,s=this.count;e<s;e++)Nl.fromBufferAttribute(this,e),Nl.applyMatrix3(t),this.setXY(e,Nl.x,Nl.y);else if(this.itemSize===3)for(let e=0,s=this.count;e<s;e++)oe.fromBufferAttribute(this,e),oe.applyMatrix3(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}applyMatrix4(t){for(let e=0,s=this.count;e<s;e++)oe.fromBufferAttribute(this,e),oe.applyMatrix4(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}applyNormalMatrix(t){for(let e=0,s=this.count;e<s;e++)oe.fromBufferAttribute(this,e),oe.applyNormalMatrix(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}transformDirection(t){for(let e=0,s=this.count;e<s;e++)oe.fromBufferAttribute(this,e),oe.transformDirection(t),this.setXYZ(e,oe.x,oe.y,oe.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=la(e,this.array)),e}setX(t,e){return this.normalized&&(e=Qe(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=la(e,this.array)),e}setY(t,e){return this.normalized&&(e=Qe(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=la(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Qe(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=la(e,this.array)),e}setW(t,e){return this.normalized&&(e=Qe(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,s){return t*=this.itemSize,this.normalized&&(e=Qe(e,this.array),s=Qe(s,this.array)),this.array[t+0]=e,this.array[t+1]=s,this}setXYZ(t,e,s,r){return t*=this.itemSize,this.normalized&&(e=Qe(e,this.array),s=Qe(s,this.array),r=Qe(r,this.array)),this.array[t+0]=e,this.array[t+1]=s,this.array[t+2]=r,this}setXYZW(t,e,s,r,a){return t*=this.itemSize,this.normalized&&(e=Qe(e,this.array),s=Qe(s,this.array),r=Qe(r,this.array),a=Qe(a,this.array)),this.array[t+0]=e,this.array[t+1]=s,this.array[t+2]=r,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==n0&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class HA extends po{constructor(t,e,s){super(new Uint16Array(t),e,s)}}class WA extends po{constructor(t,e,s){super(new Uint32Array(t),e,s)}}class vh extends po{constructor(t,e,s){super(new Float32Array(t),e,s)}}let qA=0;const Ai=new ts,td=new ws,Hr=new N,ui=new Aa,Jo=new Aa,me=new N;class Jh extends Qh{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:qA++}),this.uuid=wo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(_A(t)?WA:HA)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,s=0){this.groups.push({start:t,count:e,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const a=new Ln().getNormalMatrix(t);s.applyNormalMatrix(a),s.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Ai.makeRotationFromQuaternion(t),this.applyMatrix4(Ai),this}rotateX(t){return Ai.makeRotationX(t),this.applyMatrix4(Ai),this}rotateY(t){return Ai.makeRotationY(t),this.applyMatrix4(Ai),this}rotateZ(t){return Ai.makeRotationZ(t),this.applyMatrix4(Ai),this}translate(t,e,s){return Ai.makeTranslation(t,e,s),this.applyMatrix4(Ai),this}scale(t,e,s){return Ai.makeScale(t,e,s),this.applyMatrix4(Ai),this}lookAt(t){return td.lookAt(t),td.updateMatrix(),this.applyMatrix4(td.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hr).negate(),this.translate(Hr.x,Hr.y,Hr.z),this}setFromPoints(t){const e=[];for(let s=0,r=t.length;s<r;s++){const a=t[s];e.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new vh(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Aa);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let s=0,r=e.length;s<r;s++){const a=e[s];ui.setFromBufferAttribute(a),this.morphTargetsRelative?(me.addVectors(this.boundingBox.min,ui.min),this.boundingBox.expandByPoint(me),me.addVectors(this.boundingBox.max,ui.max),this.boundingBox.expandByPoint(me)):(this.boundingBox.expandByPoint(ui.min),this.boundingBox.expandByPoint(ui.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Wg);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new N,1/0);return}if(t){const s=this.boundingSphere.center;if(ui.setFromBufferAttribute(t),e)for(let a=0,l=e.length;a<l;a++){const u=e[a];Jo.setFromBufferAttribute(u),this.morphTargetsRelative?(me.addVectors(ui.min,Jo.min),ui.expandByPoint(me),me.addVectors(ui.max,Jo.max),ui.expandByPoint(me)):(ui.expandByPoint(Jo.min),ui.expandByPoint(Jo.max))}ui.getCenter(s);let r=0;for(let a=0,l=t.count;a<l;a++)me.fromBufferAttribute(t,a),r=Math.max(r,s.distanceToSquared(me));if(e)for(let a=0,l=e.length;a<l;a++){const u=e[a],c=this.morphTargetsRelative;for(let d=0,f=u.count;d<f;d++)me.fromBufferAttribute(u,d),c&&(Hr.fromBufferAttribute(t,d),me.add(Hr)),r=Math.max(r,s.distanceToSquared(me))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=t.array,r=e.position.array,a=e.normal.array,l=e.uv.array,u=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new po(new Float32Array(4*u),4));const c=this.getAttribute("tangent").array,d=[],f=[];for(let j=0;j<u;j++)d[j]=new N,f[j]=new N;const m=new N,g=new N,v=new N,x=new He,b=new He,E=new He,S=new N,z=new N;function I(j,lt,ut){m.fromArray(r,j*3),g.fromArray(r,lt*3),v.fromArray(r,ut*3),x.fromArray(l,j*2),b.fromArray(l,lt*2),E.fromArray(l,ut*2),g.sub(m),v.sub(m),b.sub(x),E.sub(x);const ht=1/(b.x*E.y-E.x*b.y);!isFinite(ht)||(S.copy(g).multiplyScalar(E.y).addScaledVector(v,-b.y).multiplyScalar(ht),z.copy(v).multiplyScalar(b.x).addScaledVector(g,-E.x).multiplyScalar(ht),d[j].add(S),d[lt].add(S),d[ut].add(S),f[j].add(z),f[lt].add(z),f[ut].add(z))}let O=this.groups;O.length===0&&(O=[{start:0,count:s.length}]);for(let j=0,lt=O.length;j<lt;++j){const ut=O[j],ht=ut.start,Ft=ut.count;for(let tt=ht,Lt=ht+Ft;tt<Lt;tt+=3)I(s[tt+0],s[tt+1],s[tt+2])}const P=new N,G=new N,$=new N,_t=new N;function zt(j){$.fromArray(a,j*3),_t.copy($);const lt=d[j];P.copy(lt),P.sub($.multiplyScalar($.dot(lt))).normalize(),G.crossVectors(_t,lt);const ht=G.dot(f[j])<0?-1:1;c[j*4]=P.x,c[j*4+1]=P.y,c[j*4+2]=P.z,c[j*4+3]=ht}for(let j=0,lt=O.length;j<lt;++j){const ut=O[j],ht=ut.start,Ft=ut.count;for(let tt=ht,Lt=ht+Ft;tt<Lt;tt+=3)zt(s[tt+0]),zt(s[tt+1]),zt(s[tt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new po(new Float32Array(e.count*3),3),this.setAttribute("normal",s);else for(let g=0,v=s.count;g<v;g++)s.setXYZ(g,0,0,0);const r=new N,a=new N,l=new N,u=new N,c=new N,d=new N,f=new N,m=new N;if(t)for(let g=0,v=t.count;g<v;g+=3){const x=t.getX(g+0),b=t.getX(g+1),E=t.getX(g+2);r.fromBufferAttribute(e,x),a.fromBufferAttribute(e,b),l.fromBufferAttribute(e,E),f.subVectors(l,a),m.subVectors(r,a),f.cross(m),u.fromBufferAttribute(s,x),c.fromBufferAttribute(s,b),d.fromBufferAttribute(s,E),u.add(f),c.add(f),d.add(f),s.setXYZ(x,u.x,u.y,u.z),s.setXYZ(b,c.x,c.y,c.z),s.setXYZ(E,d.x,d.y,d.z)}else for(let g=0,v=e.count;g<v;g+=3)r.fromBufferAttribute(e,g+0),a.fromBufferAttribute(e,g+1),l.fromBufferAttribute(e,g+2),f.subVectors(l,a),m.subVectors(r,a),f.cross(m),s.setXYZ(g+0,f.x,f.y,f.z),s.setXYZ(g+1,f.x,f.y,f.z),s.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,s=t.count;e<s;e++)me.fromBufferAttribute(t,e),me.normalize(),t.setXYZ(e,me.x,me.y,me.z)}toNonIndexed(){function t(u,c){const d=u.array,f=u.itemSize,m=u.normalized,g=new d.constructor(c.length*f);let v=0,x=0;for(let b=0,E=c.length;b<E;b++){u.isInterleavedBufferAttribute?v=c[b]*u.data.stride+u.offset:v=c[b]*f;for(let S=0;S<f;S++)g[x++]=d[v++]}return new po(g,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Jh,s=this.index.array,r=this.attributes;for(const u in r){const c=r[u],d=t(c,s);e.setAttribute(u,d)}const a=this.morphAttributes;for(const u in a){const c=[],d=a[u];for(let f=0,m=d.length;f<m;f++){const g=d[f],v=t(g,s);c.push(v)}e.morphAttributes[u]=c}e.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,c=l.length;u<c;u++){const d=l[u];e.addGroup(d.start,d.count,d.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const d in c)c[d]!==void 0&&(t[d]=c[d]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const s=this.attributes;for(const c in s){const d=s[c];t.data.attributes[c]=d.toJSON(t.data)}const r={};let a=!1;for(const c in this.morphAttributes){const d=this.morphAttributes[c],f=[];for(let m=0,g=d.length;m<g;m++){const v=d[m];f.push(v.toJSON(t.data))}f.length>0&&(r[c]=f,a=!0)}a&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(t.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const s=t.index;s!==null&&this.setIndex(s.clone(e));const r=t.attributes;for(const d in r){const f=r[d];this.setAttribute(d,f.clone(e))}const a=t.morphAttributes;for(const d in a){const f=[],m=a[d];for(let g=0,v=m.length;g<v;g++)f.push(m[g].clone(e));this.morphAttributes[d]=f}this.morphTargetsRelative=t.morphTargetsRelative;const l=t.groups;for(let d=0,f=l.length;d<f;d++){const m=l[d];this.addGroup(m.start,m.count,m.materialIndex)}const u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());const c=t.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const y0=new ts,Kn=new LA,Ul=new Wg,x0=new N,Wr=new N,qr=new N,Gr=new N,ed=new N,Dl=new N,Vl=new He,Hl=new He,Wl=new He,w0=new N,_0=new N,b0=new N,ql=new N,Gl=new N;class GA extends ws{constructor(t=new Jh,e=new VA){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,s=Object.keys(e);if(s.length>0){const r=e[s[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=r.length;a<l;a++){const u=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(t,e){const s=this.geometry,r=s.attributes.position,a=s.morphAttributes.position,l=s.morphTargetsRelative;e.fromBufferAttribute(r,t);const u=this.morphTargetInfluences;if(a&&u){Dl.set(0,0,0);for(let c=0,d=a.length;c<d;c++){const f=u[c],m=a[c];f!==0&&(ed.fromBufferAttribute(m,t),l?Dl.addScaledVector(ed,f):Dl.addScaledVector(ed.sub(e),f))}e.add(Dl)}return e}raycast(t,e){const s=this.geometry,r=this.material,a=this.matrixWorld;r!==void 0&&(s.boundingSphere===null&&s.computeBoundingSphere(),Ul.copy(s.boundingSphere),Ul.applyMatrix4(a),Kn.copy(t.ray).recast(t.near),!(Ul.containsPoint(Kn.origin)===!1&&(Kn.intersectSphere(Ul,x0)===null||Kn.origin.distanceToSquared(x0)>(t.far-t.near)**2))&&(y0.copy(a).invert(),Kn.copy(t.ray).applyMatrix4(y0),!(s.boundingBox!==null&&Kn.intersectsBox(s.boundingBox)===!1)&&this._computeIntersections(t,e,Kn)))}_computeIntersections(t,e,s){let r;const a=this.geometry,l=this.material,u=a.index,c=a.attributes.position,d=a.attributes.uv,f=a.attributes.uv1,m=a.attributes.normal,g=a.groups,v=a.drawRange;if(u!==null)if(Array.isArray(l))for(let x=0,b=g.length;x<b;x++){const E=g[x],S=l[E.materialIndex],z=Math.max(E.start,v.start),I=Math.min(u.count,Math.min(E.start+E.count,v.start+v.count));for(let O=z,P=I;O<P;O+=3){const G=u.getX(O),$=u.getX(O+1),_t=u.getX(O+2);r=Yl(this,S,t,s,d,f,m,G,$,_t),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,e.push(r))}}else{const x=Math.max(0,v.start),b=Math.min(u.count,v.start+v.count);for(let E=x,S=b;E<S;E+=3){const z=u.getX(E),I=u.getX(E+1),O=u.getX(E+2);r=Yl(this,l,t,s,d,f,m,z,I,O),r&&(r.faceIndex=Math.floor(E/3),e.push(r))}}else if(c!==void 0)if(Array.isArray(l))for(let x=0,b=g.length;x<b;x++){const E=g[x],S=l[E.materialIndex],z=Math.max(E.start,v.start),I=Math.min(c.count,Math.min(E.start+E.count,v.start+v.count));for(let O=z,P=I;O<P;O+=3){const G=O,$=O+1,_t=O+2;r=Yl(this,S,t,s,d,f,m,G,$,_t),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,e.push(r))}}else{const x=Math.max(0,v.start),b=Math.min(c.count,v.start+v.count);for(let E=x,S=b;E<S;E+=3){const z=E,I=E+1,O=E+2;r=Yl(this,l,t,s,d,f,m,z,I,O),r&&(r.faceIndex=Math.floor(E/3),e.push(r))}}}}function YA(i,t,e,s,r,a,l,u){let c;if(t.side===Y3?c=s.intersectTriangle(l,a,r,!0,u):c=s.intersectTriangle(r,a,l,t.side===Cd,u),c===null)return null;Gl.copy(u),Gl.applyMatrix4(i.matrixWorld);const d=e.ray.origin.distanceTo(Gl);return d<e.near||d>e.far?null:{distance:d,point:Gl.clone(),object:i}}function Yl(i,t,e,s,r,a,l,u,c,d){i.getVertexPosition(u,Wr),i.getVertexPosition(c,qr),i.getVertexPosition(d,Gr);const f=YA(i,t,e,s,Wr,qr,Gr,ql);if(f){r&&(Vl.fromBufferAttribute(r,u),Hl.fromBufferAttribute(r,c),Wl.fromBufferAttribute(r,d),f.uv=Qi.getInterpolation(ql,Wr,qr,Gr,Vl,Hl,Wl,new He)),a&&(Vl.fromBufferAttribute(a,u),Hl.fromBufferAttribute(a,c),Wl.fromBufferAttribute(a,d),f.uv1=Qi.getInterpolation(ql,Wr,qr,Gr,Vl,Hl,Wl,new He),f.uv2=f.uv1),l&&(w0.fromBufferAttribute(l,u),_0.fromBufferAttribute(l,c),b0.fromBufferAttribute(l,d),f.normal=Qi.getInterpolation(ql,Wr,qr,Gr,w0,_0,b0,new N),f.normal.dot(s.direction)>0&&f.normal.multiplyScalar(-1));const m={a:u,b:c,c:d,normal:new N,materialIndex:0};Qi.getNormal(Wr,qr,Gr,m.normal),f.face=m}return f}function jA(i){const t={};for(const e in i){t[e]={};for(const s in i[e]){const r=i[e][s];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[e][s]=null):t[e][s]=r.clone():Array.isArray(r)?t[e][s]=r.slice():t[e][s]=r}}return t}function ZA(i){const t=[];for(let e=0;e<i.length;e++)t.push(i[e].clone());return t}var XA=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,QA=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class JA extends qg{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=XA,this.fragmentShader=QA,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=jA(t.uniforms),this.uniformsGroups=ZA(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;l&&l.isTexture?e.uniforms[r]={type:"t",value:l.toJSON(t).uuid}:l&&l.isColor?e.uniforms[r]={type:"c",value:l.getHex()}:l&&l.isVector2?e.uniforms[r]={type:"v2",value:l.toArray()}:l&&l.isVector3?e.uniforms[r]={type:"v3",value:l.toArray()}:l&&l.isVector4?e.uniforms[r]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?e.uniforms[r]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?e.uniforms[r]={type:"m4",value:l.toArray()}:e.uniforms[r]={value:l}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const s={};for(const r in this.extensions)this.extensions[r]===!0&&(s[r]=!0);return Object.keys(s).length>0&&(e.extensions=s),e}}class Yd extends Jh{constructor(t=1,e=32,s=16,r=0,a=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:s,phiStart:r,phiLength:a,thetaStart:l,thetaLength:u},e=Math.max(3,Math.floor(e)),s=Math.max(2,Math.floor(s));const c=Math.min(l+u,Math.PI);let d=0;const f=[],m=new N,g=new N,v=[],x=[],b=[],E=[];for(let S=0;S<=s;S++){const z=[],I=S/s;let O=0;S===0&&l===0?O=.5/e:S===s&&c===Math.PI&&(O=-.5/e);for(let P=0;P<=e;P++){const G=P/e;m.x=-t*Math.cos(r+G*a)*Math.sin(l+I*u),m.y=t*Math.cos(l+I*u),m.z=t*Math.sin(r+G*a)*Math.sin(l+I*u),x.push(m.x,m.y,m.z),g.copy(m).normalize(),b.push(g.x,g.y,g.z),E.push(G+O,1-I),z.push(d++)}f.push(z)}for(let S=0;S<s;S++)for(let z=0;z<e;z++){const I=f[S][z+1],O=f[S][z],P=f[S+1][z],G=f[S+1][z+1];(S!==0||l>0)&&v.push(I,O,G),(S!==s-1||c<Math.PI)&&v.push(O,P,G)}this.setIndex(v),this.setAttribute("position",new vh(x,3)),this.setAttribute("normal",new vh(b,3)),this.setAttribute("uv",new vh(E,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Yd(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}const KA={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Bg}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Bg);/*!
 * PhotoSphereViewer 5.1.7
 * @copyright 2014-2015 Jrmy Heleine
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var tk=Object.defineProperty,jd=(i,t)=>{for(var e in t)tk(i,e,{get:t[e],enumerable:!0})},ek={};jd(ek,{ACTIONS:()=>Zg,ANIMATION_MIN_DURATION:()=>dk,CAPTURE_EVENTS_CLASS:()=>xk,CTRLZOOM_TIMEOUT:()=>vk,DBLCLICK_DELAY:()=>pk,DEFAULT_TRANSITION:()=>ck,EASINGS:()=>yh,ICONS:()=>Ms,IDS:()=>vs,INERTIA_WINDOW:()=>yk,KEY_CODES:()=>ti,LONGTOUCH_DELAY:()=>mk,MOVE_THRESHOLD:()=>fk,SPHERE_RADIUS:()=>Yg,TWOFINGERSOVERLAY_DELAY:()=>gk,VIEWER_DATA:()=>jg});var ik=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,sk='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',nk=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,rk=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,ok=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,ak=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,lk=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kun\xE1k from the Noun Project--></svg>
`,hk=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,uk=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,ck=1500,dk=500,fk=4,pk=300,mk=500,gk=100,vk=2e3,yk=300,Yg=10,jg="photoSphereViewer",xk="psv--capture-event",Zg=(i=>(i.ROTATE_UP="ROTATE_UP",i.ROTATE_DOWN="ROTATE_DOWN",i.ROTATE_RIGHT="ROTATE_RIGHT",i.ROTATE_LEFT="ROTATE_LEFT",i.ZOOM_IN="ZOOM_IN",i.ZOOM_OUT="ZOOM_OUT",i))(Zg||{}),vs={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},ti={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Ms={arrow:ik,close:sk,download:nk,fullscreenIn:rk,fullscreenOut:ok,info:ak,menu:lk,zoomIn:hk,zoomOut:uk},yh={linear:i=>i,inQuad:i=>i*i,outQuad:i=>i*(2-i),inOutQuad:i=>i<.5?2*i*i:-1+(4-2*i)*i,inCubic:i=>i*i*i,outCubic:i=>--i*i*i+1,inOutCubic:i=>i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1,inQuart:i=>i*i*i*i,outQuart:i=>1- --i*i*i*i,inOutQuart:i=>i<.5?8*i*i*i*i:1-8*--i*i*i*i,inQuint:i=>i*i*i*i*i,outQuint:i=>1+--i*i*i*i*i,inOutQuint:i=>i<.5?16*i*i*i*i*i:1+16*--i*i*i*i*i,inSine:i=>1-Math.cos(i*(Math.PI/2)),outSine:i=>Math.sin(i*(Math.PI/2)),inOutSine:i=>.5-.5*Math.cos(Math.PI*i),inExpo:i=>Math.pow(2,10*(i-1)),outExpo:i=>1-Math.pow(2,-10*i),inOutExpo:i=>(i=i*2-1)<0?.5*Math.pow(2,10*i):1-.5*Math.pow(2,-10*i),inCirc:i=>1-Math.sqrt(1-i*i),outCirc:i=>Math.sqrt(1-(i-1)*(i-1)),inOutCirc:i=>(i*=2)<1?.5-.5*Math.sqrt(1-i*i):.5+.5*Math.sqrt(1-(i-=2)*i)},or={};jd(or,{Animation:()=>Vk,Dynamic:()=>Hk,MultiDynamic:()=>Wk,PressHandler:()=>Xd,Slider:()=>hv,SliderDirection:()=>lv,addClasses:()=>Kg,angle:()=>Qg,applyEulerInverse:()=>Dk,cleanCssPosition:()=>Nk,clone:()=>$h,createTexture:()=>Td,cssPositionIsOrdered:()=>av,dasherize:()=>Ik,deepEqual:()=>nv,deepmerge:()=>iv,distance:()=>Xg,exitFullscreen:()=>Ok,firstNonNull:()=>ds,getAbortError:()=>Rk,getAngle:()=>bk,getClosest:()=>tv,getConfigParser:()=>tu,getElement:()=>Ek,getPosition:()=>kk,getShortestArc:()=>_k,getStyle:()=>ev,getTouchData:()=>Ck,getXMPValue:()=>fs,greatArcDistance:()=>Mk,hasParent:()=>Ak,invertResolvableBoolean:()=>Kh,isAbortError:()=>Fk,isEmpty:()=>Pk,isExtendedPosition:()=>$k,isFullscreenEnabled:()=>zk,isNil:()=>sv,isPlainObject:()=>Zd,logWarn:()=>es,parseAngle:()=>zd,parsePoint:()=>Bk,parseSpeed:()=>Uk,removeClasses:()=>Sk,requestFullscreen:()=>Tk,resolveBoolean:()=>ov,sum:()=>wk,throttle:()=>Lk,toggleClass:()=>Jg,wrap:()=>pa});function pa(i,t){let e=i%t;return e<0&&(e+=t),e}function wk(i){return i.reduce((t,e)=>t+e,0)}function Xg(i,t){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))}function Qg(i,t){return Math.atan2(t.y-i.y,t.x-i.x)}function _k(i,t){return[0,Math.PI*2,-Math.PI*2].reduce((s,r)=>{const a=t-i+r;return Math.abs(a)<Math.abs(s)?a:s},1/0)}function bk(i,t){return Math.acos(Math.cos(i.pitch)*Math.cos(t.pitch)*Math.cos(i.yaw-t.yaw)+Math.sin(i.pitch)*Math.sin(t.pitch))}function Mk([i,t],[e,s]){const r=(e-i)*Math.cos((t+s)/2),a=s-t;return Math.sqrt(r*r+a*a)}function Ek(i){return typeof i=="string"?i.match(/^[a-z]/i)?document.getElementById(i):document.querySelector(i):i}function Jg(i,t,e){e===void 0?i.classList.toggle(t):e?i.classList.add(t):e||i.classList.remove(t)}function Kg(i,t){i.classList.add(...t.split(" "))}function Sk(i,t){i.classList.remove(...t.split(" "))}function Ak(i,t){let e=i;do{if(e===t)return!0;e=e.parentElement}while(e);return!1}function tv(i,t){if(!(i!=null&&i.matches))return null;let e=i;do{if(e.matches(t))return e;e=e.parentElement}while(e);return null}function kk(i){let t=0,e=0,s=i;for(;s;)t+=s.offsetLeft-s.scrollLeft+s.clientLeft,e+=s.offsetTop-s.scrollTop+s.clientTop,s=s.offsetParent;return{x:t,y:e}}function ev(i,t){return window.getComputedStyle(i,null)[t]}function Ck(i){if(i.touches.length<2)return null;const t={x:i.touches[0].clientX,y:i.touches[0].clientY},e={x:i.touches[1].clientX,y:i.touches[1].clientY};return{distance:Xg(t,e),angle:Qg(t,e),center:{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}}function zk(i){return(document.fullscreenElement||document.webkitFullscreenElement)===i}function Tk(i){(i.requestFullscreen||i.webkitRequestFullscreen).call(i)}function Ok(){(document.exitFullscreen||document.webkitExitFullscreen).call(document)}function Ik(i){return i.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,e)=>(e>0?"-":"")+t.toLowerCase())}function Lk(i,t){let e=!1;return function(...s){e||(e=!0,setTimeout(()=>{i.apply(this,s),e=!1},t))}}function Zd(i){if(typeof i!="object"||i===null||Object.prototype.toString.call(i)!=="[object Object]")return!1;if(Object.getPrototypeOf(i)===null)return!0;let t=i;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(i)===t}function iv(i,t){const e=t;return function s(r,a){return Array.isArray(a)?(!r||!Array.isArray(r)?r=[]:r.length=0,a.forEach((l,u)=>{r[u]=s(null,l)})):typeof a=="object"?((!r||Array.isArray(r))&&(r={}),Object.keys(a).forEach(l=>{typeof a[l]!="object"||!a[l]||!Zd(a[l])?r[l]=a[l]:a[l]!==e&&(r[l]?s(r[l],a[l]):r[l]=s(null,a[l]))})):r=a,r}(i,t)}function $h(i){return iv(null,i)}function Pk(i){return!i||Object.keys(i).length===0&&i.constructor===Object}function sv(i){return i==null}function ds(...i){for(const t of i)if(!sv(t))return t;return null}function nv(i,t){if(i===t)return!0;if(M0(i)&&M0(t)){if(Object.keys(i).length!==Object.keys(t).length)return!1;for(const e of Object.keys(i))if(!nv(i[e],t[e]))return!1;return!0}else return!1}function M0(i){return typeof i=="object"&&i!==null}var Ie=class rv extends Error{constructor(t){var e;super(t),this.name="PSVError",(e=Error.captureStackTrace)==null||e.call(Error,this,rv)}};function ov(i,t){Zd(i)?(t(i.initial,!0),i.promise.then(e=>t(e,!1))):t(i,!0)}function Kh(i){return{initial:!i.initial,promise:i.promise.then(t=>!t)}}function Rk(){const i=new Error("Loading was aborted.");return i.name="AbortError",i}function Fk(i){return(i==null?void 0:i.name)==="AbortError"}function es(i){console.warn(`PhotoSphereViewer: ${i}`)}function $k(i){return i?[["textureX","textureY"],["yaw","pitch"]].some(([t,e])=>i[t]!==void 0&&i[e]!==void 0):!1}function fs(i,t){let e=i.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(e!==null){const s=parseInt(e[1],10);return isNaN(s)?null:s}if(e=i.match("GPano:"+t+'="(.*?)"'),e!==null){const s=parseInt(e[1],10);return isNaN(s)?null:s}return null}var E0={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Bh=["left","center","right"],Nh=["top","center","bottom"],S0=[...Bh,...Nh],zi="center";function Bk(i){if(!i)return{x:.5,y:.5};if(typeof i=="object")return i;let t=i.toLocaleLowerCase().split(" ").slice(0,2);t.length===1&&(E0[t[0]]?t=[t[0],zi]:t=[t[0],t[0]]);const e=t[1]!=="left"&&t[1]!=="right"&&t[0]!=="top"&&t[0]!=="bottom";t=t.map(r=>E0[r]||r),e||t.reverse();const s=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return s?{x:parseFloat(s[1])/100,y:parseFloat(s[2])/100}:{x:.5,y:.5}}function Nk(i,{allowCenter:t,cssOrder:e}={allowCenter:!0,cssOrder:!0}){return i?(typeof i=="string"&&(i=i.split(" ")),i.length===1&&(i[0]===zi?i=[zi,zi]:Bh.indexOf(i[0])!==-1?i=[zi,i[0]]:Nh.indexOf(i[0])!==-1&&(i=[i[0],zi])),i.length!==2||S0.indexOf(i[0])===-1||S0.indexOf(i[1])===-1?(es(`Unparsable position ${i}`),null):!t&&i[0]===zi&&i[1]===zi?(es("Invalid position center center"),null):(e&&!av(i)&&(i=[i[1],i[0]]),i[1]===zi&&Bh.indexOf(i[0])!==-1&&(i=[zi,i[0]]),i[0]===zi&&Nh.indexOf(i[1])!==-1&&(i=[i[1],zi]),i)):null}function av(i){return Nh.indexOf(i[0])!==-1&&Bh.indexOf(i[1])!==-1}function Uk(i){let t;if(typeof i=="string"){const e=i.toString().trim();let s=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(s/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=Ve.degToRad(s);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=s;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=s*Math.PI*2;break;default:throw new Ie(`Unknown speed unit "${r}"`)}}else t=i;return t}function zd(i,t=!1,e=t){let s;if(typeof i=="string"){const r=i.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new Ie(`Unknown angle "${i}"`);const a=parseFloat(r[1]),l=r[2];if(l)switch(l){case"deg":case"degs":s=Ve.degToRad(a);break;case"rad":case"rads":s=a;break;default:throw new Ie(`Unknown angle unit "${l}"`)}else s=a}else if(typeof i=="number"&&!isNaN(i))s=i;else throw new Ie(`Unknown angle "${i}"`);return s=pa(t?s+Math.PI:s,Math.PI*2),t?Ve.clamp(s-Math.PI,-Math.PI/(e?2:1),Math.PI/(e?2:1)):s}function Td(i){const t=new Fi(i);return t.needsUpdate=!0,t.minFilter=Ug,t.generateMipmaps=!1,t}var A0=new Ks;function Dk(i,t){A0.setFromEuler(t).invert(),i.applyQuaternion(A0)}function tu(i,t){const e=function(s){if(!s)return $h(i);const r=$h({...i,...s}),a={};for(let[l,u]of Object.entries(r)){if(t&&l in t)u=t[l](u,{rawConfig:r,defValue:i[l]});else if(!(l in i)){es(`Unknown option ${l}`);continue}a[l]=u}return a};return e.defaults=i,e.parsers=t||{},e}var Vk=class{constructor(i){this.easing=yh.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=i,i?(i.easing&&(this.easing=typeof i.easing=="function"?i.easing:yh[i.easing]||yh.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},i.delay||0)):this.resolved=!0}__run(i){if(this.cancelled)return;this.start||(this.start=i);const t=(i-this.start)/this.options.duration,e={};if(t<1){for(const[s,r]of Object.entries(this.options.properties))if(r){const a=r.start+(r.end-r.start)*this.easing(t);e[s]=a}this.options.onTick(e,t),this.animationFrame=window.requestAnimationFrame(s=>this.__run(s))}else{for(const[s,r]of Object.entries(this.options.properties))r&&(e[s]=r.end);this.options.onTick(e,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(i){i?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(t=>t(i)),this.callbacks.length=0}then(i){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(i):new Promise(t=>{this.callbacks.push(t)}).then(i)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},Hk=class{constructor(i,t){if(this.fn=i,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&this.min!==0)throw new Ie("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(i){this.__current=i}setSpeed(i){this.speed=i}goto(i,t=1){this.mode=2,this.target=this.wrap?pa(i,this.max):Ve.clamp(i,this.min,this.max),this.speedMult=t}step(i,t=1){t===0?this.setValue(this.current+i):(this.mode!==2&&(this.target=this.current),this.goto(this.target+i,t))}roll(i=!1,t=1){this.mode=1,this.target=i?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(i){return this.target=this.wrap?pa(i,this.max):Ve.clamp(i,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(i){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const s=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=s&&(this.mode=0)}let t=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+i/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-i/1e3*this.speed*this.speedMult*2));let e=null;return this.current>this.target&&this.currentSpeed?e=Math.max(this.target,this.current+this.currentSpeed*i/1e3):this.current<this.target&&this.currentSpeed&&(e=Math.min(this.target,this.current+this.currentSpeed*i/1e3)),e!==null&&(e=this.wrap?pa(e,this.max):Ve.clamp(e,this.min,this.max),e!==this.current)?(this.current=e,this.fn&&this.fn(this.current),!0):!1}},Wk=class{constructor(i,t){this.fn=i,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((i,[t,e])=>(i[t]=e.current,i),{})}setSpeed(i){for(const t of Object.values(this.dynamics))t.setSpeed(i)}goto(i,t=1){for(const[e,s]of Object.entries(i))this.dynamics[e].goto(s,t)}step(i,t=1){if(t===0)this.setValue(Object.keys(i).reduce((e,s)=>(e[s]=i[s]+this.dynamics[s].current,e),{}));else for(const[e,s]of Object.entries(i))this.dynamics[e].step(s,t)}roll(i,t=1){for(const[e,s]of Object.entries(i))this.dynamics[e].roll(s,t)}stop(){for(const i of Object.values(this.dynamics))i.stop()}setValue(i){let t=!1;for(const[e,s]of Object.entries(i))t=this.dynamics[e].setValue(s)||t;return t&&this.fn&&this.fn(this.current),t}update(i){let t=!1;for(const e of Object.values(this.dynamics))t=e.update(i)||t;return t&&this.fn&&this.fn(this.current),t}},Xd=class{constructor(i=200){this.delay=i,this.time=0,this.delay=i}get pending(){return this.time!==0}down(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime()}up(i){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{i(),this.timeout=void 0,this.time=0},this.delay):(i(),this.time=0)}},lv=(i=>(i.VERTICAL="VERTICAL",i.HORIZONTAL="HORIZONTAL",i))(lv||{}),hv=class{constructor(i,t,e){this.container=i,this.direction=t,this.listener=e,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(i){switch(i.type){case"click":i.stopPropagation();break;case"mousedown":this.__onMouseDown(i);break;case"mouseenter":this.__onMouseEnter(i);break;case"mouseleave":this.__onMouseLeave(i);break;case"touchstart":this.__onTouchStart(i);break;case"mousemove":this.__onMouseMove(i);break;case"touchmove":this.__onTouchMove(i);break;case"mouseup":this.__onMouseUp(i);break;case"touchend":this.__onTouchEnd(i);break}}__onMouseDown(i){this.mousedown=!0,this.__update(i.clientX,i.clientY,!0)}__onMouseEnter(i){this.mouseover=!0,this.__update(i.clientX,i.clientY,!0)}__onTouchStart(i){this.mouseover=!0,this.mousedown=!0;const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(i){(this.mousedown||this.mouseover)&&(i.stopPropagation(),this.__update(i.clientX,i.clientY,!0))}__onTouchMove(i){if(this.mousedown||this.mouseover){i.stopPropagation();const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(i){this.mousedown&&(this.mousedown=!1,this.__update(i.clientX,i.clientY,!1))}__onMouseLeave(i){this.mouseover&&(this.mouseover=!1,this.__update(i.clientX,i.clientY,!0))}__onTouchEnd(i){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(i,t,e){const s=this.container.getBoundingClientRect(),r=this.isVertical?t:i,a=s[this.isVertical?"bottom":"left"],l=s[this.isVertical?"height":"width"],u=Math.abs((a-r)/l);this.listener({value:u,click:!e,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:i,clientY:t}})}},ps={};jd(ps,{BeforeAnimateEvent:()=>Gk,BeforeRenderEvent:()=>Yk,BeforeRotateEvent:()=>jk,ClickEvent:()=>Zk,ConfigChangedEvent:()=>lr,DoubleClickEvent:()=>Xk,FullscreenEvent:()=>xh,HideNotificationEvent:()=>wh,HideOverlayEvent:()=>Qk,HidePanelEvent:()=>hr,HideTooltipEvent:()=>Jk,KeypressEvent:()=>Kk,LoadProgressEvent:()=>t4,ObjectEnterEvent:()=>l4,ObjectEvent:()=>eu,ObjectHoverEvent:()=>u4,ObjectLeaveEvent:()=>h4,PanoramaLoadedEvent:()=>e4,PositionUpdatedEvent:()=>i4,ReadyEvent:()=>_h,RenderEvent:()=>s4,ShowNotificationEvent:()=>bh,ShowOverlayEvent:()=>n4,ShowPanelEvent:()=>ur,ShowTooltipEvent:()=>r4,SizeUpdatedEvent:()=>o4,StopAllEvent:()=>a4,ViewerEvent:()=>Wt,ZoomUpdatedEvent:()=>Mh});var uv=class extends Event{constructor(i,t=!1){super(i,{cancelable:t})}},qk=class extends EventTarget{dispatchEvent(i){return super.dispatchEvent(i)}addEventListener(i,t,e){super.addEventListener(i,t,e)}removeEventListener(i,t,e){super.removeEventListener(i,t,e)}},Wt=class extends uv{},cv=class dv extends Wt{constructor(t,e){super(dv.type,!0),this.position=t,this.zoomLevel=e}};cv.type="before-animate";var Gk=cv,fv=class pv extends Wt{constructor(t,e){super(pv.type),this.timestamp=t,this.elapsed=e}};fv.type="before-render";var Yk=fv,mv=class gv extends Wt{constructor(t){super(gv.type,!0),this.position=t}};mv.type="before-rotate";var jk=mv,vv=class yv extends Wt{constructor(t){super(yv.type),this.data=t}};vv.type="click";var Zk=vv,xv=class wv extends Wt{constructor(t){super(wv.type),this.options=t}containsOptions(...t){return t.some(e=>this.options.includes(e))}};xv.type="config-changed";var lr=xv,_v=class bv extends Wt{constructor(t){super(bv.type),this.data=t}};_v.type="dblclick";var Xk=_v,Mv=class Ev extends Wt{constructor(t){super(Ev.type),this.fullscreenEnabled=t}};Mv.type="fullscreen";var xh=Mv,Sv=class Av extends Wt{constructor(t){super(Av.type),this.notificationId=t}};Sv.type="hide-notification";var wh=Sv,kv=class Cv extends Wt{constructor(t){super(Cv.type),this.overlayId=t}};kv.type="hide-overlay";var Qk=kv,zv=class Tv extends Wt{constructor(t){super(Tv.type),this.panelId=t}};zv.type="hide-panel";var hr=zv,Ov=class Iv extends Wt{constructor(t){super(Iv.type),this.tooltipData=t}};Ov.type="hide-tooltip";var Jk=Ov,Lv=class Pv extends Wt{constructor(t){super(Pv.type,!0),this.key=t}};Lv.type="key-press";var Kk=Lv,Rv=class Fv extends Wt{constructor(t){super(Fv.type),this.progress=t}};Rv.type="load-progress";var t4=Rv,$v=class Bv extends Wt{constructor(t){super(Bv.type),this.data=t}};$v.type="panorama-loaded";var e4=$v,Nv=class Uv extends Wt{constructor(t){super(Uv.type),this.position=t}};Nv.type="position-updated";var i4=Nv,Dv=class Vv extends Wt{constructor(){super(Vv.type)}};Dv.type="ready";var _h=Dv,Hv=class Wv extends Wt{constructor(){super(Wv.type)}};Hv.type="render";var s4=Hv,qv=class Gv extends Wt{constructor(t){super(Gv.type),this.notificationId=t}};qv.type="show-notification";var bh=qv,Yv=class jv extends Wt{constructor(t){super(jv.type),this.overlayId=t}};Yv.type="show-overlay";var n4=Yv,Zv=class Xv extends Wt{constructor(t){super(Xv.type),this.panelId=t}};Zv.type="show-panel";var ur=Zv,Qv=class Jv extends Wt{constructor(t,e){super(Jv.type),this.tooltip=t,this.tooltipData=e}};Qv.type="show-tooltip";var r4=Qv,Kv=class t1 extends Wt{constructor(t){super(t1.type),this.size=t}};Kv.type="size-updated";var o4=Kv,e1=class i1 extends Wt{constructor(){super(i1.type)}};e1.type="stop-all";var a4=e1,s1=class n1 extends Wt{constructor(t){super(n1.type),this.zoomLevel=t}};s1.type="zoom-updated";var Mh=s1,eu=class extends Wt{constructor(i,t,e,s,r){super(i),this.originalEvent=t,this.object=e,this.viewerPoint=s,this.userDataKey=r}},r1=class o1 extends eu{constructor(t,e,s,r){super(o1.type,t,e,s,r)}};r1.type="enter-object";var l4=r1,a1=class l1 extends eu{constructor(t,e,s,r){super(l1.type,t,e,s,r)}};a1.type="leave-object";var h4=a1,h1=class u1 extends eu{constructor(t,e,s,r){super(u1.type,t,e,s,r)}};h1.type="hover-object";var u4=h1,iu=class fi{constructor(t){this.viewer=t}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}static createOverlayMaterial({additionalUniforms:t,overrideVertexShader:e}={}){return new JA({uniforms:{...t,[fi.OVERLAY_UNIFORMS.panorama]:{value:new Fi},[fi.OVERLAY_UNIFORMS.overlay]:{value:new Fi},[fi.OVERLAY_UNIFORMS.globalOpacity]:{value:1},[fi.OVERLAY_UNIFORMS.overlayOpacity]:{value:1}},vertexShader:e||`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`
uniform sampler2D ${fi.OVERLAY_UNIFORMS.panorama};
uniform sampler2D ${fi.OVERLAY_UNIFORMS.overlay};
uniform float ${fi.OVERLAY_UNIFORMS.globalOpacity};
uniform float ${fi.OVERLAY_UNIFORMS.overlayOpacity};

varying vec2 vUv;

void main() {
  vec4 tColor1 = texture2D( ${fi.OVERLAY_UNIFORMS.panorama}, vUv );
  vec4 tColor2 = texture2D( ${fi.OVERLAY_UNIFORMS.overlay}, vUv );
  gl_FragColor = vec4(
    mix( tColor1.rgb, tColor2.rgb, tColor2.a * ${fi.OVERLAY_UNIFORMS.overlayOpacity} ),
    ${fi.OVERLAY_UNIFORMS.globalOpacity}
  );
}`})}};iu.supportsDownload=!1;iu.supportsOverlay=!1;iu.OVERLAY_UNIFORMS={panorama:"panorama",overlay:"overlay",globalOpacity:"globalOpacity",overlayOpacity:"overlayOpacity"};var Sn=iu;function k0(i){if(i){for(const[,t]of[["_",i],...Object.entries(i)])if(t.prototype instanceof Sn)return t}return null}var Ko=`${jg}_touchSupport`,xa={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,fullscreenEvent:null,__maxCanvasWidth:null,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=f4(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const i=c4();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=i!==null,this.maxTextureWidth=i?i.getParameter(i.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=d4(),this.fullscreenEvent=p4(),this.loaded=!0}throw new Ie("WebGL is not supported.")}};function c4(){const i=document.createElement("canvas"),t=["webgl2","webgl","experimental-webgl","moz-webgl","webkit-3d"];let e=null;return i.getContext&&t.some(s=>{try{return e=i.getContext(s),e!==null}catch{return!1}})?e:null}function d4(){let i="ontouchstart"in window||navigator.maxTouchPoints>0;Ko in localStorage&&(i=localStorage[Ko]==="true");const t=new Promise(e=>{const s=()=>{window.removeEventListener("mousedown",r),window.removeEventListener("touchstart",a),clearTimeout(u)},r=()=>{s(),localStorage[Ko]=!1,e(!1)},a=()=>{s(),localStorage[Ko]=!0,e(!0)},l=()=>{s(),localStorage[Ko]=i,e(i)};window.addEventListener("mousedown",r,!1),window.addEventListener("touchstart",a,!1);const u=setTimeout(l,1e4)});return{initial:i,promise:t}}function f4(i){const t=document.createElement("canvas"),e=t.getContext("2d");for(t.width=i,t.height=i/2;t.width>1024;){e.fillStyle="white",e.fillRect(0,0,1,1);try{if(e.getImageData(0,0,1,1).data[0]>0)return t.width}catch{}t.width/=2,t.height/=2}throw new Ie("Unable to detect system capabilities")}function p4(){return"exitFullscreen"in document?"fullscreenchange":"webkitExitFullscreen"in document?"webkitfullscreenchange":null}var m4=tu({resolution:64,blur:!1},{resolution:i=>{if(!i||!Ve.isPowerOfTwo(i))throw new Ie("EquirectangularAdapter resolution must be power of two");return i}}),su=class extends Sn{constructor(i,t){super(i),this.config=m4(t),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}async loadTexture(i,t,e=this.viewer.config.useXmpData){if(typeof i!="string")return Promise.reject(new Ie("Invalid panorama url, are you using the right adapter?"));const s=await this.viewer.textureLoader.loadFile(i,c=>this.viewer.loader.setProgress(c)),r=e?await this.loadXMP(s):null,a=await this.viewer.textureLoader.blobToImage(s);typeof t=="function"&&(t=t(a));const l={fullWidth:ds(t==null?void 0:t.fullWidth,r==null?void 0:r.fullWidth,a.width),fullHeight:ds(t==null?void 0:t.fullHeight,r==null?void 0:r.fullHeight,a.height),croppedWidth:ds(t==null?void 0:t.croppedWidth,r==null?void 0:r.croppedWidth,a.width),croppedHeight:ds(t==null?void 0:t.croppedHeight,r==null?void 0:r.croppedHeight,a.height),croppedX:ds(t==null?void 0:t.croppedX,r==null?void 0:r.croppedX,0),croppedY:ds(t==null?void 0:t.croppedY,r==null?void 0:r.croppedY,0),poseHeading:ds(t==null?void 0:t.poseHeading,r==null?void 0:r.poseHeading,0),posePitch:ds(t==null?void 0:t.posePitch,r==null?void 0:r.posePitch,0),poseRoll:ds(t==null?void 0:t.poseRoll,r==null?void 0:r.poseRoll,0)};(l.croppedWidth!==a.width||l.croppedHeight!==a.height)&&es(`Invalid panoData, croppedWidth and/or croppedHeight is not coherent with loaded image.
              panoData: ${l.croppedWidth}x${l.croppedHeight}, image: ${a.width}x${a.height}`),(t||r)&&l.fullWidth!==l.fullHeight*2&&es("Invalid panoData, fullWidth should be twice fullHeight");const u=this.createEquirectangularTexture(a,l);return{panorama:i,texture:u,panoData:l}}async loadXMP(i){const t=await this.loadBlobAsString(i),e=t.indexOf("<x:xmpmeta"),s=t.indexOf("</x:xmpmeta>"),r=t.substring(e,s);return e!==-1&&s!==-1&&r.includes("GPano:")?{fullWidth:fs(r,"FullPanoWidthPixels"),fullHeight:fs(r,"FullPanoHeightPixels"),croppedWidth:fs(r,"CroppedAreaImageWidthPixels"),croppedHeight:fs(r,"CroppedAreaImageHeightPixels"),croppedX:fs(r,"CroppedAreaLeftPixels"),croppedY:fs(r,"CroppedAreaTopPixels"),poseHeading:fs(r,"PoseHeadingDegrees"),posePitch:fs(r,"PosePitchDegrees"),poseRoll:fs(r,"PoseRollDegrees")}:null}loadBlobAsString(i){return new Promise((t,e)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=e,s.readAsText(i)})}createEquirectangularTexture(i,t){if(this.config.blur||t.fullWidth>xa.maxTextureWidth||t.croppedWidth!==t.fullWidth||t.croppedHeight!==t.fullHeight){const e=Math.min(1,xa.maxCanvasWidth/t.fullWidth),s={fullWidth:t.fullWidth*e,fullHeight:t.fullHeight*e,croppedWidth:t.croppedWidth*e,croppedHeight:t.croppedHeight*e,croppedX:t.croppedX*e,croppedY:t.croppedY*e},r=document.createElement("canvas");r.width=s.fullWidth,r.height=s.fullHeight;const a=r.getContext("2d");return this.config.blur&&(a.filter=`blur(${r.width/2048}px)`),a.drawImage(i,s.croppedX,s.croppedY,s.croppedWidth,s.croppedHeight),Td(r)}return Td(i)}createMesh(i=1){const t=new Yd(Yg*i,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1),e=Sn.createOverlayMaterial();return new GA(t,e)}setTexture(i,t){this.__setUniform(i,Sn.OVERLAY_UNIFORMS.panorama,t.texture),this.setOverlay(i,null,1)}setOverlay(i,t,e){this.__setUniform(i,Sn.OVERLAY_UNIFORMS.overlayOpacity,e),t?this.__setUniform(i,Sn.OVERLAY_UNIFORMS.overlay,t.texture):this.__setUniform(i,Sn.OVERLAY_UNIFORMS.overlay,new Fi)}setTextureOpacity(i,t){this.__setUniform(i,Sn.OVERLAY_UNIFORMS.globalOpacity,t),i.material.transparent=t<1}disposeTexture(i){var t;(t=i.texture)==null||t.dispose()}__setUniform(i,t,e){i.material.uniforms[t].value instanceof Fi&&i.material.uniforms[t].value.dispose(),i.material.uniforms[t].value=e}};su.id="equirectangular";su.supportsDownload=!0;su.supportsOverlay=!0;var g4=class c1{constructor(t,e){this.parent=t,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=t instanceof c1?t.viewer:t,this.container.className=e.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);t!==-1&&this.parent.children.splice(t,1),this.children.slice().forEach(e=>e.destroy()),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},v4=tu({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),tn=class extends g4{constructor(i,t){super(i,{className:`psv-button ${t.hoverScale?"psv-button--hover-scale":""} ${t.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=v4(t),this.config.id=this.constructor.id,t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",e=>{this.state.enabled&&this.onClick(),e.stopPropagation()}),this.container.addEventListener("keydown",e=>{e.key===ti.Enter&&this.state.enabled&&(this.onClick(),e.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(i=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),i&&this.viewer.navbar.autoSize())}hide(i=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",i&&this.viewer.navbar.autoSize())}checkSupported(){ov(this.isSupported(),(i,t)=>{!this.state||(this.state.supported=i,t?i||this.hide():this.toggle(i))})}autoSize(){}isSupported(){return!0}toggleActive(i=!this.state.active){i!==this.state.active&&(this.state.active=i,Jg(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(i){this.container.innerHTML=i,Kg(this.container.querySelector("svg"),"psv-button-svg")}},Qd=class extends tn{constructor(i){super(i,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ms.info}),this.mode=0,this.viewer.addEventListener(wh.type,this),this.viewer.addEventListener(bh.type,this),this.viewer.addEventListener(hr.type,this),this.viewer.addEventListener(ur.type,this),this.viewer.addEventListener(lr.type,this)}destroy(){this.viewer.removeEventListener(wh.type,this),this.viewer.removeEventListener(bh.type,this),this.viewer.removeEventListener(hr.type,this),this.viewer.removeEventListener(ur.type,this),this.viewer.removeEventListener(lr.type,this),super.destroy()}handleEvent(i){if(i instanceof lr){i.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let t=!1;i instanceof wh?t=this.mode===1:i instanceof bh?t=this.mode===1&&i.notificationId!==vs.DESCRIPTION:i instanceof hr?t=this.mode===2:i instanceof ur&&(t=this.mode===2&&i.panelId!==vs.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(i){super.hide(i),this.mode&&this.__close()}autoSize(i=!1){if(i){const t=this.viewer.navbar.getButton("caption",!1),e=t&&!t.isVisible(),s=!!this.viewer.config.description;e||s?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(vs.DESCRIPTION);break;case 2:this.viewer.panel.hide(vs.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:vs.DESCRIPTION,content:(this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:vs.DESCRIPTION,content:this.viewer.config.caption}))}};Qd.id="description";var d1=class extends tn{constructor(i){super(i,{className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Ms.download}),this.viewer.addEventListener(lr.type,this)}destroy(){this.viewer.removeEventListener(lr.type,this),super.destroy()}handleEvent(i){i instanceof lr&&i.containsOptions("downloadUrl")&&this.checkSupported()}onClick(){const i=document.createElement("a");i.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,i.href.startsWith("data:")&&!this.viewer.config.downloadName?i.download="panorama."+i.href.substring(0,i.href.indexOf(";")).split("/").pop():i.download=this.viewer.config.downloadName||i.href.split("/").pop(),i.target="_blank",this.viewer.container.appendChild(i),i.click(),setTimeout(()=>{this.viewer.container.removeChild(i)},100)}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}};d1.id="download";var f1=class extends tn{constructor(i){super(i,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ms.fullscreenIn,iconActive:Ms.fullscreenOut}),this.viewer.addEventListener(xh.type,this)}destroy(){this.viewer.removeEventListener(xh.type,this),super.destroy()}handleEvent(i){i instanceof xh&&this.toggleActive(i.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};f1.id="fullscreen";var y4="psvButton",x4=(i,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${Ms.menu} ${t}</h1>
  <ul class="psv-panel-menu-list">
    ${i.map(e=>`
    <li data-psv-button="${e.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${e.content}</span>
      <span class="psv-panel-menu-item-label">${e.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,w4=class extends tn{constructor(i){super(i,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ms.menu}),this.viewer.addEventListener(ur.type,this),this.viewer.addEventListener(hr.type,this),super.hide()}destroy(){this.viewer.removeEventListener(ur.type,this),this.viewer.removeEventListener(hr.type,this),super.destroy()}handleEvent(i){i instanceof ur?this.toggleActive(i.panelId===vs.MENU):i instanceof hr&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(i){super.hide(i),this.__hideMenu()}show(i){super.show(i),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:vs.MENU,content:x4(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:i=>{const t=i?tv(i,"li"):void 0,e=t?t.dataset[y4]:void 0;e&&(this.viewer.navbar.getButton(e).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(vs.MENU)}};w4.id="menu";function _4(i){let t=0;switch(i){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0;break}return Ms.arrow.replace("rotate(0",`rotate(${t}`)}var ka=class extends tn{constructor(i,t){super(i,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:_4(t)}),this.direction=t,this.handler=new Xd,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(i){switch(i.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":i.key===ti.Enter&&this.__onMouseDown();break;case"keyup":i.key===ti.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return Kh(xa.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const i={};switch(this.direction){case 0:i.pitch=!1;break;case 1:i.pitch=!0;break;case 3:i.yaw=!1;break;default:i.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(i),this.handler.down()}__onMouseUp(){!this.state.enabled||this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};ka.groupId="move";var p1=class extends ka{constructor(i){super(i,1)}};p1.id="moveDown";var m1=class extends ka{constructor(i){super(i,2)}};m1.id="moveLeft";var g1=class extends ka{constructor(i){super(i,3)}};g1.id="moveRight";var v1=class extends ka{constructor(i){super(i,0)}};v1.id="moveUp";var Jd=class extends tn{constructor(i,t,e){super(i,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=t,this.handler=new Xd,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(i){switch(i.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":i.key===ti.Enter&&this.__onMouseDown();break;case"keyup":i.key===ti.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return Kh(xa.isTouchEnabled)}__onMouseDown(){!this.state.enabled||(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){!this.state.enabled||this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};Jd.groupId="zoom";var y1=class extends Jd{constructor(i){super(i,0,Ms.zoomIn)}};y1.id="zoomIn";var x1=class extends Jd{constructor(i){super(i,1,Ms.zoomOut)}};x1.id="zoomOut";var Kd=class extends tn{constructor(i){super(i,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new hv(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(ev(this.container,"maxWidth"),10),this.viewer.addEventListener(Mh.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(_h.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(Mh.type,this),this.viewer.removeEventListener(_h.type,this),super.destroy()}handleEvent(i){i instanceof Mh?this.__moveZoomValue(i.zoomLevel):i instanceof _h&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return Kh(xa.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(i){this.zoomValue.style.left=i/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(i){i.mousedown&&this.viewer.zoom(i.value*100)}};Kd.id="zoomRange";Kd.groupId="zoom";var w1=class extends qk{constructor(i){super(),this.viewer=i}init(){}destroy(){}},_1=class extends w1{constructor(i,t){super(i),this.config=this.constructor.configParser(t)}setOption(i,t){this.setOptions({[i]:t})}setOptions(i){const t={...this.config,...i},e=this.constructor,s=e.configParser,r=e.readonlyOptions,a=e.id;for(let[l,u]of Object.entries(i)){if(!(l in s.defaults)){es(`${a}: Unknown option "${l}"`);continue}if(r.includes(l)){es(`${a}: Option "${l}" cannot be updated`);continue}l in s.parsers&&(u=s.parsers[l](u,{rawConfig:t,defValue:s.defaults[l]})),this.config[l]=u}}};_1.readonlyOptions=[];function C0(i){if(i){for(const[,t]of[["_",i],...Object.entries(i)])if(t.prototype instanceof w1)return t}return null}var wa={panorama:null,overlay:null,overlayOpacity:1,container:null,adapter:[su,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"Loading...",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,useXmpData:!0,panoData:null,requestHeaders:null,canvasBackground:"#000",withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",download:"Download",fullscreen:"Fullscreen",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama can't be loaded"},keyboard:"fullscreen",keyboardActions:{[ti.ArrowUp]:"ROTATE_UP",[ti.ArrowDown]:"ROTATE_DOWN",[ti.ArrowRight]:"ROTATE_RIGHT",[ti.ArrowLeft]:"ROTATE_LEFT",[ti.PageUp]:"ZOOM_IN",[ti.PageDown]:"ZOOM_OUT",[ti.Plus]:"ZOOM_IN",[ti.Minus]:"ZOOM_OUT"}},b4={container:i=>{if(!i)throw new Ie("No value given for container.");return i},adapter:(i,{defValue:t})=>{if(i?Array.isArray(i)?i=[k0(i[0]),i[1]]:i=[k0(i),null]:i=t,!i[0])throw new Ie("An undefined value was given for adapter.");if(!i[0].id)throw new Ie("Adapter has no id.");return i},overlayOpacity:i=>Ve.clamp(i,0,1),defaultYaw:i=>zd(i),defaultPitch:i=>zd(i,!0),defaultZoomLvl:i=>Ve.clamp(i,0,100),minFov:(i,{rawConfig:t})=>(t.maxFov<i&&(es("maxFov cannot be lower than minFov"),i=t.maxFov),Ve.clamp(i,1,179)),maxFov:(i,{rawConfig:t})=>(i<t.minFov&&(i=t.minFov),Ve.clamp(i,1,179)),lang:i=>(Array.isArray(i.twoFingers)&&(es("lang.twoFingers must not be an array"),i.twoFingers=i.twoFingers[0]),{...wa.lang,...i}),keyboard:i=>i?typeof i=="object"?(es("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):i==="always"?"always":"fullscreen":!1,keyboardActions:(i,{rawConfig:t})=>t.keyboard&&typeof t.keyboard=="object"?t.keyboard:i,fisheye:i=>i===!0?1:i===!1?0:i,requestHeaders:i=>i&&typeof i=="object"?()=>i:typeof i=="function"?i:null,plugins:i=>i.map((t,e)=>{if(Array.isArray(t)?t=[C0(t[0]),t[1]]:t=[C0(t),null],!t[0])throw new Ie(`An undefined value was given for plugin ${e}.`);if(!t[0].id)throw new Ie(`Plugin ${e} has no id.`);return t}),navbar:i=>i===!1?null:i===!0?$h(wa.navbar):typeof i=="string"?i.split(/[ ,]/):i};tu(wa,b4);var b1=class extends tn{constructor(i){super(i,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(i){this.show(),this.contentElt.innerHTML=i!=null?i:"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var i;(i=this.viewer.navbar.getButton(Qd.id,!1))==null||i.autoSize(!0)}};b1.id="caption";var M4={},z0={};function M1(i,t){if(!i.id)throw new Ie("Button id is required");if(M4[i.id]=i,i.groupId&&(z0[i.groupId]=z0[i.groupId]||[]).push(i),t){const e=wa.navbar;switch(t){case"start":e.unshift(i.id);break;case"end":e.push(i.id);break;default:{const[s,r]=t.split(":"),a=e.indexOf(s);if(!s||!r||a===-1)throw new Ie(`Invalid defaultPosition ${t}`);e.splice(a+(r==="right"?1:0),0,i.id)}}}}[x1,Kd,y1,Qd,b1,d1,f1,m1,g1,v1,p1].forEach(i=>M1(i));new N;new _o(0,0,0,"ZXY");new He;KA.enabled=!0;Ci.enabled=!1;/*!
 * PhotoSphereViewer.GyroscopePlugin 5.1.7
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var E4=Object.defineProperty,S4=(i,t)=>{for(var e in t)E4(i,e,{get:t[e],enumerable:!0})},A4='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M50 0a50 50 0 1 0 0 100A50 50 0 0 0 50 0zm0 88.81a38.86 38.86 0 0 1-38.81-38.8 38.86 38.86 0 0 1 38.8-38.82A38.86 38.86 0 0 1 88.82 50 38.87 38.87 0 0 1 50 88.81z"/><path fill="currentColor" d="M72.07 25.9L40.25 41.06 27.92 74.12l31.82-15.18v-.01l12.32-33.03zM57.84 54.4L44.9 42.58l21.1-10.06-8.17 21.9z"/><!--Created by iconoci from the Noun Project--></svg>',k4={};S4(k4,{GyroscopeUpdatedEvent:()=>mo});var E1=class S1 extends uv{constructor(t){super(S1.type),this.gyroscopeEnabled=t}};E1.type="gyroscope-updated";var mo=E1,tf=class extends tn{constructor(i){super(i,{className:"psv-gyroscope-button",icon:A4,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("gyroscope"),this.plugin&&this.plugin.addEventListener(mo.type,this)}destroy(){this.plugin&&this.plugin.removeEventListener(mo.type,this),super.destroy()}isSupported(){return this.plugin?{initial:!1,promise:this.plugin.isSupported()}:!1}handleEvent(i){i instanceof mo&&this.toggleActive(i.gyroscopeEnabled)}onClick(){this.plugin.toggle()}};tf.id="gyroscope";var C4=new N(0,0,1),T0=new _o,z4=new Ks,T4=new Ks(-Math.sqrt(.5),0,0,Math.sqrt(.5)),O4=class{constructor(i){window.isSecureContext===!1&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");const t=this,e=1e-6,s=new Ks;this.object=i,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;const r=function(u){t.deviceOrientation=u},a=function(){t.screenOrientation=window.orientation||0},l=function(u,c,d,f,m){T0.set(d,c,-f,"YXZ"),u.setFromEuler(T0),u.multiply(T4),u.multiply(z4.setFromAxisAngle(C4,-m))};this.connect=function(){a(),window.DeviceOrientationEvent!==void 0&&typeof window.DeviceOrientationEvent.requestPermission=="function"?window.DeviceOrientationEvent.requestPermission().then(function(u){u=="granted"&&(window.addEventListener("orientationchange",a),window.addEventListener("deviceorientation",r))}).catch(function(u){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",u)}):(window.addEventListener("orientationchange",a),window.addEventListener("deviceorientation",r)),t.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",a),window.removeEventListener("deviceorientation",r),t.enabled=!1},this.update=function(){if(t.enabled===!1)return;const u=t.deviceOrientation;if(u){const c=u.alpha?Ve.degToRad(u.alpha)+t.alphaOffset:0,d=u.beta?Ve.degToRad(u.beta):0,f=u.gamma?Ve.degToRad(u.gamma):0,m=t.screenOrientation?Ve.degToRad(t.screenOrientation):0;l(t.object.quaternion,c,d,f,m),8*(1-s.dot(t.object.quaternion))>e&&s.copy(t.object.quaternion)}},this.dispose=function(){t.disconnect()},this.connect()}},I4=or.getConfigParser({touchmove:!0,absolutePosition:!1,moveMode:"smooth"},{moveMode(i,{defValue:t}){return i!=="smooth"&&i!=="fast"?(or.logWarn("GyroscopePlugin: invalid moveMode"),t):i}}),jl=new N,A1=class extends _1{constructor(i,t){super(i,t),this.state={isSupported:this.__checkSupport(),alphaOffset:0,enabled:!1,config_moveInertia:!0,moveMode:this.config.moveMode}}init(){super.init(),this.viewer.addEventListener(ps.StopAllEvent.type,this),this.viewer.addEventListener(ps.BeforeRotateEvent.type,this),this.viewer.addEventListener(ps.BeforeRenderEvent.type,this)}destroy(){this.viewer.removeEventListener(ps.StopAllEvent.type,this),this.viewer.removeEventListener(ps.BeforeRotateEvent.type,this),this.viewer.removeEventListener(ps.BeforeRenderEvent.type,this),this.stop(),delete this.controls,super.destroy()}handleEvent(i){i instanceof ps.StopAllEvent?this.stop():i instanceof ps.BeforeRenderEvent?this.__onBeforeRender():i instanceof ps.BeforeRotateEvent&&this.__onBeforeRotate(i)}isSupported(){return this.state.isSupported}isEnabled(){return this.state.enabled}start(i=this.config.moveMode){return this.state.isSupported.then(t=>t?this.__requestPermission():(or.logWarn("gyroscope not available"),Promise.reject())).then(t=>t?Promise.resolve():(or.logWarn("gyroscope not allowed"),Promise.reject())).then(()=>{this.viewer.stopAll(),this.state.moveMode=i,this.state.config_moveInertia=this.viewer.config.moveInertia,this.viewer.config.moveInertia=!1,this.controls?this.controls.connect():this.controls=new O4(new ws),this.controls.deviceOrientation=null,this.controls.screenOrientation=0,this.controls.alphaOffset=0,this.state.alphaOffset=this.config.absolutePosition?0:null,this.state.enabled=!0,this.dispatchEvent(new mo(!0))})}stop(){this.isEnabled()&&(this.controls.disconnect(),this.state.enabled=!1,this.viewer.config.moveInertia=this.state.config_moveInertia,this.dispatchEvent(new mo(!1)),this.viewer.resetIdleTimer())}toggle(){this.isEnabled()?this.stop():this.start()}__onBeforeRender(){if(!this.isEnabled()||!this.controls.deviceOrientation)return;const i=this.viewer.getPosition();if(this.state.alphaOffset===null){this.controls.update(),this.controls.object.getWorldDirection(jl);const t=this.viewer.dataHelper.vector3ToSphericalCoords(jl);this.state.alphaOffset=t.yaw-i.yaw}else{this.controls.alphaOffset=this.state.alphaOffset,this.controls.update(),this.controls.object.getWorldDirection(jl);const t=this.viewer.dataHelper.vector3ToSphericalCoords(jl),e={yaw:t.yaw,pitch:-t.pitch},s=this.state.moveMode==="smooth"?3:10;this.viewer.dynamics.position.goto(e,or.getAngle(i,e)<.01?1:s)}}__onBeforeRotate(i){this.isEnabled()&&(i.preventDefault(),this.config.touchmove&&(this.state.alphaOffset-=i.position.yaw-this.viewer.getPosition().pitch))}__checkSupport(){return"DeviceOrientationEvent"in window&&typeof DeviceOrientationEvent.requestPermission=="function"?Promise.resolve(!0):"DeviceOrientationEvent"in window?new Promise(i=>{const t=e=>{i(!!e&&!or.isNil(e.alpha)&&!isNaN(e.alpha)),window.removeEventListener("deviceorientation",t)};window.addEventListener("deviceorientation",t,!1),setTimeout(t,1e4)}):Promise.resolve(!1)}__requestPermission(){return typeof DeviceOrientationEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(i=>i==="granted").catch(()=>!1):Promise.resolve(!0)}};A1.id="gyroscope";A1.configParser=I4;wa.lang[tf.id]="Gyroscope";M1(tf,"caption:right");/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const k1="153",Od=0,L4=1,O0=1,P4=100,R4=204,F4=205,$4=3,B4=0,C1=300,I0=1e3,Zl=1001,L0=1002,z1=1006,N4=1008,U4=1009,D4=1015,V4=1023,H4=3e3,id=3001,sd="",Ri="srgb",ef="srgb-linear",T1="display-p3",nd=7680,W4=519,P0=35044,ha=2e3,R0=2001;class nu{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[t]===void 0&&(s[t]=[]),s[t].indexOf(e)===-1&&s[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const s=this._listeners;return s[t]!==void 0&&s[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const a=r.indexOf(e);a!==-1&&r.splice(a,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const s=this._listeners[t.type];if(s!==void 0){t.target=this;const r=s.slice(0);for(let a=0,l=r.length;a<l;a++)r[a].call(this,t);t.target=null}}}const ze=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let F0=1234567;const go=Math.PI/180,Uh=180/Math.PI;function bo(){const i=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(ze[i&255]+ze[i>>8&255]+ze[i>>16&255]+ze[i>>24&255]+"-"+ze[t&255]+ze[t>>8&255]+"-"+ze[t>>16&15|64]+ze[t>>24&255]+"-"+ze[e&63|128]+ze[e>>8&255]+"-"+ze[e>>16&255]+ze[e>>24&255]+ze[s&255]+ze[s>>8&255]+ze[s>>16&255]+ze[s>>24&255]).toLowerCase()}function De(i,t,e){return Math.max(t,Math.min(e,i))}function sf(i,t){return(i%t+t)%t}function q4(i,t,e,s,r){return s+(i-t)*(r-s)/(e-t)}function G4(i,t,e){return i!==t?(e-i)/(t-i):0}function ma(i,t,e){return(1-e)*i+e*t}function Y4(i,t,e,s){return ma(i,t,1-Math.exp(-e*s))}function j4(i,t=1){return t-Math.abs(sf(i,t*2)-t)}function Z4(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*(3-2*i))}function X4(i,t,e){return i<=t?0:i>=e?1:(i=(i-t)/(e-t),i*i*i*(i*(i*6-15)+10))}function Q4(i,t){return i+Math.floor(Math.random()*(t-i+1))}function J4(i,t){return i+Math.random()*(t-i)}function K4(i){return i*(.5-Math.random())}function t5(i){i!==void 0&&(F0=i);let t=F0+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function e5(i){return i*go}function i5(i){return i*Uh}function s5(i){return(i&i-1)===0&&i!==0}function n5(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function r5(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function o5(i,t,e,s,r){const a=Math.cos,l=Math.sin,u=a(e/2),c=l(e/2),d=a((t+s)/2),f=l((t+s)/2),m=a((t-s)/2),g=l((t-s)/2),v=a((s-t)/2),x=l((s-t)/2);switch(r){case"XYX":i.set(u*f,c*m,c*g,u*d);break;case"YZY":i.set(c*g,u*f,c*m,u*d);break;case"ZXZ":i.set(c*m,c*g,u*f,u*d);break;case"XZX":i.set(u*f,c*x,c*v,u*d);break;case"YXY":i.set(c*v,u*f,c*x,u*d);break;case"ZYZ":i.set(c*x,c*v,u*f,u*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ua(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Je(i,t){switch(t.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Ki={DEG2RAD:go,RAD2DEG:Uh,generateUUID:bo,clamp:De,euclideanModulo:sf,mapLinear:q4,inverseLerp:G4,lerp:ma,damp:Y4,pingpong:j4,smoothstep:Z4,smootherstep:X4,randInt:Q4,randFloat:J4,randFloatSpread:K4,seededRandom:t5,degToRad:e5,radToDeg:i5,isPowerOfTwo:s5,ceilPowerOfTwo:n5,floorPowerOfTwo:r5,setQuaternionFromProperEuler:o5,normalize:Je,denormalize:ua};class Le{constructor(t=0,e=0){Le.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,s=this.y,r=t.elements;return this.x=r[0]*e+r[3]*s+r[6],this.y=r[1]*e+r[4]*s+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(De(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y;return e*e+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const s=Math.cos(e),r=Math.sin(e),a=this.x-t.x,l=this.y-t.y;return this.x=a*s-l*r+t.x,this.y=a*r+l*s+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Pn{constructor(t,e,s,r,a,l,u,c,d){Pn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,s,r,a,l,u,c,d)}set(t,e,s,r,a,l,u,c,d){const f=this.elements;return f[0]=t,f[1]=r,f[2]=u,f[3]=e,f[4]=a,f[5]=c,f[6]=s,f[7]=l,f[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],this}extractBasis(t,e,s){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,r=e.elements,a=this.elements,l=s[0],u=s[3],c=s[6],d=s[1],f=s[4],m=s[7],g=s[2],v=s[5],x=s[8],b=r[0],E=r[3],S=r[6],z=r[1],I=r[4],O=r[7],P=r[2],G=r[5],$=r[8];return a[0]=l*b+u*z+c*P,a[3]=l*E+u*I+c*G,a[6]=l*S+u*O+c*$,a[1]=d*b+f*z+m*P,a[4]=d*E+f*I+m*G,a[7]=d*S+f*O+m*$,a[2]=g*b+v*z+x*P,a[5]=g*E+v*I+x*G,a[8]=g*S+v*O+x*$,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8];return e*l*f-e*u*d-s*a*f+s*u*c+r*a*d-r*l*c}invert(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8],m=f*l-u*d,g=u*c-f*a,v=d*a-l*c,x=e*m+s*g+r*v;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/x;return t[0]=m*b,t[1]=(r*d-f*s)*b,t[2]=(u*s-r*l)*b,t[3]=g*b,t[4]=(f*e-r*c)*b,t[5]=(r*a-u*e)*b,t[6]=v*b,t[7]=(s*c-d*e)*b,t[8]=(l*e-s*a)*b,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,s,r,a,l,u){const c=Math.cos(a),d=Math.sin(a);return this.set(s*c,s*d,-s*(c*l+d*u)+l+t,-r*d,r*c,-r*(-d*l+c*u)+u+e,0,0,1),this}scale(t,e){return this.premultiply(rd.makeScale(t,e)),this}rotate(t){return this.premultiply(rd.makeRotation(-t)),this}translate(t,e){return this.premultiply(rd.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,s,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,s=t.elements;for(let r=0;r<9;r++)if(e[r]!==s[r])return!1;return!0}fromArray(t,e=0){for(let s=0;s<9;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const rd=new Pn;function a5(i){for(let t=i.length-1;t>=0;--t)if(i[t]>=65535)return!0;return!1}function $0(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}const B0={};function od(i){i in B0||(B0[i]=!0,console.warn(i))}function vo(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function ad(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}const l5=new Pn().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),h5=new Pn().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function u5(i){return i.convertSRGBToLinear().applyMatrix3(h5)}function c5(i){return i.applyMatrix3(l5).convertLinearToSRGB()}const d5={[ef]:i=>i,[Ri]:i=>i.convertSRGBToLinear(),[T1]:u5},f5={[ef]:i=>i,[Ri]:i=>i.convertLinearToSRGB(),[T1]:c5},Ti={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(i){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!i},get workingColorSpace(){return ef},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,t,e){if(this.enabled===!1||t===e||!t||!e)return i;const s=d5[t],r=f5[e];if(s===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${e}".`);return r(s(i))},fromWorkingColorSpace:function(i,t){return this.convert(i,this.workingColorSpace,t)},toWorkingColorSpace:function(i,t){return this.convert(i,t,this.workingColorSpace)}};let Yr;class p5{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Yr===void 0&&(Yr=$0("canvas")),Yr.width=t.width,Yr.height=t.height;const s=Yr.getContext("2d");t instanceof ImageData?s.putImageData(t,0,0):s.drawImage(t,0,0,t.width,t.height),e=Yr}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&t instanceof ImageBitmap){const e=$0("canvas");e.width=t.width,e.height=t.height;const s=e.getContext("2d");s.drawImage(t,0,0,t.width,t.height);const r=s.getImageData(0,0,t.width,t.height),a=r.data;for(let l=0;l<a.length;l++)a[l]=vo(a[l]/255)*255;return s.putImageData(r,0,0),e}else if(t.data){const e=t.data.slice(0);for(let s=0;s<e.length;s++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[s]=Math.floor(vo(e[s]/255)*255):e[s]=vo(e[s]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let m5=0;class g5{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:m5++}),this.uuid=bo(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const s={uuid:this.uuid,url:""},r=this.data;if(r!==null){let a;if(Array.isArray(r)){a=[];for(let l=0,u=r.length;l<u;l++)r[l].isDataTexture?a.push(ld(r[l].image)):a.push(ld(r[l]))}else a=ld(r);s.url=a}return e||(t.images[this.uuid]=s),s}}function ld(i){return typeof HTMLImageElement!="undefined"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&i instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&i instanceof ImageBitmap?p5.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let v5=0;class $i extends nu{constructor(t=$i.DEFAULT_IMAGE,e=$i.DEFAULT_MAPPING,s=Zl,r=Zl,a=z1,l=N4,u=V4,c=U4,d=$i.DEFAULT_ANISOTROPY,f=sd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:v5++}),this.uuid=bo(),this.name="",this.source=new g5(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=s,this.wrapT=r,this.magFilter=a,this.minFilter=l,this.anisotropy=d,this.format=u,this.internalFormat=null,this.type=c,this.offset=new Le(0,0),this.repeat=new Le(1,1),this.center=new Le(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof f=="string"?this.colorSpace=f:(od("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=f===id?Ri:sd),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),e||(t.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==C1)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case I0:t.x=t.x-Math.floor(t.x);break;case Zl:t.x=t.x<0?0:1;break;case L0:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case I0:t.y=t.y-Math.floor(t.y);break;case Zl:t.y=t.y<0?0:1;break;case L0:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return od("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Ri?id:H4}set encoding(t){od("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===id?Ri:sd}}$i.DEFAULT_IMAGE=null;$i.DEFAULT_MAPPING=C1;$i.DEFAULT_ANISOTROPY=1;class Mo{constructor(t=0,e=0,s=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=s,this._w=r}static slerpFlat(t,e,s,r,a,l,u){let c=s[r+0],d=s[r+1],f=s[r+2],m=s[r+3];const g=a[l+0],v=a[l+1],x=a[l+2],b=a[l+3];if(u===0){t[e+0]=c,t[e+1]=d,t[e+2]=f,t[e+3]=m;return}if(u===1){t[e+0]=g,t[e+1]=v,t[e+2]=x,t[e+3]=b;return}if(m!==b||c!==g||d!==v||f!==x){let E=1-u;const S=c*g+d*v+f*x+m*b,z=S>=0?1:-1,I=1-S*S;if(I>Number.EPSILON){const P=Math.sqrt(I),G=Math.atan2(P,S*z);E=Math.sin(E*G)/P,u=Math.sin(u*G)/P}const O=u*z;if(c=c*E+g*O,d=d*E+v*O,f=f*E+x*O,m=m*E+b*O,E===1-u){const P=1/Math.sqrt(c*c+d*d+f*f+m*m);c*=P,d*=P,f*=P,m*=P}}t[e]=c,t[e+1]=d,t[e+2]=f,t[e+3]=m}static multiplyQuaternionsFlat(t,e,s,r,a,l){const u=s[r],c=s[r+1],d=s[r+2],f=s[r+3],m=a[l],g=a[l+1],v=a[l+2],x=a[l+3];return t[e]=u*x+f*m+c*v-d*g,t[e+1]=c*x+f*g+d*m-u*v,t[e+2]=d*x+f*v+u*g-c*m,t[e+3]=f*x-u*m-c*g-d*v,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,s,r){return this._x=t,this._y=e,this._z=s,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const s=t._x,r=t._y,a=t._z,l=t._order,u=Math.cos,c=Math.sin,d=u(s/2),f=u(r/2),m=u(a/2),g=c(s/2),v=c(r/2),x=c(a/2);switch(l){case"XYZ":this._x=g*f*m+d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m-g*v*x;break;case"YXZ":this._x=g*f*m+d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m+g*v*x;break;case"ZXY":this._x=g*f*m-d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m-g*v*x;break;case"ZYX":this._x=g*f*m-d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m+g*v*x;break;case"YZX":this._x=g*f*m+d*v*x,this._y=d*v*m+g*f*x,this._z=d*f*x-g*v*m,this._w=d*f*m-g*v*x;break;case"XZY":this._x=g*f*m-d*v*x,this._y=d*v*m-g*f*x,this._z=d*f*x+g*v*m,this._w=d*f*m+g*v*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const s=e/2,r=Math.sin(s);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,s=e[0],r=e[4],a=e[8],l=e[1],u=e[5],c=e[9],d=e[2],f=e[6],m=e[10],g=s+u+m;if(g>0){const v=.5/Math.sqrt(g+1);this._w=.25/v,this._x=(f-c)*v,this._y=(a-d)*v,this._z=(l-r)*v}else if(s>u&&s>m){const v=2*Math.sqrt(1+s-u-m);this._w=(f-c)/v,this._x=.25*v,this._y=(r+l)/v,this._z=(a+d)/v}else if(u>m){const v=2*Math.sqrt(1+u-s-m);this._w=(a-d)/v,this._x=(r+l)/v,this._y=.25*v,this._z=(c+f)/v}else{const v=2*Math.sqrt(1+m-s-u);this._w=(l-r)/v,this._x=(a+d)/v,this._y=(c+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let s=t.dot(e)+1;return s<Number.EPSILON?(s=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=s):(this._x=0,this._y=-t.z,this._z=t.y,this._w=s)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=s),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(De(this.dot(t),-1,1)))}rotateTowards(t,e){const s=this.angleTo(t);if(s===0)return this;const r=Math.min(1,e/s);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const s=t._x,r=t._y,a=t._z,l=t._w,u=e._x,c=e._y,d=e._z,f=e._w;return this._x=s*f+l*u+r*d-a*c,this._y=r*f+l*c+a*u-s*d,this._z=a*f+l*d+s*c-r*u,this._w=l*f-s*u-r*c-a*d,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const s=this._x,r=this._y,a=this._z,l=this._w;let u=l*t._w+s*t._x+r*t._y+a*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=l,this._x=s,this._y=r,this._z=a,this;const c=1-u*u;if(c<=Number.EPSILON){const v=1-e;return this._w=v*l+e*this._w,this._x=v*s+e*this._x,this._y=v*r+e*this._y,this._z=v*a+e*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(c),f=Math.atan2(d,u),m=Math.sin((1-e)*f)/d,g=Math.sin(e*f)/d;return this._w=l*m+this._w*g,this._x=s*m+this._x*g,this._y=r*m+this._y*g,this._z=a*m+this._z*g,this._onChangeCallback(),this}slerpQuaternions(t,e,s){return this.copy(t).slerp(e,s)}random(){const t=Math.random(),e=Math.sqrt(1-t),s=Math.sqrt(t),r=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(e*Math.cos(r),s*Math.sin(a),s*Math.cos(a),e*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class U{constructor(t=0,e=0,s=0){U.prototype.isVector3=!0,this.x=t,this.y=e,this.z=s}set(t,e,s){return s===void 0&&(s=this.z),this.x=t,this.y=e,this.z=s,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(N0.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(N0.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,s=this.y,r=this.z,a=t.elements;return this.x=a[0]*e+a[3]*s+a[6]*r,this.y=a[1]*e+a[4]*s+a[7]*r,this.z=a[2]*e+a[5]*s+a[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,s=this.y,r=this.z,a=t.elements,l=1/(a[3]*e+a[7]*s+a[11]*r+a[15]);return this.x=(a[0]*e+a[4]*s+a[8]*r+a[12])*l,this.y=(a[1]*e+a[5]*s+a[9]*r+a[13])*l,this.z=(a[2]*e+a[6]*s+a[10]*r+a[14])*l,this}applyQuaternion(t){const e=this.x,s=this.y,r=this.z,a=t.x,l=t.y,u=t.z,c=t.w,d=c*e+l*r-u*s,f=c*s+u*e-a*r,m=c*r+a*s-l*e,g=-a*e-l*s-u*r;return this.x=d*c+g*-a+f*-u-m*-l,this.y=f*c+g*-l+m*-a-d*-u,this.z=m*c+g*-u+d*-l-f*-a,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,s=this.y,r=this.z,a=t.elements;return this.x=a[0]*e+a[4]*s+a[8]*r,this.y=a[1]*e+a[5]*s+a[9]*r,this.z=a[2]*e+a[6]*s+a[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Math.max(t,Math.min(e,s)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,s){return this.x=t.x+(e.x-t.x)*s,this.y=t.y+(e.y-t.y)*s,this.z=t.z+(e.z-t.z)*s,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const s=t.x,r=t.y,a=t.z,l=e.x,u=e.y,c=e.z;return this.x=r*c-a*u,this.y=a*l-s*c,this.z=s*u-r*l,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const s=t.dot(this)/e;return this.copy(t).multiplyScalar(s)}projectOnPlane(t){return hd.copy(this).projectOnVector(t),this.sub(hd)}reflect(t){return this.sub(hd.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const s=this.dot(t)/e;return Math.acos(De(s,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,s=this.y-t.y,r=this.z-t.z;return e*e+s*s+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,s){const r=Math.sin(e)*t;return this.x=r*Math.sin(s),this.y=Math.cos(e)*t,this.z=r*Math.cos(s),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,s){return this.x=t*Math.sin(e),this.y=s,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),s=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=s,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,s=Math.sqrt(1-t**2);return this.x=s*Math.cos(e),this.y=s*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const hd=new U,N0=new Mo;class Ca{constructor(t=new U(1/0,1/0,1/0),e=new U(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e+=3)this.expandByPoint(js.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,s=t.count;e<s;e++)this.expandByPoint(js.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,s=t.length;e<s;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const s=js.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(s),this.max.copy(t).add(s),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){if(t.updateWorldMatrix(!1,!1),t.boundingBox!==void 0)t.boundingBox===null&&t.computeBoundingBox(),jr.copy(t.boundingBox),jr.applyMatrix4(t.matrixWorld),this.union(jr);else{const r=t.geometry;if(r!==void 0)if(e&&r.attributes!==void 0&&r.attributes.position!==void 0){const a=r.attributes.position;for(let l=0,u=a.count;l<u;l++)js.fromBufferAttribute(a,l).applyMatrix4(t.matrixWorld),this.expandByPoint(js)}else r.boundingBox===null&&r.computeBoundingBox(),jr.copy(r.boundingBox),jr.applyMatrix4(t.matrixWorld),this.union(jr)}const s=t.children;for(let r=0,a=s.length;r<a;r++)this.expandByObject(s[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,js),js.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,s;return t.normal.x>0?(e=t.normal.x*this.min.x,s=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,s=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,s+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,s+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,s+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,s+=t.normal.z*this.min.z),e<=-t.constant&&s>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(ta),Xl.subVectors(this.max,ta),Zr.subVectors(t.a,ta),Xr.subVectors(t.b,ta),Qr.subVectors(t.c,ta),_n.subVectors(Xr,Zr),bn.subVectors(Qr,Xr),tr.subVectors(Zr,Qr);let e=[0,-_n.z,_n.y,0,-bn.z,bn.y,0,-tr.z,tr.y,_n.z,0,-_n.x,bn.z,0,-bn.x,tr.z,0,-tr.x,-_n.y,_n.x,0,-bn.y,bn.x,0,-tr.y,tr.x,0];return!ud(e,Zr,Xr,Qr,Xl)||(e=[1,0,0,0,1,0,0,0,1],!ud(e,Zr,Xr,Qr,Xl))?!1:(Ql.crossVectors(_n,bn),e=[Ql.x,Ql.y,Ql.z],ud(e,Zr,Xr,Qr,Xl))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,js).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(js).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ys[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ys[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ys[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ys[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ys[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ys[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ys[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ys[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ys),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Ys=[new U,new U,new U,new U,new U,new U,new U,new U],js=new U,jr=new Ca,Zr=new U,Xr=new U,Qr=new U,_n=new U,bn=new U,tr=new U,ta=new U,Xl=new U,Ql=new U,er=new U;function ud(i,t,e,s,r){for(let a=0,l=i.length-3;a<=l;a+=3){er.fromArray(i,a);const u=r.x*Math.abs(er.x)+r.y*Math.abs(er.y)+r.z*Math.abs(er.z),c=t.dot(er),d=e.dot(er),f=s.dot(er);if(Math.max(-Math.max(c,d,f),Math.min(c,d,f))>u)return!1}return!0}const y5=new Ca,ea=new U,cd=new U;class O1{constructor(t=new U,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const s=this.center;e!==void 0?s.copy(e):y5.setFromPoints(t).getCenter(s);let r=0;for(let a=0,l=t.length;a<l;a++)r=Math.max(r,s.distanceToSquared(t[a]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const s=this.center.distanceToSquared(t);return e.copy(t),s>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;ea.subVectors(t,this.center);const e=ea.lengthSq();if(e>this.radius*this.radius){const s=Math.sqrt(e),r=(s-this.radius)*.5;this.center.addScaledVector(ea,r/s),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(cd.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(ea.copy(t.center).add(cd)),this.expandByPoint(ea.copy(t.center).sub(cd))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Zs=new U,dd=new U,Jl=new U,Mn=new U,fd=new U,Kl=new U,pd=new U;class x5{constructor(t=new U,e=new U(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Zs)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const s=e.dot(this.direction);return s<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Zs.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Zs.copy(this.origin).addScaledVector(this.direction,e),Zs.distanceToSquared(t))}distanceSqToSegment(t,e,s,r){dd.copy(t).add(e).multiplyScalar(.5),Jl.copy(e).sub(t).normalize(),Mn.copy(this.origin).sub(dd);const a=t.distanceTo(e)*.5,l=-this.direction.dot(Jl),u=Mn.dot(this.direction),c=-Mn.dot(Jl),d=Mn.lengthSq(),f=Math.abs(1-l*l);let m,g,v,x;if(f>0)if(m=l*c-u,g=l*u-c,x=a*f,m>=0)if(g>=-x)if(g<=x){const b=1/f;m*=b,g*=b,v=m*(m+l*g+2*u)+g*(l*m+g+2*c)+d}else g=a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;else g=-a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;else g<=-x?(m=Math.max(0,-(-l*a+u)),g=m>0?-a:Math.min(Math.max(-a,-c),a),v=-m*m+g*(g+2*c)+d):g<=x?(m=0,g=Math.min(Math.max(-a,-c),a),v=g*(g+2*c)+d):(m=Math.max(0,-(l*a+u)),g=m>0?a:Math.min(Math.max(-a,-c),a),v=-m*m+g*(g+2*c)+d);else g=l>0?-a:a,m=Math.max(0,-(l*g+u)),v=-m*m+g*(g+2*c)+d;return s&&s.copy(this.origin).addScaledVector(this.direction,m),r&&r.copy(dd).addScaledVector(Jl,g),v}intersectSphere(t,e){Zs.subVectors(t.center,this.origin);const s=Zs.dot(this.direction),r=Zs.dot(Zs)-s*s,a=t.radius*t.radius;if(r>a)return null;const l=Math.sqrt(a-r),u=s-l,c=s+l;return c<0?null:u<0?this.at(c,e):this.at(u,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(t.normal)+t.constant)/e;return s>=0?s:null}intersectPlane(t,e){const s=this.distanceToPlane(t);return s===null?null:this.at(s,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let s,r,a,l,u,c;const d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,g=this.origin;return d>=0?(s=(t.min.x-g.x)*d,r=(t.max.x-g.x)*d):(s=(t.max.x-g.x)*d,r=(t.min.x-g.x)*d),f>=0?(a=(t.min.y-g.y)*f,l=(t.max.y-g.y)*f):(a=(t.max.y-g.y)*f,l=(t.min.y-g.y)*f),s>l||a>r||((a>s||isNaN(s))&&(s=a),(l<r||isNaN(r))&&(r=l),m>=0?(u=(t.min.z-g.z)*m,c=(t.max.z-g.z)*m):(u=(t.max.z-g.z)*m,c=(t.min.z-g.z)*m),s>c||u>r)||((u>s||s!==s)&&(s=u),(c<r||r!==r)&&(r=c),r<0)?null:this.at(s>=0?s:r,e)}intersectsBox(t){return this.intersectBox(t,Zs)!==null}intersectTriangle(t,e,s,r,a){fd.subVectors(e,t),Kl.subVectors(s,t),pd.crossVectors(fd,Kl);let l=this.direction.dot(pd),u;if(l>0){if(r)return null;u=1}else if(l<0)u=-1,l=-l;else return null;Mn.subVectors(this.origin,t);const c=u*this.direction.dot(Kl.crossVectors(Mn,Kl));if(c<0)return null;const d=u*this.direction.dot(fd.cross(Mn));if(d<0||c+d>l)return null;const f=-u*Mn.dot(pd);return f<0?null:this.at(f/l,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Me{constructor(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E){Me.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E)}set(t,e,s,r,a,l,u,c,d,f,m,g,v,x,b,E){const S=this.elements;return S[0]=t,S[4]=e,S[8]=s,S[12]=r,S[1]=a,S[5]=l,S[9]=u,S[13]=c,S[2]=d,S[6]=f,S[10]=m,S[14]=g,S[3]=v,S[7]=x,S[11]=b,S[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Me().fromArray(this.elements)}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],this}copyPosition(t){const e=this.elements,s=t.elements;return e[12]=s[12],e[13]=s[13],e[14]=s[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,s){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(t,e,s){return this.set(t.x,e.x,s.x,0,t.y,e.y,s.y,0,t.z,e.z,s.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,s=t.elements,r=1/Jr.setFromMatrixColumn(t,0).length(),a=1/Jr.setFromMatrixColumn(t,1).length(),l=1/Jr.setFromMatrixColumn(t,2).length();return e[0]=s[0]*r,e[1]=s[1]*r,e[2]=s[2]*r,e[3]=0,e[4]=s[4]*a,e[5]=s[5]*a,e[6]=s[6]*a,e[7]=0,e[8]=s[8]*l,e[9]=s[9]*l,e[10]=s[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,s=t.x,r=t.y,a=t.z,l=Math.cos(s),u=Math.sin(s),c=Math.cos(r),d=Math.sin(r),f=Math.cos(a),m=Math.sin(a);if(t.order==="XYZ"){const g=l*f,v=l*m,x=u*f,b=u*m;e[0]=c*f,e[4]=-c*m,e[8]=d,e[1]=v+x*d,e[5]=g-b*d,e[9]=-u*c,e[2]=b-g*d,e[6]=x+v*d,e[10]=l*c}else if(t.order==="YXZ"){const g=c*f,v=c*m,x=d*f,b=d*m;e[0]=g+b*u,e[4]=x*u-v,e[8]=l*d,e[1]=l*m,e[5]=l*f,e[9]=-u,e[2]=v*u-x,e[6]=b+g*u,e[10]=l*c}else if(t.order==="ZXY"){const g=c*f,v=c*m,x=d*f,b=d*m;e[0]=g-b*u,e[4]=-l*m,e[8]=x+v*u,e[1]=v+x*u,e[5]=l*f,e[9]=b-g*u,e[2]=-l*d,e[6]=u,e[10]=l*c}else if(t.order==="ZYX"){const g=l*f,v=l*m,x=u*f,b=u*m;e[0]=c*f,e[4]=x*d-v,e[8]=g*d+b,e[1]=c*m,e[5]=b*d+g,e[9]=v*d-x,e[2]=-d,e[6]=u*c,e[10]=l*c}else if(t.order==="YZX"){const g=l*c,v=l*d,x=u*c,b=u*d;e[0]=c*f,e[4]=b-g*m,e[8]=x*m+v,e[1]=m,e[5]=l*f,e[9]=-u*f,e[2]=-d*f,e[6]=v*m+x,e[10]=g-b*m}else if(t.order==="XZY"){const g=l*c,v=l*d,x=u*c,b=u*d;e[0]=c*f,e[4]=-m,e[8]=d*f,e[1]=g*m+b,e[5]=l*f,e[9]=v*m-x,e[2]=x*m-v,e[6]=u*f,e[10]=b*m+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(w5,t,_5)}lookAt(t,e,s){const r=this.elements;return ci.subVectors(t,e),ci.lengthSq()===0&&(ci.z=1),ci.normalize(),En.crossVectors(s,ci),En.lengthSq()===0&&(Math.abs(s.z)===1?ci.x+=1e-4:ci.z+=1e-4,ci.normalize(),En.crossVectors(s,ci)),En.normalize(),th.crossVectors(ci,En),r[0]=En.x,r[4]=th.x,r[8]=ci.x,r[1]=En.y,r[5]=th.y,r[9]=ci.y,r[2]=En.z,r[6]=th.z,r[10]=ci.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const s=t.elements,r=e.elements,a=this.elements,l=s[0],u=s[4],c=s[8],d=s[12],f=s[1],m=s[5],g=s[9],v=s[13],x=s[2],b=s[6],E=s[10],S=s[14],z=s[3],I=s[7],O=s[11],P=s[15],G=r[0],$=r[4],_t=r[8],zt=r[12],j=r[1],lt=r[5],ut=r[9],ht=r[13],Ft=r[2],tt=r[6],Lt=r[10],V=r[14],J=r[3],pt=r[7],mt=r[11],Tt=r[15];return a[0]=l*G+u*j+c*Ft+d*J,a[4]=l*$+u*lt+c*tt+d*pt,a[8]=l*_t+u*ut+c*Lt+d*mt,a[12]=l*zt+u*ht+c*V+d*Tt,a[1]=f*G+m*j+g*Ft+v*J,a[5]=f*$+m*lt+g*tt+v*pt,a[9]=f*_t+m*ut+g*Lt+v*mt,a[13]=f*zt+m*ht+g*V+v*Tt,a[2]=x*G+b*j+E*Ft+S*J,a[6]=x*$+b*lt+E*tt+S*pt,a[10]=x*_t+b*ut+E*Lt+S*mt,a[14]=x*zt+b*ht+E*V+S*Tt,a[3]=z*G+I*j+O*Ft+P*J,a[7]=z*$+I*lt+O*tt+P*pt,a[11]=z*_t+I*ut+O*Lt+P*mt,a[15]=z*zt+I*ht+O*V+P*Tt,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],s=t[4],r=t[8],a=t[12],l=t[1],u=t[5],c=t[9],d=t[13],f=t[2],m=t[6],g=t[10],v=t[14],x=t[3],b=t[7],E=t[11],S=t[15];return x*(+a*c*m-r*d*m-a*u*g+s*d*g+r*u*v-s*c*v)+b*(+e*c*v-e*d*g+a*l*g-r*l*v+r*d*f-a*c*f)+E*(+e*d*m-e*u*v-a*l*m+s*l*v+a*u*f-s*d*f)+S*(-r*u*f-e*c*m+e*u*g+r*l*m-s*l*g+s*c*f)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,s){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=s),this}invert(){const t=this.elements,e=t[0],s=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=t[6],d=t[7],f=t[8],m=t[9],g=t[10],v=t[11],x=t[12],b=t[13],E=t[14],S=t[15],z=m*E*d-b*g*d+b*c*v-u*E*v-m*c*S+u*g*S,I=x*g*d-f*E*d-x*c*v+l*E*v+f*c*S-l*g*S,O=f*b*d-x*m*d+x*u*v-l*b*v-f*u*S+l*m*S,P=x*m*c-f*b*c-x*u*g+l*b*g+f*u*E-l*m*E,G=e*z+s*I+r*O+a*P;if(G===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const $=1/G;return t[0]=z*$,t[1]=(b*g*a-m*E*a-b*r*v+s*E*v+m*r*S-s*g*S)*$,t[2]=(u*E*a-b*c*a+b*r*d-s*E*d-u*r*S+s*c*S)*$,t[3]=(m*c*a-u*g*a-m*r*d+s*g*d+u*r*v-s*c*v)*$,t[4]=I*$,t[5]=(f*E*a-x*g*a+x*r*v-e*E*v-f*r*S+e*g*S)*$,t[6]=(x*c*a-l*E*a-x*r*d+e*E*d+l*r*S-e*c*S)*$,t[7]=(l*g*a-f*c*a+f*r*d-e*g*d-l*r*v+e*c*v)*$,t[8]=O*$,t[9]=(x*m*a-f*b*a-x*s*v+e*b*v+f*s*S-e*m*S)*$,t[10]=(l*b*a-x*u*a+x*s*d-e*b*d-l*s*S+e*u*S)*$,t[11]=(f*u*a-l*m*a-f*s*d+e*m*d+l*s*v-e*u*v)*$,t[12]=P*$,t[13]=(f*b*r-x*m*r+x*s*g-e*b*g-f*s*E+e*m*E)*$,t[14]=(x*u*r-l*b*r-x*s*c+e*b*c+l*s*E-e*u*E)*$,t[15]=(l*m*r-f*u*r+f*s*c-e*m*c-l*s*g+e*u*g)*$,this}scale(t){const e=this.elements,s=t.x,r=t.y,a=t.z;return e[0]*=s,e[4]*=r,e[8]*=a,e[1]*=s,e[5]*=r,e[9]*=a,e[2]*=s,e[6]*=r,e[10]*=a,e[3]*=s,e[7]*=r,e[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],s=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,s,r))}makeTranslation(t,e,s){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,s,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),s=Math.sin(t);return this.set(1,0,0,0,0,e,-s,0,0,s,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,0,s,0,0,1,0,0,-s,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),s=Math.sin(t);return this.set(e,-s,0,0,s,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const s=Math.cos(e),r=Math.sin(e),a=1-s,l=t.x,u=t.y,c=t.z,d=a*l,f=a*u;return this.set(d*l+s,d*u-r*c,d*c+r*u,0,d*u+r*c,f*u+s,f*c-r*l,0,d*c-r*u,f*c+r*l,a*c*c+s,0,0,0,0,1),this}makeScale(t,e,s){return this.set(t,0,0,0,0,e,0,0,0,0,s,0,0,0,0,1),this}makeShear(t,e,s,r,a,l){return this.set(1,s,a,0,t,1,l,0,e,r,1,0,0,0,0,1),this}compose(t,e,s){const r=this.elements,a=e._x,l=e._y,u=e._z,c=e._w,d=a+a,f=l+l,m=u+u,g=a*d,v=a*f,x=a*m,b=l*f,E=l*m,S=u*m,z=c*d,I=c*f,O=c*m,P=s.x,G=s.y,$=s.z;return r[0]=(1-(b+S))*P,r[1]=(v+O)*P,r[2]=(x-I)*P,r[3]=0,r[4]=(v-O)*G,r[5]=(1-(g+S))*G,r[6]=(E+z)*G,r[7]=0,r[8]=(x+I)*$,r[9]=(E-z)*$,r[10]=(1-(g+b))*$,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,s){const r=this.elements;let a=Jr.set(r[0],r[1],r[2]).length();const l=Jr.set(r[4],r[5],r[6]).length(),u=Jr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),t.x=r[12],t.y=r[13],t.z=r[14],ji.copy(this);const d=1/a,f=1/l,m=1/u;return ji.elements[0]*=d,ji.elements[1]*=d,ji.elements[2]*=d,ji.elements[4]*=f,ji.elements[5]*=f,ji.elements[6]*=f,ji.elements[8]*=m,ji.elements[9]*=m,ji.elements[10]*=m,e.setFromRotationMatrix(ji),s.x=a,s.y=l,s.z=u,this}makePerspective(t,e,s,r,a,l,u=ha){const c=this.elements,d=2*a/(e-t),f=2*a/(s-r),m=(e+t)/(e-t),g=(s+r)/(s-r);let v,x;if(u===ha)v=-(l+a)/(l-a),x=-2*l*a/(l-a);else if(u===R0)v=-l/(l-a),x=-l*a/(l-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);return c[0]=d,c[4]=0,c[8]=m,c[12]=0,c[1]=0,c[5]=f,c[9]=g,c[13]=0,c[2]=0,c[6]=0,c[10]=v,c[14]=x,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(t,e,s,r,a,l,u=ha){const c=this.elements,d=1/(e-t),f=1/(s-r),m=1/(l-a),g=(e+t)*d,v=(s+r)*f;let x,b;if(u===ha)x=(l+a)*m,b=-2*m;else if(u===R0)x=a*m,b=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);return c[0]=2*d,c[4]=0,c[8]=0,c[12]=-g,c[1]=0,c[5]=2*f,c[9]=0,c[13]=-v,c[2]=0,c[6]=0,c[10]=b,c[14]=-x,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(t){const e=this.elements,s=t.elements;for(let r=0;r<16;r++)if(e[r]!==s[r])return!1;return!0}fromArray(t,e=0){for(let s=0;s<16;s++)this.elements[s]=t[s+e];return this}toArray(t=[],e=0){const s=this.elements;return t[e]=s[0],t[e+1]=s[1],t[e+2]=s[2],t[e+3]=s[3],t[e+4]=s[4],t[e+5]=s[5],t[e+6]=s[6],t[e+7]=s[7],t[e+8]=s[8],t[e+9]=s[9],t[e+10]=s[10],t[e+11]=s[11],t[e+12]=s[12],t[e+13]=s[13],t[e+14]=s[14],t[e+15]=s[15],t}}const Jr=new U,ji=new Me,w5=new U(0,0,0),_5=new U(1,1,1),En=new U,th=new U,ci=new U,U0=new Me,D0=new Mo;class za{constructor(t=0,e=0,s=0,r=za.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=s,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,s,r=this._order){return this._x=t,this._y=e,this._z=s,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,s=!0){const r=t.elements,a=r[0],l=r[4],u=r[8],c=r[1],d=r[5],f=r[9],m=r[2],g=r[6],v=r[10];switch(e){case"XYZ":this._y=Math.asin(De(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-l,a)):(this._x=Math.atan2(g,d),this._z=0);break;case"YXZ":this._x=Math.asin(-De(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(u,v),this._z=Math.atan2(c,d)):(this._y=Math.atan2(-m,a),this._z=0);break;case"ZXY":this._x=Math.asin(De(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-m,v),this._z=Math.atan2(-l,d)):(this._y=0,this._z=Math.atan2(c,a));break;case"ZYX":this._y=Math.asin(-De(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(g,v),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-l,d));break;case"YZX":this._z=Math.asin(De(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,d),this._y=Math.atan2(-m,a)):(this._x=0,this._y=Math.atan2(u,v));break;case"XZY":this._z=Math.asin(-De(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(g,d),this._y=Math.atan2(u,a)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,s===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,s){return U0.makeRotationFromQuaternion(t),this.setFromRotationMatrix(U0,e,s)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return D0.setFromEuler(this),this.setFromQuaternion(D0,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}za.DEFAULT_ORDER="XYZ";class b5{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let M5=0;const V0=new U,Kr=new Mo,Xs=new Me,eh=new U,ia=new U,E5=new U,S5=new Mo,H0=new U(1,0,0),W0=new U(0,1,0),q0=new U(0,0,1),A5={type:"added"},G0={type:"removed"};class _s extends nu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:M5++}),this.uuid=bo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=_s.DEFAULT_UP.clone();const t=new U,e=new za,s=new Mo,r=new U(1,1,1);function a(){s.setFromEuler(e,!1)}function l(){e.setFromQuaternion(s,void 0,!1)}e._onChange(a),s._onChange(l),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Me},normalMatrix:{value:new Pn}}),this.matrix=new Me,this.matrixWorld=new Me,this.matrixAutoUpdate=_s.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=_s.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new b5,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Kr.setFromAxisAngle(t,e),this.quaternion.multiply(Kr),this}rotateOnWorldAxis(t,e){return Kr.setFromAxisAngle(t,e),this.quaternion.premultiply(Kr),this}rotateX(t){return this.rotateOnAxis(H0,t)}rotateY(t){return this.rotateOnAxis(W0,t)}rotateZ(t){return this.rotateOnAxis(q0,t)}translateOnAxis(t,e){return V0.copy(t).applyQuaternion(this.quaternion),this.position.add(V0.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(H0,t)}translateY(t){return this.translateOnAxis(W0,t)}translateZ(t){return this.translateOnAxis(q0,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Xs.copy(this.matrixWorld).invert())}lookAt(t,e,s){t.isVector3?eh.copy(t):eh.set(t,e,s);const r=this.parent;this.updateWorldMatrix(!0,!1),ia.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xs.lookAt(ia,eh,this.up):Xs.lookAt(eh,ia,this.up),this.quaternion.setFromRotationMatrix(Xs),r&&(Xs.extractRotation(r.matrixWorld),Kr.setFromRotationMatrix(Xs),this.quaternion.premultiply(Kr.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(A5)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(G0)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(G0)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Xs.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Xs.multiply(t.parent.matrixWorld)),t.applyMatrix4(Xs),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let s=0,r=this.children.length;s<r;s++){const l=this.children[s].getObjectByProperty(t,e);if(l!==void 0)return l}}getObjectsByProperty(t,e){let s=[];this[t]===e&&s.push(this);for(let r=0,a=this.children.length;r<a;r++){const l=this.children[r].getObjectsByProperty(t,e);l.length>0&&(s=s.concat(l))}return s}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ia,t,E5),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ia,S5,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let s=0,r=e.length;s<r;s++)e[s].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let s=0,r=e.length;s<r;s++)e[s].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let s=0,r=e.length;s<r;s++){const a=e[s];(a.matrixWorldAutoUpdate===!0||t===!0)&&a.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const s=this.parent;if(t===!0&&s!==null&&s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const r=this.children;for(let a=0,l=r.length;a<l;a++){const u=r[a];u.matrixWorldAutoUpdate===!0&&u.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=t===void 0||typeof t=="string",s={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function a(u,c){return u[c.uuid]===void 0&&(u[c.uuid]=c.toJSON(t)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(t.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const c=u.shapes;if(Array.isArray(c))for(let d=0,f=c.length;d<f;d++){const m=c[d];a(t.shapes,m)}else a(t.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let c=0,d=this.material.length;c<d;c++)u.push(a(t.materials,this.material[c]));r.material=u}else r.material=a(t.materials,this.material);if(this.children.length>0){r.children=[];for(let u=0;u<this.children.length;u++)r.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let u=0;u<this.animations.length;u++){const c=this.animations[u];r.animations.push(a(t.animations,c))}}if(e){const u=l(t.geometries),c=l(t.materials),d=l(t.textures),f=l(t.images),m=l(t.shapes),g=l(t.skeletons),v=l(t.animations),x=l(t.nodes);u.length>0&&(s.geometries=u),c.length>0&&(s.materials=c),d.length>0&&(s.textures=d),f.length>0&&(s.images=f),m.length>0&&(s.shapes=m),g.length>0&&(s.skeletons=g),v.length>0&&(s.animations=v),x.length>0&&(s.nodes=x)}return s.object=r,s;function l(u){const c=[];for(const d in u){const f=u[d];delete f.metadata,c.push(f)}return c}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let s=0;s<t.children.length;s++){const r=t.children[s];this.add(r.clone())}return this}}_s.DEFAULT_UP=new U(0,1,0);_s.DEFAULT_MATRIX_AUTO_UPDATE=!0;_s.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Zi=new U,Qs=new U,md=new U,Js=new U,to=new U,eo=new U,Y0=new U,gd=new U,vd=new U,yd=new U;let ih=!1;class Ji{constructor(t=new U,e=new U,s=new U){this.a=t,this.b=e,this.c=s}static getNormal(t,e,s,r){r.subVectors(s,e),Zi.subVectors(t,e),r.cross(Zi);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(t,e,s,r,a){Zi.subVectors(r,e),Qs.subVectors(s,e),md.subVectors(t,e);const l=Zi.dot(Zi),u=Zi.dot(Qs),c=Zi.dot(md),d=Qs.dot(Qs),f=Qs.dot(md),m=l*d-u*u;if(m===0)return a.set(-2,-1,-1);const g=1/m,v=(d*c-u*f)*g,x=(l*f-u*c)*g;return a.set(1-v-x,x,v)}static containsPoint(t,e,s,r){return this.getBarycoord(t,e,s,r,Js),Js.x>=0&&Js.y>=0&&Js.x+Js.y<=1}static getUV(t,e,s,r,a,l,u,c){return ih===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),ih=!0),this.getInterpolation(t,e,s,r,a,l,u,c)}static getInterpolation(t,e,s,r,a,l,u,c){return this.getBarycoord(t,e,s,r,Js),c.setScalar(0),c.addScaledVector(a,Js.x),c.addScaledVector(l,Js.y),c.addScaledVector(u,Js.z),c}static isFrontFacing(t,e,s,r){return Zi.subVectors(s,e),Qs.subVectors(t,e),Zi.cross(Qs).dot(r)<0}set(t,e,s){return this.a.copy(t),this.b.copy(e),this.c.copy(s),this}setFromPointsAndIndices(t,e,s,r){return this.a.copy(t[e]),this.b.copy(t[s]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,s,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,s),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Zi.subVectors(this.c,this.b),Qs.subVectors(this.a,this.b),Zi.cross(Qs).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ji.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ji.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,s,r,a){return ih===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),ih=!0),Ji.getInterpolation(t,this.a,this.b,this.c,e,s,r,a)}getInterpolation(t,e,s,r,a){return Ji.getInterpolation(t,this.a,this.b,this.c,e,s,r,a)}containsPoint(t){return Ji.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ji.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const s=this.a,r=this.b,a=this.c;let l,u;to.subVectors(r,s),eo.subVectors(a,s),gd.subVectors(t,s);const c=to.dot(gd),d=eo.dot(gd);if(c<=0&&d<=0)return e.copy(s);vd.subVectors(t,r);const f=to.dot(vd),m=eo.dot(vd);if(f>=0&&m<=f)return e.copy(r);const g=c*m-f*d;if(g<=0&&c>=0&&f<=0)return l=c/(c-f),e.copy(s).addScaledVector(to,l);yd.subVectors(t,a);const v=to.dot(yd),x=eo.dot(yd);if(x>=0&&v<=x)return e.copy(a);const b=v*d-c*x;if(b<=0&&d>=0&&x<=0)return u=d/(d-x),e.copy(s).addScaledVector(eo,u);const E=f*x-v*m;if(E<=0&&m-f>=0&&v-x>=0)return Y0.subVectors(a,r),u=(m-f)/(m-f+(v-x)),e.copy(r).addScaledVector(Y0,u);const S=1/(E+b+g);return l=b*S,u=g*S,e.copy(s).addScaledVector(to,l).addScaledVector(eo,u)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let k5=0;class I1 extends nu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:k5++}),this.uuid=bo(),this.name="",this.type="Material",this.blending=O0,this.side=Od,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=R4,this.blendDst=F4,this.blendEquation=P4,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=$4,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=W4,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=nd,this.stencilZFail=nd,this.stencilZPass=nd,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const s=t[e];if(s===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const r=this[e];if(r===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(s):r&&r.isVector3&&s&&s.isVector3?r.copy(s):this[e]=s}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const s={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(s.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(s.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(s.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(t).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(t).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(t).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(t).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(t).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==O0&&(s.blending=this.blending),this.side!==Od&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.colorWrite=this.colorWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(s.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(s.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(s.wireframe=this.wireframe),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=this.flatShading),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function r(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}if(e){const a=r(t.textures),l=r(t.images);a.length>0&&(s.textures=a),l.length>0&&(s.images=l)}return s}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let s=null;if(e!==null){const r=e.length;s=new Array(r);for(let a=0;a!==r;++a)s[a]=e[a].clone()}return this.clippingPlanes=s,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}const L1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xi={h:0,s:0,l:0},sh={h:0,s:0,l:0};function xd(i,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?i+(t-i)*6*e:e<1/2?t:e<2/3?i+(t-i)*6*(2/3-e):i}class nf{constructor(t,e,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,s)}set(t,e,s){if(e===void 0&&s===void 0){const r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,e,s);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Ri){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Ti.toWorkingColorSpace(this,e),this}setRGB(t,e,s,r=Ti.workingColorSpace){return this.r=t,this.g=e,this.b=s,Ti.toWorkingColorSpace(this,r),this}setHSL(t,e,s,r=Ti.workingColorSpace){if(t=sf(t,1),e=De(e,0,1),s=De(s,0,1),e===0)this.r=this.g=this.b=s;else{const a=s<=.5?s*(1+e):s+e-s*e,l=2*s-a;this.r=xd(l,a,t+1/3),this.g=xd(l,a,t),this.b=xd(l,a,t-1/3)}return Ti.toWorkingColorSpace(this,r),this}setStyle(t,e=Ri){function s(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const l=r[1],u=r[2];switch(l){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,e);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,e);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return s(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=r[1],l=a.length;if(l===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,e);if(l===6)return this.setHex(parseInt(a,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Ri){const s=L1[t.toLowerCase()];return s!==void 0?this.setHex(s,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=vo(t.r),this.g=vo(t.g),this.b=vo(t.b),this}copyLinearToSRGB(t){return this.r=ad(t.r),this.g=ad(t.g),this.b=ad(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Ri){return Ti.fromWorkingColorSpace(Te.copy(this),t),Math.round(De(Te.r*255,0,255))*65536+Math.round(De(Te.g*255,0,255))*256+Math.round(De(Te.b*255,0,255))}getHexString(t=Ri){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Ti.workingColorSpace){Ti.fromWorkingColorSpace(Te.copy(this),e);const s=Te.r,r=Te.g,a=Te.b,l=Math.max(s,r,a),u=Math.min(s,r,a);let c,d;const f=(u+l)/2;if(u===l)c=0,d=0;else{const m=l-u;switch(d=f<=.5?m/(l+u):m/(2-l-u),l){case s:c=(r-a)/m+(r<a?6:0);break;case r:c=(a-s)/m+2;break;case a:c=(s-r)/m+4;break}c/=6}return t.h=c,t.s=d,t.l=f,t}getRGB(t,e=Ti.workingColorSpace){return Ti.fromWorkingColorSpace(Te.copy(this),e),t.r=Te.r,t.g=Te.g,t.b=Te.b,t}getStyle(t=Ri){Ti.fromWorkingColorSpace(Te.copy(this),t);const e=Te.r,s=Te.g,r=Te.b;return t!==Ri?`color(${t} ${e.toFixed(3)} ${s.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(s*255)},${Math.round(r*255)})`}offsetHSL(t,e,s){return this.getHSL(Xi),Xi.h+=t,Xi.s+=e,Xi.l+=s,this.setHSL(Xi.h,Xi.s,Xi.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,s){return this.r=t.r+(e.r-t.r)*s,this.g=t.g+(e.g-t.g)*s,this.b=t.b+(e.b-t.b)*s,this}lerpHSL(t,e){this.getHSL(Xi),t.getHSL(sh);const s=ma(Xi.h,sh.h,e),r=ma(Xi.s,sh.s,e),a=ma(Xi.l,sh.l,e);return this.setHSL(s,r,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,s=this.g,r=this.b,a=t.elements;return this.r=a[0]*e+a[3]*s+a[6]*r,this.g=a[1]*e+a[4]*s+a[7]*r,this.b=a[2]*e+a[5]*s+a[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Te=new nf;nf.NAMES=L1;class C5 extends I1{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nf(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=B4,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const ae=new U,nh=new Le;class yo{constructor(t,e,s=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=s,this.usage=P0,this.updateRange={offset:0,count:-1},this.gpuType=D4,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,s){t*=this.itemSize,s*=e.itemSize;for(let r=0,a=this.itemSize;r<a;r++)this.array[t+r]=e.array[s+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,s=this.count;e<s;e++)nh.fromBufferAttribute(this,e),nh.applyMatrix3(t),this.setXY(e,nh.x,nh.y);else if(this.itemSize===3)for(let e=0,s=this.count;e<s;e++)ae.fromBufferAttribute(this,e),ae.applyMatrix3(t),this.setXYZ(e,ae.x,ae.y,ae.z);return this}applyMatrix4(t){for(let e=0,s=this.count;e<s;e++)ae.fromBufferAttribute(this,e),ae.applyMatrix4(t),this.setXYZ(e,ae.x,ae.y,ae.z);return this}applyNormalMatrix(t){for(let e=0,s=this.count;e<s;e++)ae.fromBufferAttribute(this,e),ae.applyNormalMatrix(t),this.setXYZ(e,ae.x,ae.y,ae.z);return this}transformDirection(t){for(let e=0,s=this.count;e<s;e++)ae.fromBufferAttribute(this,e),ae.transformDirection(t),this.setXYZ(e,ae.x,ae.y,ae.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ua(e,this.array)),e}setX(t,e){return this.normalized&&(e=Je(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ua(e,this.array)),e}setY(t,e){return this.normalized&&(e=Je(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ua(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Je(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ua(e,this.array)),e}setW(t,e){return this.normalized&&(e=Je(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,s){return t*=this.itemSize,this.normalized&&(e=Je(e,this.array),s=Je(s,this.array)),this.array[t+0]=e,this.array[t+1]=s,this}setXYZ(t,e,s,r){return t*=this.itemSize,this.normalized&&(e=Je(e,this.array),s=Je(s,this.array),r=Je(r,this.array)),this.array[t+0]=e,this.array[t+1]=s,this.array[t+2]=r,this}setXYZW(t,e,s,r,a){return t*=this.itemSize,this.normalized&&(e=Je(e,this.array),s=Je(s,this.array),r=Je(r,this.array),a=Je(a,this.array)),this.array[t+0]=e,this.array[t+1]=s,this.array[t+2]=r,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==P0&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class z5 extends yo{constructor(t,e,s){super(new Uint16Array(t),e,s)}}class T5 extends yo{constructor(t,e,s){super(new Uint32Array(t),e,s)}}class Eh extends yo{constructor(t,e,s){super(new Float32Array(t),e,s)}}let O5=0;const ki=new Me,wd=new _s,io=new U,di=new Ca,sa=new Ca,ge=new U;class ru extends nu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:O5++}),this.uuid=bo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(a5(t)?T5:z5)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,s=0){this.groups.push({start:t,count:e,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const a=new Pn().getNormalMatrix(t);s.applyNormalMatrix(a),s.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return ki.makeRotationFromQuaternion(t),this.applyMatrix4(ki),this}rotateX(t){return ki.makeRotationX(t),this.applyMatrix4(ki),this}rotateY(t){return ki.makeRotationY(t),this.applyMatrix4(ki),this}rotateZ(t){return ki.makeRotationZ(t),this.applyMatrix4(ki),this}translate(t,e,s){return ki.makeTranslation(t,e,s),this.applyMatrix4(ki),this}scale(t,e,s){return ki.makeScale(t,e,s),this.applyMatrix4(ki),this}lookAt(t){return wd.lookAt(t),wd.updateMatrix(),this.applyMatrix4(wd.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(io).negate(),this.translate(io.x,io.y,io.z),this}setFromPoints(t){const e=[];for(let s=0,r=t.length;s<r;s++){const a=t[s];e.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Eh(e,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ca);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let s=0,r=e.length;s<r;s++){const a=e[s];di.setFromBufferAttribute(a),this.morphTargetsRelative?(ge.addVectors(this.boundingBox.min,di.min),this.boundingBox.expandByPoint(ge),ge.addVectors(this.boundingBox.max,di.max),this.boundingBox.expandByPoint(ge)):(this.boundingBox.expandByPoint(di.min),this.boundingBox.expandByPoint(di.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new O1);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new U,1/0);return}if(t){const s=this.boundingSphere.center;if(di.setFromBufferAttribute(t),e)for(let a=0,l=e.length;a<l;a++){const u=e[a];sa.setFromBufferAttribute(u),this.morphTargetsRelative?(ge.addVectors(di.min,sa.min),di.expandByPoint(ge),ge.addVectors(di.max,sa.max),di.expandByPoint(ge)):(di.expandByPoint(sa.min),di.expandByPoint(sa.max))}di.getCenter(s);let r=0;for(let a=0,l=t.count;a<l;a++)ge.fromBufferAttribute(t,a),r=Math.max(r,s.distanceToSquared(ge));if(e)for(let a=0,l=e.length;a<l;a++){const u=e[a],c=this.morphTargetsRelative;for(let d=0,f=u.count;d<f;d++)ge.fromBufferAttribute(u,d),c&&(io.fromBufferAttribute(t,d),ge.add(io)),r=Math.max(r,s.distanceToSquared(ge))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=t.array,r=e.position.array,a=e.normal.array,l=e.uv.array,u=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new yo(new Float32Array(4*u),4));const c=this.getAttribute("tangent").array,d=[],f=[];for(let j=0;j<u;j++)d[j]=new U,f[j]=new U;const m=new U,g=new U,v=new U,x=new Le,b=new Le,E=new Le,S=new U,z=new U;function I(j,lt,ut){m.fromArray(r,j*3),g.fromArray(r,lt*3),v.fromArray(r,ut*3),x.fromArray(l,j*2),b.fromArray(l,lt*2),E.fromArray(l,ut*2),g.sub(m),v.sub(m),b.sub(x),E.sub(x);const ht=1/(b.x*E.y-E.x*b.y);!isFinite(ht)||(S.copy(g).multiplyScalar(E.y).addScaledVector(v,-b.y).multiplyScalar(ht),z.copy(v).multiplyScalar(b.x).addScaledVector(g,-E.x).multiplyScalar(ht),d[j].add(S),d[lt].add(S),d[ut].add(S),f[j].add(z),f[lt].add(z),f[ut].add(z))}let O=this.groups;O.length===0&&(O=[{start:0,count:s.length}]);for(let j=0,lt=O.length;j<lt;++j){const ut=O[j],ht=ut.start,Ft=ut.count;for(let tt=ht,Lt=ht+Ft;tt<Lt;tt+=3)I(s[tt+0],s[tt+1],s[tt+2])}const P=new U,G=new U,$=new U,_t=new U;function zt(j){$.fromArray(a,j*3),_t.copy($);const lt=d[j];P.copy(lt),P.sub($.multiplyScalar($.dot(lt))).normalize(),G.crossVectors(_t,lt);const ht=G.dot(f[j])<0?-1:1;c[j*4]=P.x,c[j*4+1]=P.y,c[j*4+2]=P.z,c[j*4+3]=ht}for(let j=0,lt=O.length;j<lt;++j){const ut=O[j],ht=ut.start,Ft=ut.count;for(let tt=ht,Lt=ht+Ft;tt<Lt;tt+=3)zt(s[tt+0]),zt(s[tt+1]),zt(s[tt+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new yo(new Float32Array(e.count*3),3),this.setAttribute("normal",s);else for(let g=0,v=s.count;g<v;g++)s.setXYZ(g,0,0,0);const r=new U,a=new U,l=new U,u=new U,c=new U,d=new U,f=new U,m=new U;if(t)for(let g=0,v=t.count;g<v;g+=3){const x=t.getX(g+0),b=t.getX(g+1),E=t.getX(g+2);r.fromBufferAttribute(e,x),a.fromBufferAttribute(e,b),l.fromBufferAttribute(e,E),f.subVectors(l,a),m.subVectors(r,a),f.cross(m),u.fromBufferAttribute(s,x),c.fromBufferAttribute(s,b),d.fromBufferAttribute(s,E),u.add(f),c.add(f),d.add(f),s.setXYZ(x,u.x,u.y,u.z),s.setXYZ(b,c.x,c.y,c.z),s.setXYZ(E,d.x,d.y,d.z)}else for(let g=0,v=e.count;g<v;g+=3)r.fromBufferAttribute(e,g+0),a.fromBufferAttribute(e,g+1),l.fromBufferAttribute(e,g+2),f.subVectors(l,a),m.subVectors(r,a),f.cross(m),s.setXYZ(g+0,f.x,f.y,f.z),s.setXYZ(g+1,f.x,f.y,f.z),s.setXYZ(g+2,f.x,f.y,f.z);this.normalizeNormals(),s.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,s=t.count;e<s;e++)ge.fromBufferAttribute(t,e),ge.normalize(),t.setXYZ(e,ge.x,ge.y,ge.z)}toNonIndexed(){function t(u,c){const d=u.array,f=u.itemSize,m=u.normalized,g=new d.constructor(c.length*f);let v=0,x=0;for(let b=0,E=c.length;b<E;b++){u.isInterleavedBufferAttribute?v=c[b]*u.data.stride+u.offset:v=c[b]*f;for(let S=0;S<f;S++)g[x++]=d[v++]}return new yo(g,f,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new ru,s=this.index.array,r=this.attributes;for(const u in r){const c=r[u],d=t(c,s);e.setAttribute(u,d)}const a=this.morphAttributes;for(const u in a){const c=[],d=a[u];for(let f=0,m=d.length;f<m;f++){const g=d[f],v=t(g,s);c.push(v)}e.morphAttributes[u]=c}e.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let u=0,c=l.length;u<c;u++){const d=l[u];e.addGroup(d.start,d.count,d.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const d in c)c[d]!==void 0&&(t[d]=c[d]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const s=this.attributes;for(const c in s){const d=s[c];t.data.attributes[c]=d.toJSON(t.data)}const r={};let a=!1;for(const c in this.morphAttributes){const d=this.morphAttributes[c],f=[];for(let m=0,g=d.length;m<g;m++){const v=d[m];f.push(v.toJSON(t.data))}f.length>0&&(r[c]=f,a=!0)}a&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(t.data.groups=JSON.parse(JSON.stringify(l)));const u=this.boundingSphere;return u!==null&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const s=t.index;s!==null&&this.setIndex(s.clone(e));const r=t.attributes;for(const d in r){const f=r[d];this.setAttribute(d,f.clone(e))}const a=t.morphAttributes;for(const d in a){const f=[],m=a[d];for(let g=0,v=m.length;g<v;g++)f.push(m[g].clone(e));this.morphAttributes[d]=f}this.morphTargetsRelative=t.morphTargetsRelative;const l=t.groups;for(let d=0,f=l.length;d<f;d++){const m=l[d];this.addGroup(m.start,m.count,m.materialIndex)}const u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());const c=t.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const j0=new Me,ir=new x5,rh=new O1,Z0=new U,so=new U,no=new U,ro=new U,_d=new U,oh=new U,ah=new Le,lh=new Le,hh=new Le,X0=new U,Q0=new U,J0=new U,uh=new U,ch=new U;class I5 extends _s{constructor(t=new ru,e=new C5){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,s=Object.keys(e);if(s.length>0){const r=e[s[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,l=r.length;a<l;a++){const u=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=a}}}}getVertexPosition(t,e){const s=this.geometry,r=s.attributes.position,a=s.morphAttributes.position,l=s.morphTargetsRelative;e.fromBufferAttribute(r,t);const u=this.morphTargetInfluences;if(a&&u){oh.set(0,0,0);for(let c=0,d=a.length;c<d;c++){const f=u[c],m=a[c];f!==0&&(_d.fromBufferAttribute(m,t),l?oh.addScaledVector(_d,f):oh.addScaledVector(_d.sub(e),f))}e.add(oh)}return e}raycast(t,e){const s=this.geometry,r=this.material,a=this.matrixWorld;r!==void 0&&(s.boundingSphere===null&&s.computeBoundingSphere(),rh.copy(s.boundingSphere),rh.applyMatrix4(a),ir.copy(t.ray).recast(t.near),!(rh.containsPoint(ir.origin)===!1&&(ir.intersectSphere(rh,Z0)===null||ir.origin.distanceToSquared(Z0)>(t.far-t.near)**2))&&(j0.copy(a).invert(),ir.copy(t.ray).applyMatrix4(j0),!(s.boundingBox!==null&&ir.intersectsBox(s.boundingBox)===!1)&&this._computeIntersections(t,e,ir)))}_computeIntersections(t,e,s){let r;const a=this.geometry,l=this.material,u=a.index,c=a.attributes.position,d=a.attributes.uv,f=a.attributes.uv1,m=a.attributes.normal,g=a.groups,v=a.drawRange;if(u!==null)if(Array.isArray(l))for(let x=0,b=g.length;x<b;x++){const E=g[x],S=l[E.materialIndex],z=Math.max(E.start,v.start),I=Math.min(u.count,Math.min(E.start+E.count,v.start+v.count));for(let O=z,P=I;O<P;O+=3){const G=u.getX(O),$=u.getX(O+1),_t=u.getX(O+2);r=dh(this,S,t,s,d,f,m,G,$,_t),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,e.push(r))}}else{const x=Math.max(0,v.start),b=Math.min(u.count,v.start+v.count);for(let E=x,S=b;E<S;E+=3){const z=u.getX(E),I=u.getX(E+1),O=u.getX(E+2);r=dh(this,l,t,s,d,f,m,z,I,O),r&&(r.faceIndex=Math.floor(E/3),e.push(r))}}else if(c!==void 0)if(Array.isArray(l))for(let x=0,b=g.length;x<b;x++){const E=g[x],S=l[E.materialIndex],z=Math.max(E.start,v.start),I=Math.min(c.count,Math.min(E.start+E.count,v.start+v.count));for(let O=z,P=I;O<P;O+=3){const G=O,$=O+1,_t=O+2;r=dh(this,S,t,s,d,f,m,G,$,_t),r&&(r.faceIndex=Math.floor(O/3),r.face.materialIndex=E.materialIndex,e.push(r))}}else{const x=Math.max(0,v.start),b=Math.min(c.count,v.start+v.count);for(let E=x,S=b;E<S;E+=3){const z=E,I=E+1,O=E+2;r=dh(this,l,t,s,d,f,m,z,I,O),r&&(r.faceIndex=Math.floor(E/3),e.push(r))}}}}function L5(i,t,e,s,r,a,l,u){let c;if(t.side===L4?c=s.intersectTriangle(l,a,r,!0,u):c=s.intersectTriangle(r,a,l,t.side===Od,u),c===null)return null;ch.copy(u),ch.applyMatrix4(i.matrixWorld);const d=e.ray.origin.distanceTo(ch);return d<e.near||d>e.far?null:{distance:d,point:ch.clone(),object:i}}function dh(i,t,e,s,r,a,l,u,c,d){i.getVertexPosition(u,so),i.getVertexPosition(c,no),i.getVertexPosition(d,ro);const f=L5(i,t,e,s,so,no,ro,uh);if(f){r&&(ah.fromBufferAttribute(r,u),lh.fromBufferAttribute(r,c),hh.fromBufferAttribute(r,d),f.uv=Ji.getInterpolation(uh,so,no,ro,ah,lh,hh,new Le)),a&&(ah.fromBufferAttribute(a,u),lh.fromBufferAttribute(a,c),hh.fromBufferAttribute(a,d),f.uv1=Ji.getInterpolation(uh,so,no,ro,ah,lh,hh,new Le),f.uv2=f.uv1),l&&(X0.fromBufferAttribute(l,u),Q0.fromBufferAttribute(l,c),J0.fromBufferAttribute(l,d),f.normal=Ji.getInterpolation(uh,so,no,ro,X0,Q0,J0,new U),f.normal.dot(s.direction)>0&&f.normal.multiplyScalar(-1));const m={a:u,b:c,c:d,normal:new U,materialIndex:0};Ji.getNormal(so,no,ro,m.normal),f.face=m}return f}function P5(i){const t={};for(const e in i){t[e]={};for(const s in i[e]){const r=i[e][s];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[e][s]=null):t[e][s]=r.clone():Array.isArray(r)?t[e][s]=r.slice():t[e][s]=r}}return t}function R5(i){const t=[];for(let e=0;e<i.length;e++)t.push(i[e].clone());return t}var F5=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,$5=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class B5 extends I1{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=F5,this.fragmentShader=$5,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=P5(t.uniforms),this.uniformsGroups=R5(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;l&&l.isTexture?e.uniforms[r]={type:"t",value:l.toJSON(t).uuid}:l&&l.isColor?e.uniforms[r]={type:"c",value:l.getHex()}:l&&l.isVector2?e.uniforms[r]={type:"v2",value:l.toArray()}:l&&l.isVector3?e.uniforms[r]={type:"v3",value:l.toArray()}:l&&l.isVector4?e.uniforms[r]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?e.uniforms[r]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?e.uniforms[r]={type:"m4",value:l.toArray()}:e.uniforms[r]={value:l}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const s={};for(const r in this.extensions)this.extensions[r]===!0&&(s[r]=!0);return Object.keys(s).length>0&&(e.extensions=s),e}}class N5 extends _s{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Me,this.projectionMatrix=new Me,this.projectionMatrixInverse=new Me,this.coordinateSystem=ha}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class K0 extends N5{constructor(t=50,e=1,s=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=s,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=Uh*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(go*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return Uh*2*Math.atan(Math.tan(go*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,s,r,a,l){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=s,this.view.offsetY=r,this.view.width=a,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(go*.5*this.fov)/this.zoom,s=2*e,r=this.aspect*s,a=-.5*r;const l=this.view;if(this.view!==null&&this.view.enabled){const c=l.fullWidth,d=l.fullHeight;a+=l.offsetX*r/c,e-=l.offsetY*s/d,r*=l.width/c,s*=l.height/d}const u=this.filmOffset;u!==0&&(a+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,e,e-s,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}class rf extends ru{constructor(t=1,e=32,s=16,r=0,a=Math.PI*2,l=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:s,phiStart:r,phiLength:a,thetaStart:l,thetaLength:u},e=Math.max(3,Math.floor(e)),s=Math.max(2,Math.floor(s));const c=Math.min(l+u,Math.PI);let d=0;const f=[],m=new U,g=new U,v=[],x=[],b=[],E=[];for(let S=0;S<=s;S++){const z=[],I=S/s;let O=0;S===0&&l===0?O=.5/e:S===s&&c===Math.PI&&(O=-.5/e);for(let P=0;P<=e;P++){const G=P/e;m.x=-t*Math.cos(r+G*a)*Math.sin(l+I*u),m.y=t*Math.cos(l+I*u),m.z=t*Math.sin(r+G*a)*Math.sin(l+I*u),x.push(m.x,m.y,m.z),g.copy(m).normalize(),b.push(g.x,g.y,g.z),E.push(G+O,1-I),z.push(d++)}f.push(z)}for(let S=0;S<s;S++)for(let z=0;z<e;z++){const I=f[S][z+1],O=f[S][z],P=f[S+1][z],G=f[S+1][z+1];(S!==0||l>0)&&v.push(I,O,G),(S!==s-1||c<Math.PI)&&v.push(O,P,G)}this.setIndex(v),this.setAttribute("position",new Eh(x,3)),this.setAttribute("normal",new Eh(b,3)),this.setAttribute("uv",new Eh(E,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new rf(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}const U5={enabled:!1,files:{},add:function(i,t){this.enabled!==!1&&(this.files[i]=t)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},tg=new Me,eg=new Me,sr=new Me;class D5{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new K0,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new K0,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const e=this._cache;if(e.focus!==t.focus||e.fov!==t.fov||e.aspect!==t.aspect*this.aspect||e.near!==t.near||e.far!==t.far||e.zoom!==t.zoom||e.eyeSep!==this.eyeSep){e.focus=t.focus,e.fov=t.fov,e.aspect=t.aspect*this.aspect,e.near=t.near,e.far=t.far,e.zoom=t.zoom,e.eyeSep=this.eyeSep,sr.copy(t.projectionMatrix);const r=e.eyeSep/2,a=r*e.near/e.focus,l=e.near*Math.tan(go*e.fov*.5)/e.zoom;let u,c;eg.elements[12]=-r,tg.elements[12]=r,u=-l*e.aspect+a,c=l*e.aspect+a,sr.elements[0]=2*e.near/(c-u),sr.elements[8]=(c+u)/(c-u),this.cameraL.projectionMatrix.copy(sr),u=-l*e.aspect-a,c=l*e.aspect-a,sr.elements[0]=2*e.near/(c-u),sr.elements[8]=(c+u)/(c-u),this.cameraR.projectionMatrix.copy(sr)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(eg),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(tg)}}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:k1}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=k1);/*!
 * PhotoSphereViewer 5.1.7
 * @copyright 2014-2015 Jrmy Heleine
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var V5=Object.defineProperty,of=(i,t)=>{for(var e in t)V5(i,e,{get:t[e],enumerable:!0})},H5={};of(H5,{ACTIONS:()=>F1,ANIMATION_MIN_DURATION:()=>tC,CAPTURE_EVENTS_CLASS:()=>aC,CTRLZOOM_TIMEOUT:()=>rC,DBLCLICK_DELAY:()=>iC,DEFAULT_TRANSITION:()=>K5,EASINGS:()=>Sh,ICONS:()=>Es,IDS:()=>ys,INERTIA_WINDOW:()=>oC,KEY_CODES:()=>ei,LONGTOUCH_DELAY:()=>sC,MOVE_THRESHOLD:()=>eC,SPHERE_RADIUS:()=>P1,TWOFINGERSOVERLAY_DELAY:()=>nC,VIEWER_DATA:()=>R1});var W5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>
`,q5='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',G5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>
`,Y5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,j5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>
`,Z5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>
`,X5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kun\xE1k from the Noun Project--></svg>
`,Q5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,J5=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>
`,K5=1500,tC=500,eC=4,iC=300,sC=500,nC=100,rC=2e3,oC=300,P1=10,R1="photoSphereViewer",aC="psv--capture-event",F1=(i=>(i.ROTATE_UP="ROTATE_UP",i.ROTATE_DOWN="ROTATE_DOWN",i.ROTATE_RIGHT="ROTATE_RIGHT",i.ROTATE_LEFT="ROTATE_LEFT",i.ZOOM_IN="ZOOM_IN",i.ZOOM_OUT="ZOOM_OUT",i))(F1||{}),ys={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},ei={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Es={arrow:W5,close:q5,download:G5,fullscreenIn:Y5,fullscreenOut:j5,info:Z5,menu:X5,zoomIn:Q5,zoomOut:J5},Sh={linear:i=>i,inQuad:i=>i*i,outQuad:i=>i*(2-i),inOutQuad:i=>i<.5?2*i*i:-1+(4-2*i)*i,inCubic:i=>i*i*i,outCubic:i=>--i*i*i+1,inOutCubic:i=>i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1,inQuart:i=>i*i*i*i,outQuart:i=>1- --i*i*i*i,inOutQuart:i=>i<.5?8*i*i*i*i:1-8*--i*i*i*i,inQuint:i=>i*i*i*i*i,outQuint:i=>1+--i*i*i*i*i,inOutQuint:i=>i<.5?16*i*i*i*i*i:1+16*--i*i*i*i*i,inSine:i=>1-Math.cos(i*(Math.PI/2)),outSine:i=>Math.sin(i*(Math.PI/2)),inOutSine:i=>.5-.5*Math.cos(Math.PI*i),inExpo:i=>Math.pow(2,10*(i-1)),outExpo:i=>1-Math.pow(2,-10*i),inOutExpo:i=>(i=i*2-1)<0?.5*Math.pow(2,10*i):1-.5*Math.pow(2,-10*i),inCirc:i=>1-Math.sqrt(1-i*i),outCirc:i=>Math.sqrt(1-(i-1)*(i-1)),inOutCirc:i=>(i*=2)<1?.5-.5*Math.sqrt(1-i*i):.5+.5*Math.sqrt(1-(i-=2)*i)},Id={};of(Id,{Animation:()=>TC,Dynamic:()=>OC,MultiDynamic:()=>IC,PressHandler:()=>lf,Slider:()=>X1,SliderDirection:()=>Z1,addClasses:()=>U1,angle:()=>B1,applyEulerInverse:()=>zC,cleanCssPosition:()=>kC,clone:()=>Dh,createTexture:()=>Pd,cssPositionIsOrdered:()=>j1,dasherize:()=>wC,deepEqual:()=>q1,deepmerge:()=>H1,distance:()=>$1,exitFullscreen:()=>xC,firstNonNull:()=>ms,getAbortError:()=>MC,getAngle:()=>uC,getClosest:()=>D1,getConfigParser:()=>au,getElement:()=>dC,getPosition:()=>mC,getShortestArc:()=>hC,getStyle:()=>V1,getTouchData:()=>gC,getXMPValue:()=>gs,greatArcDistance:()=>cC,hasParent:()=>pC,invertResolvableBoolean:()=>ou,isAbortError:()=>EC,isEmpty:()=>bC,isExtendedPosition:()=>SC,isFullscreenEnabled:()=>vC,isNil:()=>W1,isPlainObject:()=>af,logWarn:()=>is,parseAngle:()=>Ld,parsePoint:()=>AC,parseSpeed:()=>CC,removeClasses:()=>fC,requestFullscreen:()=>yC,resolveBoolean:()=>Y1,sum:()=>lC,throttle:()=>_C,toggleClass:()=>N1,wrap:()=>ga});function ga(i,t){let e=i%t;return e<0&&(e+=t),e}function lC(i){return i.reduce((t,e)=>t+e,0)}function $1(i,t){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))}function B1(i,t){return Math.atan2(t.y-i.y,t.x-i.x)}function hC(i,t){return[0,Math.PI*2,-Math.PI*2].reduce((s,r)=>{const a=t-i+r;return Math.abs(a)<Math.abs(s)?a:s},1/0)}function uC(i,t){return Math.acos(Math.cos(i.pitch)*Math.cos(t.pitch)*Math.cos(i.yaw-t.yaw)+Math.sin(i.pitch)*Math.sin(t.pitch))}function cC([i,t],[e,s]){const r=(e-i)*Math.cos((t+s)/2),a=s-t;return Math.sqrt(r*r+a*a)}function dC(i){return typeof i=="string"?i.match(/^[a-z]/i)?document.getElementById(i):document.querySelector(i):i}function N1(i,t,e){e===void 0?i.classList.toggle(t):e?i.classList.add(t):e||i.classList.remove(t)}function U1(i,t){i.classList.add(...t.split(" "))}function fC(i,t){i.classList.remove(...t.split(" "))}function pC(i,t){let e=i;do{if(e===t)return!0;e=e.parentElement}while(e);return!1}function D1(i,t){if(!(i!=null&&i.matches))return null;let e=i;do{if(e.matches(t))return e;e=e.parentElement}while(e);return null}function mC(i){let t=0,e=0,s=i;for(;s;)t+=s.offsetLeft-s.scrollLeft+s.clientLeft,e+=s.offsetTop-s.scrollTop+s.clientTop,s=s.offsetParent;return{x:t,y:e}}function V1(i,t){return window.getComputedStyle(i,null)[t]}function gC(i){if(i.touches.length<2)return null;const t={x:i.touches[0].clientX,y:i.touches[0].clientY},e={x:i.touches[1].clientX,y:i.touches[1].clientY};return{distance:$1(t,e),angle:B1(t,e),center:{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}}function vC(i){return(document.fullscreenElement||document.webkitFullscreenElement)===i}function yC(i){(i.requestFullscreen||i.webkitRequestFullscreen).call(i)}function xC(){(document.exitFullscreen||document.webkitExitFullscreen).call(document)}function wC(i){return i.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,(t,e)=>(e>0?"-":"")+t.toLowerCase())}function _C(i,t){let e=!1;return function(...s){e||(e=!0,setTimeout(()=>{i.apply(this,s),e=!1},t))}}function af(i){if(typeof i!="object"||i===null||Object.prototype.toString.call(i)!=="[object Object]")return!1;if(Object.getPrototypeOf(i)===null)return!0;let t=i;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(i)===t}function H1(i,t){const e=t;return function s(r,a){return Array.isArray(a)?(!r||!Array.isArray(r)?r=[]:r.length=0,a.forEach((l,u)=>{r[u]=s(null,l)})):typeof a=="object"?((!r||Array.isArray(r))&&(r={}),Object.keys(a).forEach(l=>{typeof a[l]!="object"||!a[l]||!af(a[l])?r[l]=a[l]:a[l]!==e&&(r[l]?s(r[l],a[l]):r[l]=s(null,a[l]))})):r=a,r}(i,t)}function Dh(i){return H1(null,i)}function bC(i){return!i||Object.keys(i).length===0&&i.constructor===Object}function W1(i){return i==null}function ms(...i){for(const t of i)if(!W1(t))return t;return null}function q1(i,t){if(i===t)return!0;if(ig(i)&&ig(t)){if(Object.keys(i).length!==Object.keys(t).length)return!1;for(const e of Object.keys(i))if(!q1(i[e],t[e]))return!1;return!0}else return!1}function ig(i){return typeof i=="object"&&i!==null}var be=class G1 extends Error{constructor(t){var e;super(t),this.name="PSVError",(e=Error.captureStackTrace)==null||e.call(Error,this,G1)}};function Y1(i,t){af(i)?(t(i.initial,!0),i.promise.then(e=>t(e,!1))):t(i,!0)}function ou(i){return{initial:!i.initial,promise:i.promise.then(t=>!t)}}function MC(){const i=new Error("Loading was aborted.");return i.name="AbortError",i}function EC(i){return(i==null?void 0:i.name)==="AbortError"}function is(i){console.warn(`PhotoSphereViewer: ${i}`)}function SC(i){return i?[["textureX","textureY"],["yaw","pitch"]].some(([t,e])=>i[t]!==void 0&&i[e]!==void 0):!1}function gs(i,t){let e=i.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(e!==null){const s=parseInt(e[1],10);return isNaN(s)?null:s}if(e=i.match("GPano:"+t+'="(.*?)"'),e!==null){const s=parseInt(e[1],10);return isNaN(s)?null:s}return null}var sg={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Vh=["left","center","right"],Hh=["top","center","bottom"],ng=[...Vh,...Hh],Oi="center";function AC(i){if(!i)return{x:.5,y:.5};if(typeof i=="object")return i;let t=i.toLocaleLowerCase().split(" ").slice(0,2);t.length===1&&(sg[t[0]]?t=[t[0],Oi]:t=[t[0],t[0]]);const e=t[1]!=="left"&&t[1]!=="right"&&t[0]!=="top"&&t[0]!=="bottom";t=t.map(r=>sg[r]||r),e||t.reverse();const s=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return s?{x:parseFloat(s[1])/100,y:parseFloat(s[2])/100}:{x:.5,y:.5}}function kC(i,{allowCenter:t,cssOrder:e}={allowCenter:!0,cssOrder:!0}){return i?(typeof i=="string"&&(i=i.split(" ")),i.length===1&&(i[0]===Oi?i=[Oi,Oi]:Vh.indexOf(i[0])!==-1?i=[Oi,i[0]]:Hh.indexOf(i[0])!==-1&&(i=[i[0],Oi])),i.length!==2||ng.indexOf(i[0])===-1||ng.indexOf(i[1])===-1?(is(`Unparsable position ${i}`),null):!t&&i[0]===Oi&&i[1]===Oi?(is("Invalid position center center"),null):(e&&!j1(i)&&(i=[i[1],i[0]]),i[1]===Oi&&Vh.indexOf(i[0])!==-1&&(i=[Oi,i[0]]),i[0]===Oi&&Hh.indexOf(i[1])!==-1&&(i=[i[1],Oi]),i)):null}function j1(i){return Hh.indexOf(i[0])!==-1&&Vh.indexOf(i[1])!==-1}function CC(i){let t;if(typeof i=="string"){const e=i.toString().trim();let s=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const r=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(s/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=Ki.degToRad(s);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=s;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=s*Math.PI*2;break;default:throw new be(`Unknown speed unit "${r}"`)}}else t=i;return t}function Ld(i,t=!1,e=t){let s;if(typeof i=="string"){const r=i.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!r)throw new be(`Unknown angle "${i}"`);const a=parseFloat(r[1]),l=r[2];if(l)switch(l){case"deg":case"degs":s=Ki.degToRad(a);break;case"rad":case"rads":s=a;break;default:throw new be(`Unknown angle unit "${l}"`)}else s=a}else if(typeof i=="number"&&!isNaN(i))s=i;else throw new be(`Unknown angle "${i}"`);return s=ga(t?s+Math.PI:s,Math.PI*2),t?Ki.clamp(s-Math.PI,-Math.PI/(e?2:1),Math.PI/(e?2:1)):s}function Pd(i){const t=new $i(i);return t.needsUpdate=!0,t.minFilter=z1,t.generateMipmaps=!1,t}var rg=new Mo;function zC(i,t){rg.setFromEuler(t).invert(),i.applyQuaternion(rg)}function au(i,t){const e=function(s){if(!s)return Dh(i);const r=Dh({...i,...s}),a={};for(let[l,u]of Object.entries(r)){if(t&&l in t)u=t[l](u,{rawConfig:r,defValue:i[l]});else if(!(l in i)){is(`Unknown option ${l}`);continue}a[l]=u}return a};return e.defaults=i,e.parsers=t||{},e}var TC=class{constructor(i){this.easing=Sh.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=i,i?(i.easing&&(this.easing=typeof i.easing=="function"?i.easing:Sh[i.easing]||Sh.linear),this.delayTimeout=setTimeout(()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame(t=>this.__run(t))},i.delay||0)):this.resolved=!0}__run(i){if(this.cancelled)return;this.start||(this.start=i);const t=(i-this.start)/this.options.duration,e={};if(t<1){for(const[s,r]of Object.entries(this.options.properties))if(r){const a=r.start+(r.end-r.start)*this.easing(t);e[s]=a}this.options.onTick(e,t),this.animationFrame=window.requestAnimationFrame(s=>this.__run(s))}else{for(const[s,r]of Object.entries(this.options.properties))r&&(e[s]=r.end);this.options.onTick(e,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(i){i?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(t=>t(i)),this.callbacks.length=0}then(i){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(i):new Promise(t=>{this.callbacks.push(t)}).then(i)}cancel(){!this.cancelled&&!this.resolved&&(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},OC=class{constructor(i,t){if(this.fn=i,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=t.min,this.max=t.max,this.wrap=t.wrap,this.current=t.defaultValue,this.wrap&&this.min!==0)throw new be("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(i){this.__current=i}setSpeed(i){this.speed=i}goto(i,t=1){this.mode=2,this.target=this.wrap?ga(i,this.max):Ki.clamp(i,this.min,this.max),this.speedMult=t}step(i,t=1){t===0?this.setValue(this.current+i):(this.mode!==2&&(this.target=this.current),this.goto(this.target+i,t))}roll(i=!1,t=1){this.mode=1,this.target=i?-1/0:1/0,this.speedMult=t}stop(){this.mode=0}setValue(i){return this.target=this.wrap?ga(i,this.max):Ki.clamp(i,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current?(this.current=this.target,this.fn&&this.fn(this.current),!0):!1}update(i){if(this.mode===2){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const s=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=s&&(this.mode=0)}let t=this.mode===0?0:this.speed*this.speedMult;this.target<this.current&&(t=-t),this.currentSpeed<t?this.currentSpeed=Math.min(t,this.currentSpeed+i/1e3*this.speed*this.speedMult*2):this.currentSpeed>t&&(this.currentSpeed=Math.max(t,this.currentSpeed-i/1e3*this.speed*this.speedMult*2));let e=null;return this.current>this.target&&this.currentSpeed?e=Math.max(this.target,this.current+this.currentSpeed*i/1e3):this.current<this.target&&this.currentSpeed&&(e=Math.min(this.target,this.current+this.currentSpeed*i/1e3)),e!==null&&(e=this.wrap?ga(e,this.max):Ki.clamp(e,this.min,this.max),e!==this.current)?(this.current=e,this.fn&&this.fn(this.current),!0):!1}},IC=class{constructor(i,t){this.fn=i,this.dynamics=t,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce((i,[t,e])=>(i[t]=e.current,i),{})}setSpeed(i){for(const t of Object.values(this.dynamics))t.setSpeed(i)}goto(i,t=1){for(const[e,s]of Object.entries(i))this.dynamics[e].goto(s,t)}step(i,t=1){if(t===0)this.setValue(Object.keys(i).reduce((e,s)=>(e[s]=i[s]+this.dynamics[s].current,e),{}));else for(const[e,s]of Object.entries(i))this.dynamics[e].step(s,t)}roll(i,t=1){for(const[e,s]of Object.entries(i))this.dynamics[e].roll(s,t)}stop(){for(const i of Object.values(this.dynamics))i.stop()}setValue(i){let t=!1;for(const[e,s]of Object.entries(i))t=this.dynamics[e].setValue(s)||t;return t&&this.fn&&this.fn(this.current),t}update(i){let t=!1;for(const e of Object.values(this.dynamics))t=e.update(i)||t;return t&&this.fn&&this.fn(this.current),t}},lf=class{constructor(i=200){this.delay=i,this.time=0,this.delay=i}get pending(){return this.time!==0}down(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=new Date().getTime()}up(i){if(!this.time)return;Date.now()-this.time<this.delay?this.timeout=setTimeout(()=>{i(),this.timeout=void 0,this.time=0},this.delay):(i(),this.time=0)}},Z1=(i=>(i.VERTICAL="VERTICAL",i.HORIZONTAL="HORIZONTAL",i))(Z1||{}),X1=class{constructor(i,t,e){this.container=i,this.direction=t,this.listener=e,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return this.direction==="VERTICAL"}get isHorizontal(){return this.direction==="HORIZONTAL"}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(i){switch(i.type){case"click":i.stopPropagation();break;case"mousedown":this.__onMouseDown(i);break;case"mouseenter":this.__onMouseEnter(i);break;case"mouseleave":this.__onMouseLeave(i);break;case"touchstart":this.__onTouchStart(i);break;case"mousemove":this.__onMouseMove(i);break;case"touchmove":this.__onTouchMove(i);break;case"mouseup":this.__onMouseUp(i);break;case"touchend":this.__onTouchEnd(i);break}}__onMouseDown(i){this.mousedown=!0,this.__update(i.clientX,i.clientY,!0)}__onMouseEnter(i){this.mouseover=!0,this.__update(i.clientX,i.clientY,!0)}__onTouchStart(i){this.mouseover=!0,this.mousedown=!0;const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}__onMouseMove(i){(this.mousedown||this.mouseover)&&(i.stopPropagation(),this.__update(i.clientX,i.clientY,!0))}__onTouchMove(i){if(this.mousedown||this.mouseover){i.stopPropagation();const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}__onMouseUp(i){this.mousedown&&(this.mousedown=!1,this.__update(i.clientX,i.clientY,!1))}__onMouseLeave(i){this.mouseover&&(this.mouseover=!1,this.__update(i.clientX,i.clientY,!0))}__onTouchEnd(i){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const t=i.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}__update(i,t,e){const s=this.container.getBoundingClientRect(),r=this.isVertical?t:i,a=s[this.isVertical?"bottom":"left"],l=s[this.isVertical?"height":"width"],u=Math.abs((a-r)/l);this.listener({value:u,click:!e,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:i,clientY:t}})}},nr={};of(nr,{BeforeAnimateEvent:()=>PC,BeforeRenderEvent:()=>RC,BeforeRotateEvent:()=>FC,ClickEvent:()=>$C,ConfigChangedEvent:()=>cr,DoubleClickEvent:()=>BC,FullscreenEvent:()=>Ah,HideNotificationEvent:()=>kh,HideOverlayEvent:()=>NC,HidePanelEvent:()=>dr,HideTooltipEvent:()=>UC,KeypressEvent:()=>DC,LoadProgressEvent:()=>VC,ObjectEnterEvent:()=>XC,ObjectEvent:()=>lu,ObjectHoverEvent:()=>JC,ObjectLeaveEvent:()=>QC,PanoramaLoadedEvent:()=>HC,PositionUpdatedEvent:()=>WC,ReadyEvent:()=>Ch,RenderEvent:()=>qC,ShowNotificationEvent:()=>zh,ShowOverlayEvent:()=>GC,ShowPanelEvent:()=>fr,ShowTooltipEvent:()=>YC,SizeUpdatedEvent:()=>jC,StopAllEvent:()=>ZC,ViewerEvent:()=>qt,ZoomUpdatedEvent:()=>Th});var Q1=class extends Event{constructor(i,t=!1){super(i,{cancelable:t})}},LC=class extends EventTarget{dispatchEvent(i){return super.dispatchEvent(i)}addEventListener(i,t,e){super.addEventListener(i,t,e)}removeEventListener(i,t,e){super.removeEventListener(i,t,e)}},qt=class extends Q1{},J1=class K1 extends qt{constructor(t,e){super(K1.type,!0),this.position=t,this.zoomLevel=e}};J1.type="before-animate";var PC=J1,ty=class ey extends qt{constructor(t,e){super(ey.type),this.timestamp=t,this.elapsed=e}};ty.type="before-render";var RC=ty,iy=class sy extends qt{constructor(t){super(sy.type,!0),this.position=t}};iy.type="before-rotate";var FC=iy,ny=class ry extends qt{constructor(t){super(ry.type),this.data=t}};ny.type="click";var $C=ny,oy=class ay extends qt{constructor(t){super(ay.type),this.options=t}containsOptions(...t){return t.some(e=>this.options.includes(e))}};oy.type="config-changed";var cr=oy,ly=class hy extends qt{constructor(t){super(hy.type),this.data=t}};ly.type="dblclick";var BC=ly,uy=class cy extends qt{constructor(t){super(cy.type),this.fullscreenEnabled=t}};uy.type="fullscreen";var Ah=uy,dy=class fy extends qt{constructor(t){super(fy.type),this.notificationId=t}};dy.type="hide-notification";var kh=dy,py=class my extends qt{constructor(t){super(my.type),this.overlayId=t}};py.type="hide-overlay";var NC=py,gy=class vy extends qt{constructor(t){super(vy.type),this.panelId=t}};gy.type="hide-panel";var dr=gy,yy=class xy extends qt{constructor(t){super(xy.type),this.tooltipData=t}};yy.type="hide-tooltip";var UC=yy,wy=class _y extends qt{constructor(t){super(_y.type,!0),this.key=t}};wy.type="key-press";var DC=wy,by=class My extends qt{constructor(t){super(My.type),this.progress=t}};by.type="load-progress";var VC=by,Ey=class Sy extends qt{constructor(t){super(Sy.type),this.data=t}};Ey.type="panorama-loaded";var HC=Ey,Ay=class ky extends qt{constructor(t){super(ky.type),this.position=t}};Ay.type="position-updated";var WC=Ay,Cy=class zy extends qt{constructor(){super(zy.type)}};Cy.type="ready";var Ch=Cy,Ty=class Oy extends qt{constructor(){super(Oy.type)}};Ty.type="render";var qC=Ty,Iy=class Ly extends qt{constructor(t){super(Ly.type),this.notificationId=t}};Iy.type="show-notification";var zh=Iy,Py=class Ry extends qt{constructor(t){super(Ry.type),this.overlayId=t}};Py.type="show-overlay";var GC=Py,Fy=class $y extends qt{constructor(t){super($y.type),this.panelId=t}};Fy.type="show-panel";var fr=Fy,By=class Ny extends qt{constructor(t,e){super(Ny.type),this.tooltip=t,this.tooltipData=e}};By.type="show-tooltip";var YC=By,Uy=class Dy extends qt{constructor(t){super(Dy.type),this.size=t}};Uy.type="size-updated";var jC=Uy,Vy=class Hy extends qt{constructor(){super(Hy.type)}};Vy.type="stop-all";var ZC=Vy,Wy=class qy extends qt{constructor(t){super(qy.type),this.zoomLevel=t}};Wy.type="zoom-updated";var Th=Wy,lu=class extends qt{constructor(i,t,e,s,r){super(i),this.originalEvent=t,this.object=e,this.viewerPoint=s,this.userDataKey=r}},Gy=class Yy extends lu{constructor(t,e,s,r){super(Yy.type,t,e,s,r)}};Gy.type="enter-object";var XC=Gy,jy=class Zy extends lu{constructor(t,e,s,r){super(Zy.type,t,e,s,r)}};jy.type="leave-object";var QC=jy,Xy=class Qy extends lu{constructor(t,e,s,r){super(Qy.type,t,e,s,r)}};Xy.type="hover-object";var JC=Xy,hu=class pi{constructor(t){this.viewer=t}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}static createOverlayMaterial({additionalUniforms:t,overrideVertexShader:e}={}){return new B5({uniforms:{...t,[pi.OVERLAY_UNIFORMS.panorama]:{value:new $i},[pi.OVERLAY_UNIFORMS.overlay]:{value:new $i},[pi.OVERLAY_UNIFORMS.globalOpacity]:{value:1},[pi.OVERLAY_UNIFORMS.overlayOpacity]:{value:1}},vertexShader:e||`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`
uniform sampler2D ${pi.OVERLAY_UNIFORMS.panorama};
uniform sampler2D ${pi.OVERLAY_UNIFORMS.overlay};
uniform float ${pi.OVERLAY_UNIFORMS.globalOpacity};
uniform float ${pi.OVERLAY_UNIFORMS.overlayOpacity};

varying vec2 vUv;

void main() {
  vec4 tColor1 = texture2D( ${pi.OVERLAY_UNIFORMS.panorama}, vUv );
  vec4 tColor2 = texture2D( ${pi.OVERLAY_UNIFORMS.overlay}, vUv );
  gl_FragColor = vec4(
    mix( tColor1.rgb, tColor2.rgb, tColor2.a * ${pi.OVERLAY_UNIFORMS.overlayOpacity} ),
    ${pi.OVERLAY_UNIFORMS.globalOpacity}
  );
}`})}};hu.supportsDownload=!1;hu.supportsOverlay=!1;hu.OVERLAY_UNIFORMS={panorama:"panorama",overlay:"overlay",globalOpacity:"globalOpacity",overlayOpacity:"overlayOpacity"};var An=hu;function og(i){if(i){for(const[,t]of[["_",i],...Object.entries(i)])if(t.prototype instanceof An)return t}return null}var na=`${R1}_touchSupport`,_a={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,fullscreenEvent:null,__maxCanvasWidth:null,get maxCanvasWidth(){return this.__maxCanvasWidth===null&&(this.__maxCanvasWidth=ez(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const i=KC();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=i!==null,this.maxTextureWidth=i?i.getParameter(i.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=tz(),this.fullscreenEvent=iz(),this.loaded=!0}throw new be("WebGL is not supported.")}};function KC(){const i=document.createElement("canvas"),t=["webgl2","webgl","experimental-webgl","moz-webgl","webkit-3d"];let e=null;return i.getContext&&t.some(s=>{try{return e=i.getContext(s),e!==null}catch{return!1}})?e:null}function tz(){let i="ontouchstart"in window||navigator.maxTouchPoints>0;na in localStorage&&(i=localStorage[na]==="true");const t=new Promise(e=>{const s=()=>{window.removeEventListener("mousedown",r),window.removeEventListener("touchstart",a),clearTimeout(u)},r=()=>{s(),localStorage[na]=!1,e(!1)},a=()=>{s(),localStorage[na]=!0,e(!0)},l=()=>{s(),localStorage[na]=i,e(i)};window.addEventListener("mousedown",r,!1),window.addEventListener("touchstart",a,!1);const u=setTimeout(l,1e4)});return{initial:i,promise:t}}function ez(i){const t=document.createElement("canvas"),e=t.getContext("2d");for(t.width=i,t.height=i/2;t.width>1024;){e.fillStyle="white",e.fillRect(0,0,1,1);try{if(e.getImageData(0,0,1,1).data[0]>0)return t.width}catch{}t.width/=2,t.height/=2}throw new be("Unable to detect system capabilities")}function iz(){return"exitFullscreen"in document?"fullscreenchange":"webkitExitFullscreen"in document?"webkitfullscreenchange":null}var sz=au({resolution:64,blur:!1},{resolution:i=>{if(!i||!Ki.isPowerOfTwo(i))throw new be("EquirectangularAdapter resolution must be power of two");return i}}),uu=class extends An{constructor(i,t){super(i),this.config=sz(t),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}async loadTexture(i,t,e=this.viewer.config.useXmpData){if(typeof i!="string")return Promise.reject(new be("Invalid panorama url, are you using the right adapter?"));const s=await this.viewer.textureLoader.loadFile(i,c=>this.viewer.loader.setProgress(c)),r=e?await this.loadXMP(s):null,a=await this.viewer.textureLoader.blobToImage(s);typeof t=="function"&&(t=t(a));const l={fullWidth:ms(t==null?void 0:t.fullWidth,r==null?void 0:r.fullWidth,a.width),fullHeight:ms(t==null?void 0:t.fullHeight,r==null?void 0:r.fullHeight,a.height),croppedWidth:ms(t==null?void 0:t.croppedWidth,r==null?void 0:r.croppedWidth,a.width),croppedHeight:ms(t==null?void 0:t.croppedHeight,r==null?void 0:r.croppedHeight,a.height),croppedX:ms(t==null?void 0:t.croppedX,r==null?void 0:r.croppedX,0),croppedY:ms(t==null?void 0:t.croppedY,r==null?void 0:r.croppedY,0),poseHeading:ms(t==null?void 0:t.poseHeading,r==null?void 0:r.poseHeading,0),posePitch:ms(t==null?void 0:t.posePitch,r==null?void 0:r.posePitch,0),poseRoll:ms(t==null?void 0:t.poseRoll,r==null?void 0:r.poseRoll,0)};(l.croppedWidth!==a.width||l.croppedHeight!==a.height)&&is(`Invalid panoData, croppedWidth and/or croppedHeight is not coherent with loaded image.
              panoData: ${l.croppedWidth}x${l.croppedHeight}, image: ${a.width}x${a.height}`),(t||r)&&l.fullWidth!==l.fullHeight*2&&is("Invalid panoData, fullWidth should be twice fullHeight");const u=this.createEquirectangularTexture(a,l);return{panorama:i,texture:u,panoData:l}}async loadXMP(i){const t=await this.loadBlobAsString(i),e=t.indexOf("<x:xmpmeta"),s=t.indexOf("</x:xmpmeta>"),r=t.substring(e,s);return e!==-1&&s!==-1&&r.includes("GPano:")?{fullWidth:gs(r,"FullPanoWidthPixels"),fullHeight:gs(r,"FullPanoHeightPixels"),croppedWidth:gs(r,"CroppedAreaImageWidthPixels"),croppedHeight:gs(r,"CroppedAreaImageHeightPixels"),croppedX:gs(r,"CroppedAreaLeftPixels"),croppedY:gs(r,"CroppedAreaTopPixels"),poseHeading:gs(r,"PoseHeadingDegrees"),posePitch:gs(r,"PosePitchDegrees"),poseRoll:gs(r,"PoseRollDegrees")}:null}loadBlobAsString(i){return new Promise((t,e)=>{const s=new FileReader;s.onload=()=>t(s.result),s.onerror=e,s.readAsText(i)})}createEquirectangularTexture(i,t){if(this.config.blur||t.fullWidth>_a.maxTextureWidth||t.croppedWidth!==t.fullWidth||t.croppedHeight!==t.fullHeight){const e=Math.min(1,_a.maxCanvasWidth/t.fullWidth),s={fullWidth:t.fullWidth*e,fullHeight:t.fullHeight*e,croppedWidth:t.croppedWidth*e,croppedHeight:t.croppedHeight*e,croppedX:t.croppedX*e,croppedY:t.croppedY*e},r=document.createElement("canvas");r.width=s.fullWidth,r.height=s.fullHeight;const a=r.getContext("2d");return this.config.blur&&(a.filter=`blur(${r.width/2048}px)`),a.drawImage(i,s.croppedX,s.croppedY,s.croppedWidth,s.croppedHeight),Pd(r)}return Pd(i)}createMesh(i=1){const t=new rf(P1*i,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1),e=An.createOverlayMaterial();return new I5(t,e)}setTexture(i,t){this.__setUniform(i,An.OVERLAY_UNIFORMS.panorama,t.texture),this.setOverlay(i,null,1)}setOverlay(i,t,e){this.__setUniform(i,An.OVERLAY_UNIFORMS.overlayOpacity,e),t?this.__setUniform(i,An.OVERLAY_UNIFORMS.overlay,t.texture):this.__setUniform(i,An.OVERLAY_UNIFORMS.overlay,new $i)}setTextureOpacity(i,t){this.__setUniform(i,An.OVERLAY_UNIFORMS.globalOpacity,t),i.material.transparent=t<1}disposeTexture(i){var t;(t=i.texture)==null||t.dispose()}__setUniform(i,t,e){i.material.uniforms[t].value instanceof $i&&i.material.uniforms[t].value.dispose(),i.material.uniforms[t].value=e}};uu.id="equirectangular";uu.supportsDownload=!0;uu.supportsOverlay=!0;var nz=class Jy{constructor(t,e){this.parent=t,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=t instanceof Jy?t.viewer:t,this.container.className=e.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);t!==-1&&this.parent.children.splice(t,1),this.children.slice().forEach(e=>e.destroy()),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},rz=au({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),en=class extends nz{constructor(i,t){super(i,{className:`psv-button ${t.hoverScale?"psv-button--hover-scale":""} ${t.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=rz(t),this.config.id=this.constructor.id,t.icon&&this.__setIcon(t.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),t.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",e=>{this.state.enabled&&this.onClick(),e.stopPropagation()}),this.container.addEventListener("keydown",e=>{e.key===ei.Enter&&this.state.enabled&&(this.onClick(),e.stopPropagation())})}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(i=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),i&&this.viewer.navbar.autoSize())}hide(i=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",i&&this.viewer.navbar.autoSize())}checkSupported(){Y1(this.isSupported(),(i,t)=>{!this.state||(this.state.supported=i,t?i||this.hide():this.toggle(i))})}autoSize(){}isSupported(){return!0}toggleActive(i=!this.state.active){i!==this.state.active&&(this.state.active=i,N1(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(i){this.container.innerHTML=i,U1(this.container.querySelector("svg"),"psv-button-svg")}},hf=class extends en{constructor(i){super(i,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Es.info}),this.mode=0,this.viewer.addEventListener(kh.type,this),this.viewer.addEventListener(zh.type,this),this.viewer.addEventListener(dr.type,this),this.viewer.addEventListener(fr.type,this),this.viewer.addEventListener(cr.type,this)}destroy(){this.viewer.removeEventListener(kh.type,this),this.viewer.removeEventListener(zh.type,this),this.viewer.removeEventListener(dr.type,this),this.viewer.removeEventListener(fr.type,this),this.viewer.removeEventListener(cr.type,this),super.destroy()}handleEvent(i){if(i instanceof cr){i.containsOptions("description")&&this.autoSize(!0);return}if(!this.mode)return;let t=!1;i instanceof kh?t=this.mode===1:i instanceof zh?t=this.mode===1&&i.notificationId!==ys.DESCRIPTION:i instanceof dr?t=this.mode===2:i instanceof fr&&(t=this.mode===2&&i.panelId!==ys.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(i){super.hide(i),this.mode&&this.__close()}autoSize(i=!1){if(i){const t=this.viewer.navbar.getButton("caption",!1),e=t&&!t.isVisible(),s=!!this.viewer.config.description;e||s?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(ys.DESCRIPTION);break;case 2:this.viewer.panel.hide(ys.DESCRIPTION);break}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:ys.DESCRIPTION,content:(this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:ys.DESCRIPTION,content:this.viewer.config.caption}))}};hf.id="description";var Ky=class extends en{constructor(i){super(i,{className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Es.download}),this.viewer.addEventListener(cr.type,this)}destroy(){this.viewer.removeEventListener(cr.type,this),super.destroy()}handleEvent(i){i instanceof cr&&i.containsOptions("downloadUrl")&&this.checkSupported()}onClick(){const i=document.createElement("a");i.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,i.href.startsWith("data:")&&!this.viewer.config.downloadName?i.download="panorama."+i.href.substring(0,i.href.indexOf(";")).split("/").pop():i.download=this.viewer.config.downloadName||i.href.split("/").pop(),i.target="_blank",this.viewer.container.appendChild(i),i.click(),setTimeout(()=>{this.viewer.container.removeChild(i)},100)}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}};Ky.id="download";var tx=class extends en{constructor(i){super(i,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Es.fullscreenIn,iconActive:Es.fullscreenOut}),this.viewer.addEventListener(Ah.type,this)}destroy(){this.viewer.removeEventListener(Ah.type,this),super.destroy()}handleEvent(i){i instanceof Ah&&this.toggleActive(i.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};tx.id="fullscreen";var oz="psvButton",az=(i,t)=>`
<div class="psv-panel-menu psv-panel-menu--stripped">
  <h1 class="psv-panel-menu-title">${Es.menu} ${t}</h1>
  <ul class="psv-panel-menu-list">
    ${i.map(e=>`
    <li data-psv-button="${e.id}" class="psv-panel-menu-item" tabindex="0">
      <span class="psv-panel-menu-item-icon">${e.content}</span>
      <span class="psv-panel-menu-item-label">${e.title}</span>
    </li>
    `).join("")}
  </ul>
</div>
`,lz=class extends en{constructor(i){super(i,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Es.menu}),this.viewer.addEventListener(fr.type,this),this.viewer.addEventListener(dr.type,this),super.hide()}destroy(){this.viewer.removeEventListener(fr.type,this),this.viewer.removeEventListener(dr.type,this),super.destroy()}handleEvent(i){i instanceof fr?this.toggleActive(i.panelId===ys.MENU):i instanceof dr&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(i){super.hide(i),this.__hideMenu()}show(i){super.show(i),this.state.active&&this.__showMenu()}__showMenu(){this.viewer.panel.show({id:ys.MENU,content:az(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:i=>{const t=i?D1(i,"li"):void 0,e=t?t.dataset[oz]:void 0;e&&(this.viewer.navbar.getButton(e).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(ys.MENU)}};lz.id="menu";function hz(i){let t=0;switch(i){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0;break}return Es.arrow.replace("rotate(0",`rotate(${t}`)}var Ta=class extends en{constructor(i,t){super(i,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:hz(t)}),this.direction=t,this.handler=new lf,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(i){switch(i.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":i.key===ei.Enter&&this.__onMouseDown();break;case"keyup":i.key===ei.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return ou(_a.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const i={};switch(this.direction){case 0:i.pitch=!1;break;case 1:i.pitch=!0;break;case 3:i.yaw=!1;break;default:i.yaw=!0;break}this.viewer.stopAll(),this.viewer.dynamics.position.roll(i),this.handler.down()}__onMouseUp(){!this.state.enabled||this.handler.up(()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()})}};Ta.groupId="move";var ex=class extends Ta{constructor(i){super(i,1)}};ex.id="moveDown";var ix=class extends Ta{constructor(i){super(i,2)}};ix.id="moveLeft";var sx=class extends Ta{constructor(i){super(i,3)}};sx.id="moveRight";var nx=class extends Ta{constructor(i){super(i,0)}};nx.id="moveUp";var uf=class extends en{constructor(i,t,e){super(i,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=t,this.handler=new lf,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(i){switch(i.type){case"mousedown":this.__onMouseDown();break;case"mouseup":this.__onMouseUp();break;case"touchend":this.__onMouseUp();break;case"keydown":i.key===ei.Enter&&this.__onMouseDown();break;case"keyup":i.key===ei.Enter&&this.__onMouseUp();break}}onClick(){}isSupported(){return ou(_a.isTouchEnabled)}__onMouseDown(){!this.state.enabled||(this.viewer.dynamics.zoom.roll(this.direction===1),this.handler.down())}__onMouseUp(){!this.state.enabled||this.handler.up(()=>this.viewer.dynamics.zoom.stop())}};uf.groupId="zoom";var rx=class extends uf{constructor(i){super(i,0,Es.zoomIn)}};rx.id="zoomIn";var ox=class extends uf{constructor(i){super(i,1,Es.zoomOut)}};ox.id="zoomOut";var cf=class extends en{constructor(i){super(i,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new X1(this.container,"HORIZONTAL",t=>this.__onSliderUpdate(t)),this.mediaMinWidth=parseInt(V1(this.container,"maxWidth"),10),this.viewer.addEventListener(Th.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(Ch.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(Th.type,this),this.viewer.removeEventListener(Ch.type,this),super.destroy()}handleEvent(i){i instanceof Th?this.__moveZoomValue(i.zoomLevel):i instanceof Ch&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return ou(_a.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(i){this.zoomValue.style.left=i/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(i){i.mousedown&&this.viewer.zoom(i.value*100)}};cf.id="zoomRange";cf.groupId="zoom";var df=class extends LC{constructor(i){super(),this.viewer=i}init(){}destroy(){}},uz=class extends df{constructor(i,t){super(i),this.config=this.constructor.configParser(t)}setOption(i,t){this.setOptions({[i]:t})}setOptions(i){const t={...this.config,...i},e=this.constructor,s=e.configParser,r=e.readonlyOptions,a=e.id;for(let[l,u]of Object.entries(i)){if(!(l in s.defaults)){is(`${a}: Unknown option "${l}"`);continue}if(r.includes(l)){is(`${a}: Option "${l}" cannot be updated`);continue}l in s.parsers&&(u=s.parsers[l](u,{rawConfig:t,defValue:s.defaults[l]})),this.config[l]=u}}};uz.readonlyOptions=[];function ag(i){if(i){for(const[,t]of[["_",i],...Object.entries(i)])if(t.prototype instanceof df)return t}return null}var On={panorama:null,overlay:null,overlayOpacity:1,container:null,adapter:[uu,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"Loading...",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,useXmpData:!0,panoData:null,requestHeaders:null,canvasBackground:"#000",withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",download:"Download",fullscreen:"Fullscreen",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama can't be loaded"},keyboard:"fullscreen",keyboardActions:{[ei.ArrowUp]:"ROTATE_UP",[ei.ArrowDown]:"ROTATE_DOWN",[ei.ArrowRight]:"ROTATE_RIGHT",[ei.ArrowLeft]:"ROTATE_LEFT",[ei.PageUp]:"ZOOM_IN",[ei.PageDown]:"ZOOM_OUT",[ei.Plus]:"ZOOM_IN",[ei.Minus]:"ZOOM_OUT"}},cz={container:i=>{if(!i)throw new be("No value given for container.");return i},adapter:(i,{defValue:t})=>{if(i?Array.isArray(i)?i=[og(i[0]),i[1]]:i=[og(i),null]:i=t,!i[0])throw new be("An undefined value was given for adapter.");if(!i[0].id)throw new be("Adapter has no id.");return i},overlayOpacity:i=>Ki.clamp(i,0,1),defaultYaw:i=>Ld(i),defaultPitch:i=>Ld(i,!0),defaultZoomLvl:i=>Ki.clamp(i,0,100),minFov:(i,{rawConfig:t})=>(t.maxFov<i&&(is("maxFov cannot be lower than minFov"),i=t.maxFov),Ki.clamp(i,1,179)),maxFov:(i,{rawConfig:t})=>(i<t.minFov&&(i=t.minFov),Ki.clamp(i,1,179)),lang:i=>(Array.isArray(i.twoFingers)&&(is("lang.twoFingers must not be an array"),i.twoFingers=i.twoFingers[0]),{...On.lang,...i}),keyboard:i=>i?typeof i=="object"?(is("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):i==="always"?"always":"fullscreen":!1,keyboardActions:(i,{rawConfig:t})=>t.keyboard&&typeof t.keyboard=="object"?t.keyboard:i,fisheye:i=>i===!0?1:i===!1?0:i,requestHeaders:i=>i&&typeof i=="object"?()=>i:typeof i=="function"?i:null,plugins:i=>i.map((t,e)=>{if(Array.isArray(t)?t=[ag(t[0]),t[1]]:t=[ag(t),null],!t[0])throw new be(`An undefined value was given for plugin ${e}.`);if(!t[0].id)throw new be(`Plugin ${e} has no id.`);return t}),navbar:i=>i===!1?null:i===!0?Dh(On.navbar):typeof i=="string"?i.split(/[ ,]/):i};au(On,cz);var ax=class extends en{constructor(i){super(i,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(i){this.show(),this.contentElt.innerHTML=i!=null?i:"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){var i;(i=this.viewer.navbar.getButton(hf.id,!1))==null||i.autoSize(!0)}};ax.id="caption";var dz={},lg={};function lx(i,t){if(!i.id)throw new be("Button id is required");if(dz[i.id]=i,i.groupId&&(lg[i.groupId]=lg[i.groupId]||[]).push(i),t){const e=On.navbar;switch(t){case"start":e.unshift(i.id);break;case"end":e.push(i.id);break;default:{const[s,r]=t.split(":"),a=e.indexOf(s);if(!s||!r||a===-1)throw new be(`Invalid defaultPosition ${t}`);e.splice(a+(r==="right"?1:0),0,i.id)}}}}[ox,cf,rx,hf,ax,Ky,tx,ix,sx,nx,ex].forEach(i=>lx(i));new U;new za(0,0,0,"ZXY");new Le;U5.enabled=!0;Ti.enabled=!1;/*!
 * PhotoSphereViewer.StereoPlugin 5.1.7
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var fz=Object.defineProperty,pz=(i,t)=>{for(var e in t)fz(i,e,{get:t[e],enumerable:!0})},mz={};pz(mz,{StereoUpdatedEvent:()=>xo});var hx=class ux extends Q1{constructor(t){super(ux.type),this.stereoEnabled=t}};hx.type="stereo-updated";var xo=hx,gz='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -2 16 16"><path fill="currentColor" d="M13.104 0H2.896C2.332 0 1 .392 1 .875h14C15 .392 13.668 0 13.104 0zM15 1H1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h3.534a2 2 0 0 0 1.821-1.172l1.19-2.618a.5.5 0 0 1 .91 0l1.19 2.618A2 2 0 0 0 11.466 11H15a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM4 7a2 2 0 1 1 0-4 2 2 0 0 1 0 4zm8 0a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/><!--Created by Idev\xE3 Batista from the Noun Project--></svg>',ff=class extends en{constructor(i){super(i,{className:"psv-stereo-button",icon:gz,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("stereo"),this.plugin&&this.plugin.addEventListener(xo.type,this)}destroy(){this.plugin&&this.plugin.removeEventListener(xo.type,this),super.destroy()}isSupported(){return this.plugin?{initial:!1,promise:this.plugin.isSupported}:!1}handleEvent(i){i instanceof xo&&this.toggleActive(i.stereoEnabled)}onClick(){this.plugin.toggle()}};ff.id="stereo";var vz=class{constructor(i){const t=new D5;t.aspect=.5;const e=new Le;this.setEyeSeparation=function(s){t.eyeSep=s},this.setSize=function(s,r){i.setSize(s,r)},this.render=function(s,r){s.matrixWorldAutoUpdate===!0&&s.updateMatrixWorld(),r.parent===null&&r.matrixWorldAutoUpdate===!0&&r.updateMatrixWorld(),t.update(r),i.getSize(e),i.autoClear&&i.clear(),i.setScissorTest(!0),i.setScissor(0,0,e.width/2,e.height),i.setViewport(0,0,e.width/2,e.height),i.render(s,t.cameraL),i.setScissor(e.width/2,0,e.width/2,e.height),i.setViewport(e.width/2,0,e.width/2,e.height),i.render(s,t.cameraR),i.setScissorTest(!1)}}},yz='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66.7 19a14 14 0 0 1 13.8 12.1l-3.9-2.7c-.5-.3-1.1-.2-1.4.3-.3.5-.2 1.1.3 1.4l5.7 3.9.6.2c.3 0 .6-.2.8-.4l3.9-5.7c.3-.5.2-1.1-.3-1.4-.5-.3-1.1-.2-1.4.3l-2.4 3.5A16 16 0 0 0 66.7 17c-.6 0-1 .4-1 1s.4 1 1 1zM25 15h10c.6 0 1-.4 1-1s-.4-1-1-1H25c-.6 0-1 .4-1 1s.4 1 1 1zm-6.9 30H16l-2 .2a1 1 0 0 0-.8 1.2c.1.5.5.8 1 .8h.2l1.7-.2h2.1c.6 0 1-.4 1-1s-.5-1-1.1-1zm10 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zM84 45H55V16A11 11 0 0 0 44 5H16A11 11 0 0 0 5 16v68a11 11 0 0 0 11 11h68a11 11 0 0 0 11-11V56a11 11 0 0 0-11-11zM16 93c-5 0-9-4-9-9V53.2c.3-.1.6-.3.7-.6a9.8 9.8 0 0 1 2-3c.4-.4.4-1 0-1.4a1 1 0 0 0-1.4 0l-1.2 1.5V16c0-5 4-9 9-9h28c5 0 9 4 9 9v68c0 5-4 9-9 9H16zm77-9c0 5-4 9-9 9H50.3c2.8-2 4.7-5.3 4.7-9V47h29c5 0 9 4 9 9v28zM38.1 45h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.5-1-1-1zm9.9 0h-4c-.6 0-1 .4-1 1s.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1zm38 19c-.6 0-1 .4-1 1v10c0 .6.4 1 1 1s1-.4 1-1V65c0-.6-.4-1-1-1z"/><!--Created by Anthony Bresset from the Noun Project--></svg>',hg="pleaseRotate",xz=class extends df{constructor(i){super(i),this.state={enabled:!1,wakeLock:null}}get isSupported(){return this.gyroscope.isSupported()}init(){if(super.init(),this.markers=this.viewer.getPlugin("markers"),this.compass=this.viewer.getPlugin("compass"),this.gyroscope=this.viewer.getPlugin("gyroscope"),!this.gyroscope)throw new be("Stereo plugin requires the Gyroscope plugin");this.viewer.addEventListener(nr.StopAllEvent.type,this),this.viewer.addEventListener(nr.ClickEvent.type,this)}destroy(){this.viewer.removeEventListener(nr.StopAllEvent.type,this),this.viewer.removeEventListener(nr.ClickEvent.type,this),this.stop(),delete this.markers,delete this.compass,delete this.gyroscope,super.destroy()}handleEvent(i){(i instanceof nr.StopAllEvent||i instanceof nr.ClickEvent)&&this.stop()}isEnabled(){return this.state.enabled}start(){return this.viewer.enterFullscreen(),this.__startWakelock(),this.__lockOrientation(),this.gyroscope.start("fast").then(()=>{var i,t;this.viewer.renderer.setCustomRenderer(e=>new vz(e)),this.state.enabled=!0,(i=this.markers)==null||i.hideAllMarkers(),(t=this.compass)==null||t.hide(),this.viewer.navbar.hide(),this.viewer.panel.hide(),this.dispatchEvent(new xo(!0)),this.viewer.notification.show({content:this.viewer.config.lang.stereoNotification,timeout:3e3})},()=>(this.__unlockOrientation(),this.__stopWakelock(),this.viewer.exitFullscreen(),Promise.reject()))}stop(){var i,t;this.isEnabled()&&(this.viewer.renderer.setCustomRenderer(null),this.state.enabled=!1,(i=this.markers)==null||i.showAllMarkers(),(t=this.compass)==null||t.show(),this.viewer.navbar.show(),this.__unlockOrientation(),this.__stopWakelock(),this.viewer.exitFullscreen(),this.gyroscope.stop(),this.dispatchEvent(new xo(!1)))}toggle(){this.isEnabled()?this.stop():this.start()}__startWakelock(){"wakeLock"in navigator?navigator.wakeLock.request("screen").then(i=>{this.state.wakeLock=i}).catch(()=>Id.logWarn("Cannot acquire WakeLock")):Id.logWarn("WakeLock is not available")}__stopWakelock(){this.state.wakeLock&&(this.state.wakeLock.release(),this.state.wakeLock=null)}__lockOrientation(){var e;let i;const t=()=>{window.innerHeight>window.innerWidth&&this.viewer.overlay.show({id:hg,image:yz,title:this.viewer.config.lang.pleaseRotate,text:this.viewer.config.lang.tapToContinue}),i&&(clearTimeout(i),i=null)};(e=window.screen)!=null&&e.orientation?(window.screen.orientation.lock("landscape").then(null,()=>t()),i=setTimeout(()=>t(),500)):t()}__unlockOrientation(){var i;(i=window.screen)!=null&&i.orientation?window.screen.orientation.unlock():this.viewer.overlay.hide(hg)}};xz.id="stereo";On.lang[ff.id]="Stereo view";lx(ff,"caption:right");On.lang.stereoNotification="Tap anywhere to exit stereo view.";On.lang.pleaseRotate="Please rotate your device";On.lang.tapToContinue="(or tap to continue)";/*!
 * PhotoSphereViewer.AutorotatePlugin 5.1.5
 * @copyright 2023 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */var wz=Object.defineProperty,_z=(i,t)=>{for(var e in t)wz(i,e,{get:t[e],enumerable:!0})},bz={};_z(bz,{AutorotateEvent:()=>pr});var cx=class extends Sa{constructor(i){super(cx.type),this.autorotateEnabled=i}},pr=cx;pr.type="autorotate";var Mz=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.898-1-.102 0-.202-.1-.202-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.399 2.7.899.1 0 .2.101.2.199C6.3 34.4 12.9 39 20.5 39c7.602 0 14.102-4.6 16.9-11.1 0-.102.1-.102.199-.2 1.699-.601 2.699-1 2.801-1l.6-.3V14.3l-.5-.2zM6.701 11.5C9.7 7 14.8 4 20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.799-1-8.799-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5zM25.1 20.3L18.7 24c-.3.2-.7 0-.7-.5v-7.4c0-.4.4-.6.7-.4l6.399 3.8c.301.1.301.6.001.8zm9.4 8.901A16.421 16.421 0 0 1 20.5 37c-5.9 0-11.1-3.1-14-7.898-.2-.302.1-.602.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.602-2 .298-.1.5.198.398.499z"/></g><!--Created by Nick Bluth from the Noun Project--></svg>
`,Ez=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.899-1-.101 0-.2-.1-.2-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.4 2.7.9.1 0 .2.1.2.199C6.3 34.4 12.9 39 20.5 39c7.601 0 14.101-4.6 16.9-11.1 0-.101.1-.101.2-.2 1.699-.6 2.699-1 2.8-1l.6-.3V14.3l-.5-.2zM20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.8-1-8.8-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5C9.7 7 14.8 4 20.5 4zm0 33c-5.9 0-11.1-3.1-14-7.899-.2-.301.1-.601.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.601-2 .3-.1.5.2.399.5A16.422 16.422 0 0 1 20.5 37zm18.601-12.1c0 .1-.101.3-.2.3-2.5.9-10.4 3.6-18.4 3.6-7.1 0-15.6-2.699-18.3-3.6C2.1 25.2 2 25 2 24.9V16c0-.1.1-.3.2-.3 2.6-.9 10.6-3.6 18.2-3.6 7.5 0 15.899 2.7 18.5 3.6.1 0 .2.2.2.3v8.9z"/><path d="M18.7 24l6.4-3.7c.3-.2.3-.7 0-.8l-6.4-3.8c-.3-.2-.7 0-.7.4v7.4c0 .5.4.7.7.5z"/></g><!--Created by Nick Bluth from the Noun Project--></svg>
`,pf=class extends Yh{constructor(i){var t;super(i,{className:"psv-autorotate-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Ez,iconActive:Mz}),this.plugin=this.viewer.getPlugin("autorotate"),(t=this.plugin)==null||t.addEventListener(pr.type,this)}destroy(){var i;(i=this.plugin)==null||i.removeEventListener(pr.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(i){i instanceof pr&&this.toggleActive(i.autorotateEnabled)}onClick(){this.plugin.isEnabled()&&(this.plugin.config.autostartOnIdle=!1),this.plugin.toggle()}};pf.id="autorotate";var Sz=it.getConfigParser({autostartDelay:2e3,autostartOnIdle:!0,autorotateSpeed:it.parseSpeed("2rpm"),autorotatePitch:null,autorotateZoomLvl:null,keypoints:null,startFromClosest:!0},{autostartOnIdle:(i,{rawConfig:t})=>i&&it.isNil(t.autostartDelay)?(it.logWarn("autostartOnIdle requires a non null autostartDelay"),!1):i,autorotateSpeed:i=>it.parseSpeed(i),autorotatePitch:i=>it.isNil(i)?null:it.parseAngle(i,!0),autorotateZoomLvl:i=>it.isNil(i)?null:qh.clamp(i,0,100)}),bd=16;function ra(i){return[i.yaw,i.pitch]}var zn=class extends Ma{constructor(i,t){super(i,t),this.state={initialStart:!0,enabled:!1,idx:-1,curve:[],startStep:null,endStep:null,startTime:null,stepDuration:null,remainingPause:null,lastTime:null,tooltip:null},this.state.initialStart=!it.isNil(this.config.autostartDelay)}init(){super.init(),this.video=this.viewer.getPlugin("video"),this.markers=this.viewer.getPlugin("markers"),this.config.keypoints&&(this.setKeypoints(this.config.keypoints),delete this.config.keypoints),this.viewer.addEventListener(st.StopAllEvent.type,this),this.viewer.addEventListener(st.BeforeRenderEvent.type,this),this.video||this.viewer.addEventListener(st.KeypressEvent.type,this)}destroy(){this.viewer.removeEventListener(st.StopAllEvent.type,this),this.viewer.removeEventListener(st.BeforeRenderEvent.type,this),this.viewer.removeEventListener(st.KeypressEvent.type,this),delete this.video,delete this.markers,delete this.keypoints,super.destroy()}handleEvent(i){switch(i.type){case st.StopAllEvent.type:this.stop();break;case st.BeforeRenderEvent.type:{this.__beforeRender(i.timestamp);break}case st.KeypressEvent.type:i.key===bs.KEY_CODES.Space&&this.viewer.state.keyboardEnabled&&(this.toggle(),i.preventDefault());break}}setKeypoints(i){if(!i)this.keypoints=null;else{if(i.length<2)throw new _e("At least two points are required");this.keypoints=i.map((t,e)=>{const s={position:null,markerId:null,pause:0,tooltip:null};let r;if(typeof t=="string"?s.markerId=t:it.isExtendedPosition(t)?r=t:(s.markerId=t.markerId,s.pause=t.pause,r=t.position,t.tooltip&&typeof t.tooltip=="object"?s.tooltip=t.tooltip:typeof t.tooltip=="string"&&(s.tooltip={content:t.tooltip})),s.markerId){if(!this.markers)throw new _e(`Keypoint #${e} references a marker but the markers plugin is not loaded`);const a=this.markers.getMarker(s.markerId);s.position=ra(a.state.position)}else if(r)s.position=ra(this.viewer.dataHelper.cleanPosition(r));else throw new _e(`Keypoint #${e} is missing marker or position`);return s})}this.isEnabled()&&(this.stop(),this.start())}isEnabled(){return this.state.enabled}start(){this.isEnabled()||(this.viewer.stopAll(),this.keypoints?this.config.startFromClosest&&this.__shiftKeypoints():this.__animate(),this.state.initialStart=!1,this.state.enabled=!0,this.dispatchEvent(new pr(!0)))}stop(){!this.isEnabled()||(this.__reset(),this.__hideTooltip(),this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.state.enabled=!1,this.dispatchEvent(new pr(!1)))}toggle(){this.isEnabled()?this.stop():this.start()}reverse(){this.isEnabled()&&!this.keypoints&&(this.config.autorotateSpeed=-this.config.autorotateSpeed,this.__animate())}__animate(){let i;it.isNil(this.config.autorotateZoomLvl)?i=Promise.resolve():i=this.viewer.animate({zoom:this.config.autorotateZoomLvl,speed:`${this.viewer.config.zoomSpeed*2}rpm`}),i.then(()=>{var t;this.viewer.dynamics.position.roll({yaw:this.config.autorotateSpeed<0},Math.abs(this.config.autorotateSpeed/this.viewer.config.moveSpeed)),this.viewer.dynamics.position.goto({pitch:(t=this.config.autorotatePitch)!=null?t:this.viewer.config.defaultPitch},Math.abs(this.config.autorotateSpeed/this.viewer.config.moveSpeed))})}__reset(){this.state.idx=-1,this.state.curve=[],this.state.startStep=null,this.state.endStep=null,this.state.startTime=null,this.state.stepDuration=null,this.state.remainingPause=null,this.state.lastTime=null,this.state.tooltip=null}__beforeRender(i){(this.state.initialStart||this.config.autostartOnIdle)&&this.viewer.state.idleTime>0&&i-this.viewer.state.idleTime>this.config.autostartDelay&&this.start(),this.isEnabled()&&this.keypoints&&(this.state.startTime||(this.state.endStep=ra(this.viewer.getPosition()),this.__nextStep(),this.state.startTime=i,this.state.lastTime=i),this.__nextFrame(i))}__shiftKeypoints(){const i=ra(this.viewer.getPosition()),t=this.__findMinIndex(this.keypoints,e=>it.greatArcDistance(e.position,i));this.keypoints.push(...this.keypoints.splice(0,t))}__incrementIdx(){this.state.idx++,this.state.idx===this.keypoints.length&&(this.state.idx=0)}__showTooltip(){const i=this.keypoints[this.state.idx];if(i.tooltip){const t=this.viewer.dataHelper.vector3ToViewerCoords(this.viewer.state.direction);this.state.tooltip=this.viewer.createTooltip({content:i.tooltip.content,position:i.tooltip.position,top:t.y,left:t.x})}else if(i.markerId){const t=this.markers.getMarker(i.markerId);t.showTooltip(),this.state.tooltip=t.tooltip}}__hideTooltip(){if(this.state.tooltip){const i=this.keypoints[this.state.idx];i.tooltip?this.state.tooltip.hide():i.markerId&&this.markers.getMarker(i.markerId).hideTooltip(),this.state.tooltip=null}}__nextPoint(){const i=[];if(this.state.idx===-1){const r=ra(this.viewer.getPosition());i.push(r,r,this.keypoints[0].position,this.keypoints[1].position)}else for(let r=-1;r<3;r++){const a=this.state.idx+r<0?this.keypoints[this.keypoints.length-1]:this.keypoints[(this.state.idx+r)%this.keypoints.length];i.push(a.position)}const t=[new Vm(i[0][0],i[0][1])];let e=0;for(let r=1;r<=3;r++){const a=i[r-1][0]-i[r][0];a>Math.PI?e+=1:a<-Math.PI&&(e-=1),e!==0&&r===1&&(t[0].x-=e*2*Math.PI,e=0),t.push(new Vm(i[r][0]+e*2*Math.PI,i[r][1]))}const s=new VS(t).getPoints(bd*3).map(r=>[r.x,r.y]);this.state.curve=s.slice(bd+1,bd*2+1),this.state.idx!==-1?(this.state.remainingPause=this.keypoints[this.state.idx].pause,this.state.remainingPause?this.__showTooltip():this.__incrementIdx()):this.__incrementIdx()}__nextStep(){this.state.curve.length===0&&(this.__nextPoint(),this.state.endStep[0]=it.parseAngle(this.state.endStep[0])),this.state.startStep=this.state.endStep,this.state.endStep=this.state.curve.shift();const i=it.greatArcDistance(this.state.startStep,this.state.endStep);this.state.stepDuration=i*1e3/Math.abs(this.config.autorotateSpeed),i===0&&this.__nextStep()}__nextFrame(i){const t=i-this.state.lastTime;if(this.state.lastTime=i,this.state.remainingPause){if(this.state.remainingPause=Math.max(0,this.state.remainingPause-t),this.state.remainingPause>0)return;this.__hideTooltip(),this.__incrementIdx(),this.state.startTime=i}let e=(i-this.state.startTime)/this.state.stepDuration;e>=1&&(this.__nextStep(),e=0,this.state.startTime=i),this.viewer.rotate({yaw:this.state.startStep[0]+(this.state.endStep[0]-this.state.startStep[0])*e,pitch:this.state.startStep[1]+(this.state.endStep[1]-this.state.startStep[1])*e})}__findMinIndex(i,t){let e=0,s=Number.MAX_VALUE;return i.forEach((r,a)=>{const l=t(r);l<s&&(s=l,e=a)}),e}};zn.id="autorotate";zn.configParser=Sz;zn.readonlyOptions=["keypoints"];Gh(pf,"start");In.lang[pf.id]="Automatic rotation";const Az=Rd({name:"CommentComponent",props:{point:{type:Object,required:!0},map:{type:Object,required:!0},photo:{type:String,required:!0},markerPointPosition:{type:Object}},setup(i,t){const e=pg("store");Z(e.state.user);const s=xg(),r=ba();r.appContext.config.globalProperties.$imgUrl;const a=Z(r.appContext.config.globalProperties.$baseUrl),l=Z(`${a.value}avatars/${e.state.user.username}.jpg`),u=mg();Z(u.params.site);const c=Z(""),d=Z(null),f=Z(null),m=Z(!1),g=Z(null),v=Z([]),x=Z(null),b=Z(!1),E=Z(""),S=Z(!1),z=Z({}),I=Z(e.state.user.isAdmin),O=Z(["Google","Facebook","Twitter","Apple","Oracle"]),P=Z([]),G=Z();Wh(i,async ot=>{console.log("watch-props",ot),v.value=await Lt(i.point.id),S.value&&(z.value.marker=i.markerPointPosition)},{deep:!0});const $=()=>{d.value.click()},_t=ot=>{if(ot){const X=WS(new Date(ot*1e3),new Date);return X.includes("less")?X:X+" ago."}else return"-"},zt=ot=>{s.notify({position:"top",message:ot,color:"purple"})},j=ot=>{x.value=ot.target.files[0],x.value&&(f.value=URL.createObjectURL(x.value))},lt=ot=>{console.log("goto Point",ot),t.emit("gotoPoint",ot)},ut=()=>{console.log("add marker",z.value),zt("Click point to mark"),m.value=!m.value,m.value==!1?S.value?(t.emit("deletePoint",z.value.marker),z.value.marker=!1):(t.emit("deletePoint",i.markerPointPosition),i.markerPointPosition={}):t.emit("addPoint",m.value)},ht=()=>{f.value="",x.value="",z.value.attachPhoto=!1},Ft=ot=>{g.value=ot},tt=()=>{if(c.value!=="")if(S.value){console.log("commentid",z.value.id);const ot={id:z.value.id,site_id:i.map.site_id,map_id:i.map.id,point_id:i.point.id,photo_id:i.photo,text:c.value,attachPhoto:!!(f.value||z.value.attachPhoto||x.value),marker:z.value.marker,tag:g.value,postby:e.state.user.username,modified:Math.floor(Date.now()/1e3)},X=new FormData;X.append("data",JSON.stringify(ot)),x.value&&X.append("commentPhoto",x.value),console.log("attachPhoto",z.value.attachPhoto),console.log("file.value",x.value),console.log("proviewImage",f.value),console.log("data",ot),Ne.post("/updatecomment",X,{headers:{"Content-Type":"multipart/form-data",Authorization:e.state.token}}).then(async Dt=>{console.log("Comment updated successfully",Dt.data.results);const fe=v.value.findIndex(We=>We.id==Dt.data.results.id);fe!=-1&&(v.value[fe]=Dt.data.results),c.value="",z.value.attachPhoto="",z.value.marker=!1,f.value="",g.value="",m.value=!1,S.value=!1})}else{console.log("props->",i);const ot=new FormData,X={id:Math.floor(Date.now()/1e3),site_id:i.map.site_id,map_id:i.map.id,point_id:i.point.id,photo_id:i.photo,text:c.value,attachPhoto:!!x.value,marker:m.value?i.markerPointPosition:!1,tag:g.value,postby:e.state.user.username,modified:Math.floor(Date.now()/1e3)};ot.append("data",JSON.stringify(X)),x.value&&ot.append("commentPhoto",x.value),Ne.post("/addcomment",ot,{headers:{"Content-Type":"multipart/form-data",Authorization:e.state.token}}).then(async Dt=>{console.log("Comment submitted successfully",Dt.data.results),v.value.push(Dt.data.results),e.state.total_comment++,c.value="",f.value="",x.value="",g.value="",m.value=!1,S.value=!1})}else zt("text is required.")},Lt=ot=>Ne.post("/getcomment",{data:{id:ot}},{headers:{"Content-Type":"application/json",Authorization:e.state.token}}).then(X=>X.data.results),V=ot=>{b.value=!0,E.value=`${a.value}comments/${ot}/${ot}.jpg`},J=ot=>{s.dialog({title:"Confirm",message:"Would you like to delete comment?",cancel:!0,persistent:!0}).onOk(()=>{console.log("delete comment",ot),Ne.post("/deletecomment",{data:{id:ot}},{headers:{"Content-Type":"application/json",Authorization:e.state.token}}).then(async X=>{v.value=v.value.filter(Dt=>Dt.id!=ot),e.state.total_comment--,console.log("Data submitted successfully",X.data.results),zt("Delete comment successfully.")})})},pt=ot=>{console.log("edit",ot),S.value=!0,f.value="",z.value.id=ot.id,z.value.marker=ot.marker,z.value.attachPhoto=ot.attachPhoto,ot.marker?(m.value=!0,lt(ot.marker.position),z.marker=ot.marker):m.value=!1,c.value=ot.text,g.value=ot.tag,t.emit("gotoBottom"),G.value.focus()},mt=()=>{S.value=!1,c.value="",z.value.attachPhoto="",z.value.marker=!1,i.markerPointPosition={},f.value="",g.value="",m.value=!1},Tt=async ot=>{c.value=ot;const X=ot.split("@"),Dt=X[X.length-1];ot.indexOf("@")!=-1?P.value=O.value.filter(fe=>fe.fname.indexOf(Dt)>-1):P.value=[]},ss=ot=>{const X=c.value.lastIndexOf("@");if(X>=0){const Dt=c.value.slice(0,X);if(ot.empn=="0")c.value=`${Dt} @All `;else{const fe=ot.fname;c.value=`${Dt} @${fe}(${ot.empn}) `}P.value=[],G.value.focus()}},mi=ot=>Ne.post("/getuser",{},{headers:{"Content-Type":"application/json",Authorization:e.state.token}}).then(X=>X.data.results);return gg(async()=>{S.value=!1,f.value=!1,z.value={},c.value="",v.value=await Lt(i.point.id);const ot=await mi();O.value=ot.map(X=>({empn:X.username,name:X.userEGAT.person_thai_name,fname:X.userEGAT.person_thai_thai_firstname}))}),{cancelEdit:mt,users:O,options:P,handleInput:Tt,selectUser:ss,inputRef:G,isAdmin:I,edit:S,commentEdit:z,editComment:pt,deleteComment:J,dAgo:_t,store:e,gotoPoint:lt,bigImgUrl:E,dialog:b,preview:V,submitComment:tt,comments:v,addMarker:ut,marker:m,avatarUrl:l,baseUrl:a,commentText:c,openFilePicker:$,fileInput:d,handleFileSelected:j,previewImage:f,clearPhoto:ht,onItemClick:Ft,tag:g}}}),kz=i=>(SS("data-v-b214cd96"),i=i(),AS(),i),Cz={class:"q-pa-none bg-grey-9"},zz={class:"text-Subtitle q-pa-md"},Tz={key:0},Oz=["src"],Iz={class:"col-10"},Lz={key:0,class:"text-primary text-weight-bold"},Pz=["innerHTML"],Rz={class:"text-right q-ma-xs text-weight-light text-grey-8 text-caption"},Fz={key:1},$z=kz(()=>Ct("div",{class:"absolute-full flex flex-center bg-grey-1 text-grey-9"}," Reload image ",-1)),Bz={key:5,class:"q-gutter-none"},Nz={class:"q-pa-none"},Uz={key:0,class:"flex q-mx-md q-my-sm items-start"},Dz={key:1,class:"flex q-ma-md items-start"},Vz=["src"],Hz=["src"],Wz={class:"q-mb-lg q-mx-sm q-pl-none q-gutter-none"};function qz(i,t,e,s,r,a){return nt(),le(ca,null,[Ct("div",Cz,[Ct("div",zz,[Bt(" Comments "),i.comments.length?(nt(),le("span",Tz,"("+we(i.comments.length)+")",1)):xt("",!0),(nt(!0),le(ca,null,Md(i.comments,(l,u)=>(nt(),le("div",{key:u,class:"row justify-start q-mt-md q-gutter-sm"},[Ct("div",null,[q(zc,{size:"md"},{default:Y(()=>[Ct("img",{src:`${i.baseUrl}avatars/${l.postby}.jpg`},null,8,Oz)]),_:2},1024)]),Ct("div",Iz,[q(da,{flat:"",bordered:"",class:"bg-grey-3 rounded-comment"},{default:Y(()=>[q(Oh,{class:"text-grey-9 bg-grey-3 q-pa-sm"},{default:Y(()=>[l.users?(nt(),le("div",Lz,we(l.users[0].userEGAT.person_thai_name),1)):xt("",!0),Ct("div",{innerHTML:l.text,style:{"white-space":"pre-line"}},null,8,Pz),Ct("div",Rz,we(i.dAgo(l.modified)),1),l.attachPhoto?(nt(),le("div",Fz,[q(aa,{loading:"lazy",onClick:c=>i.preview(l.id),class:"rounded-div q-mt-md","spinner-color":"deep-orange",style:{width:"180px"},src:`${i.baseUrl}comments/${l.id}/cover.jpg`},{error:Y(()=>[$z]),_:2},1032,["onClick","src"])])):xt("",!0)]),_:2},1024),i.isAdmin||l.tag||l.postby==i.store.state.user.username?(nt(),Mt(vg,{key:0,class:"text-grey-8 bg-grey-2"},{default:Y(()=>[l.marker?(nt(),Mt(jt,{key:0,title:"See mark point",onClick:c=>i.gotoPoint(l.marker.position),rounded:"",color:"deep-orange",icon:"my_location","no-caps":"",flat:"",size:"md"},{default:Y(()=>[Bt("Go to")]),_:2},1032,["onClick"])):xt("",!0),l.tag=="goodjob"?(nt(),Mt(mn,{key:1,size:"sm",dense:"",color:"teal","text-color":"white",icon:"thumb_up"},{default:Y(()=>[Bt("Good Job")]),_:1})):xt("",!0),l.tag=="defect"?(nt(),Mt(mn,{key:2,size:"sm",dense:"",color:"red","text-color":"white",icon:"build_circle"},{default:Y(()=>[Bt("Defect")]),_:1})):xt("",!0),l.tag=="action"?(nt(),Mt(mn,{key:3,size:"sm",dense:"",color:"green","text-color":"white",icon:"schedule"},{default:Y(()=>[Bt("Action")]),_:1})):xt("",!0),l.tag=="question"?(nt(),Mt(mn,{key:4,size:"sm",dense:"",color:"primary","text-color":"white",icon:"help"},{default:Y(()=>[Bt("Question")]),_:1})):xt("",!0),q(Ih),l.postby==i.store.state.user.username||i.isAdmin?(nt(),le("div",Bz,[q(jt,{title:"Edit comment",rounded:"",onClick:c=>i.editComment(l),icon:"edit",flat:"",size:"sm"},null,8,["onClick"]),q(jt,{title:"Delete comment",rounded:"",onClick:c=>i.deleteComment(l.id),icon:"delete",flat:"",size:"sm"},null,8,["onClick"])])):xt("",!0)]),_:2},1024)):xt("",!0)]),_:2},1024)])]))),128))]),i.comments.length?(nt(),Mt(fh,{key:0,color:"grey-7",class:"q-mx-sm"})):xt("",!0),Ct("div",Nz,[i.previewImage?(nt(),le("div",Uz,[q(aa,{class:"rounded-div",src:i.previewImage,alt:"Preview"},null,8,["src"]),q(jt,{color:"red",flat:"",icon:"delete",onClick:i.clearPhoto},null,8,["onClick"])])):xt("",!0),i.edit||i.commentEdit.attachPhoto?(nt(),le("div",Dz,[i.commentEdit.attachPhoto?(nt(),Mt(aa,{key:0,class:"rounded-div",src:`${i.baseUrl}comments/${i.commentEdit.id}/cover.jpg`,alt:"Preview"},null,8,["src"])):xt("",!0),i.commentEdit.attachPhoto?(nt(),Mt(jt,{key:1,color:"red",flat:"",icon:"delete",onClick:t[0]||(t[0]=l=>i.commentEdit.attachPhoto=!1)})):xt("",!0)])):xt("",!0),i.commentEdit.marker?(nt(),Mt(jt,{key:2,onClick:t[1]||(t[1]=l=>i.gotoPoint(i.commentEdit.marker.position)),rounded:"",color:"deep-orange",icon:"my_location","no-caps":"",flat:"",size:"md"},{default:Y(()=>[Bt("Go to")]),_:1})):xt("",!0),i.tag=="goodjob"?(nt(),Mt(mn,{key:3,class:"q-ml-md",dense:"",color:"teal","text-color":"white",icon:"thumb_up"},{default:Y(()=>[Bt("Good Job")]),_:1})):xt("",!0),i.tag=="defect"?(nt(),Mt(mn,{key:4,class:"q-ml-md",dense:"",color:"red","text-color":"white",icon:"build_circle"},{default:Y(()=>[Bt("Defect")]),_:1})):xt("",!0),i.tag=="action"?(nt(),Mt(mn,{key:5,class:"q-ml-md",dense:"",color:"green","text-color":"white",icon:"schedule"},{default:Y(()=>[Bt("Action")]),_:1})):xt("",!0),i.tag=="question"?(nt(),Mt(mn,{key:6,class:"q-ml-md",dense:"",color:"primary","text-color":"white",icon:"help"},{default:Y(()=>[Bt("Question")]),_:1})):xt("",!0),i.options.length?(nt(),Mt(Sd,{key:7,bordered:"",class:"bg-grey-3 q-ml-md q-mr-lg"},{default:Y(()=>[Li((nt(),Mt(kn,{clickable:"",onClick:t[2]||(t[2]=l=>i.selectUser({empn:"0"}))},{default:Y(()=>[q(Ii,{avatar:""},{default:Y(()=>[q(zc,{size:"xs"},{default:Y(()=>[Ct("img",{src:"/icons/all.png"},null,8,Vz)]),_:1})]),_:1}),q(Ii,{class:"text-grey-9"},{default:Y(()=>[Bt("All")]),_:1})]),_:1})),[[Bm]]),(nt(!0),le(ca,null,Md(i.options,(l,u)=>Li((nt(),Mt(kn,{clickable:"",key:u,onClick:c=>i.selectUser(l)},{default:Y(()=>[q(Ii,{avatar:""},{default:Y(()=>[q(zc,{size:"sm"},{default:Y(()=>[Ct("img",{src:`${i.baseUrl}avatars/${l.empn}.jpg`},null,8,Hz)]),_:2},1024)]),_:2},1024),q(Ii,{class:"text-grey-9"},{default:Y(()=>[Bt(we(l.fname),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[Bm]])),128))]),_:1})):xt("",!0),q(oa,{ref:"inputRef",class:"q-px-md q-pt-sm q-pb-none bg-grey-9",rounded:"",autogrow:"",dense:"",dark:"",standout:"","bottom-slots":"",modelValue:i.commentText,"onUpdate:modelValue":[t[3]||(t[3]=l=>i.commentText=l),i.handleInput],placeholder:"Type '@' to mention a user"},{after:Y(()=>[i.edit?(nt(),Mt(jt,{key:0,rounded:"",dense:"",flat:"",color:"red",icon:"close",onClick:i.cancelEdit},null,8,["onClick"])):xt("",!0),i.commentText.length>0?(nt(),Mt(jt,{key:1,color:"primary",rounded:"",dense:"",flat:"",icon:"send",onClick:i.submitComment},null,8,["onClick"])):xt("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"]),Ct("div",Wz,[Ct("input",{type:"file",ref:"fileInput",style:{display:"none"},onChange:t[4]||(t[4]=(...l)=>i.handleFileSelected&&i.handleFileSelected(...l))},null,544),!i.previewImage&&!i.commentEdit.attachPhoto?(nt(),Mt(jt,{key:0,onClick:i.openFilePicker,rounded:"",flat:"",icon:"attach_file",size:"sm",label:"Add Photo"},null,8,["onClick"])):xt("",!0),q(jt,{rounded:"",flat:"",icon:"my_location",size:"sm",color:i.marker?"primary":"grey-1",label:i.marker?"Remove":"Add Point",onClick:i.addMarker},null,8,["color","label","onClick"]),q(LS,{rounded:"",flat:"",icon:"sell",size:"sm",label:"Add Tag"},{default:Y(()=>[q(Sd,null,{default:Y(()=>[Li((nt(),Mt(kn,{clickable:"",onClick:t[5]||(t[5]=l=>i.onItemClick("goodjob"))},{default:Y(()=>[q(Ii,null,{default:Y(()=>[q(ao,null,{default:Y(()=>[q(Tn,{name:"thumb_up",color:"teal",size:"sm"}),Bt(" Good Job")]),_:1})]),_:1})]),_:1})),[[rr]]),Li((nt(),Mt(kn,{clickable:"",onClick:t[6]||(t[6]=l=>i.onItemClick("defect"))},{default:Y(()=>[q(Ii,null,{default:Y(()=>[q(ao,null,{default:Y(()=>[q(Tn,{name:"build_circle",color:"red",size:"sm"}),Bt(" Defect")]),_:1})]),_:1})]),_:1})),[[rr]]),Li((nt(),Mt(kn,{clickable:"",onClick:t[7]||(t[7]=l=>i.onItemClick("action"))},{default:Y(()=>[q(Ii,null,{default:Y(()=>[q(ao,null,{default:Y(()=>[q(Tn,{name:"schedule",color:"green",size:"sm"}),Bt(" Action")]),_:1})]),_:1})]),_:1})),[[rr]]),Li((nt(),Mt(kn,{clickable:"",onClick:t[8]||(t[8]=l=>i.onItemClick("question"))},{default:Y(()=>[q(Ii,null,{default:Y(()=>[q(ao,null,{default:Y(()=>[q(Tn,{name:"help",color:"primary",size:"sm"}),Bt(" Question")]),_:1})]),_:1})]),_:1})),[[rr]])]),_:1})]),_:1})])])]),q(Ed,{modelValue:i.dialog,"onUpdate:modelValue":t[11]||(t[11]=l=>i.dialog=l),persistent:"",maximized:"","transition-show":"slide-up","transition-hide":"slide-down"},{default:Y(()=>[q(da,{class:"bg-primary text-white"},{default:Y(()=>[q(HS,null,{default:Y(()=>[q(Ih),q(jt,{dense:"",flat:"",icon:"minimize",onClick:t[9]||(t[9]=l=>i.maximizedToggle=!1),disable:!i.maximizedToggle},{default:Y(()=>[i.maximizedToggle?(nt(),Mt(Oc,{key:0,class:"bg-white text-primary"},{default:Y(()=>[Bt("Minimize")]),_:1})):xt("",!0)]),_:1},8,["disable"]),q(jt,{dense:"",flat:"",icon:"crop_square",onClick:t[10]||(t[10]=l=>i.maximizedToggle=!0),disable:i.maximizedToggle},{default:Y(()=>[i.maximizedToggle?xt("",!0):(nt(),Mt(Oc,{key:0,class:"bg-white text-primary"},{default:Y(()=>[Bt("Maximize")]),_:1}))]),_:1},8,["disable"]),Li((nt(),Mt(jt,{dense:"",flat:"",icon:"close"},{default:Y(()=>[q(Oc,{class:"bg-white text-primary"},{default:Y(()=>[Bt("Close")]),_:1})]),_:1})),[[rr]])]),_:1}),q(Oh,{class:"fullscreen-img-container"},{default:Y(()=>[q(aa,{class:"fullscreen-img",fit:"contain",src:i.bigImgUrl},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Gz=Fd(Az,[["render",qz],["__scopeId","data-v-b214cd96"]]);const Yz=Rd({name:"PhotoSphereComponent",components:{Comments:Gz},setup(){const i=pg("store"),t=ba(),e=mg(),s=Z(e.params.site);t.appContext.config.globalProperties.$baseUrl;const r=t.appContext.config.globalProperties.$imgUrl;Z(t.appContext.config.globalProperties.$userProfile);const a=xg(),l=Z(!!i.state.token),u=Z(i.state.user.isAdmin),c=Z(i.state.user),d=Z(),f=Z(),m=Z(),g=20,v=Z(!1),x=Z([]),b=Z(!1),E=Z(),S=Z(),z=Z(),I=Z(),O=Z(!1),P=Z(),G=Z(),$=Z(),_t=Z(!1),zt=Z(),j=Z([]),lt=Z(),ut=Z(!1),ht=Z([{label:"Hotspot",id:"hotspot",description:"Goto next hotspot",icon:"my_location"},{label:"Note",id:"note",description:"Label information",icon:"not_listed_location"},{label:"Link",id:"link",description:"Goto to website",icon:"link"}]),Ft=Z(ht.value[0]),tt=Z(),Lt=Z(!1),V=Z(!1),J=Z(!1),pt=Z(!0),mt=Z([]),Tt=Z([]),ss=["hotspot-w","hotspot-b","arrow-w","arrow-b","location-w","location-b","info-w","info-b","note-w","note-b","link-w","link-b"];ss.map(R=>{Tt.value.push({label:`<img src="/icons/markers/${R}.png" style="height: 40px;">`,value:`${R}`,html:!0})});const mi=Z(Tt.value[0]),ot=Z();let X,Dt;const fe=Z(!0),We=Z(!1),Ni=Z({}),mr=Z(null),Pe=Z([]),sn=()=>Ne.post("/loadsites",{data:{site:s.value}},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(R=>R.data.results),Rn=R=>Ne.post("/getphoto_id",{data:{id:R}},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>W.data.results),Ee=(R,W,at)=>Ne.post("/updatephoto_id",{data:{id:R,position:W,zoom:at}},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(Ot=>(console.log("get photo by id",R,Ot.data.results),Ot.data.results)),gi=R=>Ne.post("/addMarker",{data:R},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>(console.log("add Markder",R,W.data.results),W.data.results)),Fn=R=>Ne.post("/getMarker",{data:R},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>W.data.results),qe=R=>Ne.post("/deleteMarker",{data:{id:R}},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>(console.log("delete Marker",W.data.results),W.data.results)),Ss=R=>Ne.post("/updateMarker",{data:R},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>(console.log("update Marker",W.data.results),W.data.results)),$n=(R,W)=>{const at=W[0].point_id;return W.map(Ot=>{const re={width:Ot.size.width,cols:16,rows:8,baseUrl:`${R}/${at}/${Ot.id}/low.jpg`,tileUrl:(zs,ee)=>`${R}/${at}/${Ot.id}/${zs}_${ee}.jpg`},Cs=`${R}/${at}/${Ot.id}/thumbnail.jpg`;return{id:Ot.id,panorama:re,exif:Ot.gps,thumbnail:Cs,name:Sl(Ot.id),timestamp:Ot.timestamp}})},ns=async R=>{X.destroy(),console.log("dropdown",R);const W=G.value.findIndex(at=>at.id===R.id);if(W!==-1){f.value=G.value[W],d.value=x.value[W];const at={site_id:s.id,map_id:d.value.id,point_id:0,photo_id:0};Lr.set("route",at),gr(d.value)}},Re=async R=>{X.destroy(),console.log("dropdown",R);const W=mt.value.findIndex(at=>at.id===R.id);if(W!==-1){m.value=mt.value[W];const at={site_id:s.id,map_id:d.value.id,point_id:m.value.id,photo_id:0};Lr.set("route",at),gr(d.value)}};async function As(R){return(await Ne.get(R,{responseType:"blob"})).data}const nn=()=>{console.log("photos lists",j.value),j.value.map(R=>{As(R.panorama.baseUrl).then(W=>{if(console.log(R.exif),R.exif.ModifyDate){const at=new File([W],`${R.id}$${R.exif.ModifyDate}$j.jpg`,{type:W.type});lt.value.addFiles([at])}else{const at=new File([W],`${R.id}$j.jpg`,{type:W.type});lt.value.addFiles([at])}})}),_t.value=!0,zt.value=Al(new Date),Lt.value=!0},Eo=(R,W)=>{a.dialog({title:"Confirm",message:"Would you like to delete photo?",cancel:!0,persistent:!0}).onOk(()=>{const at=parseInt(W.name.split("$")[0]);console.log(">>>> OK photo id",W.name,at),R.removeFile(W);const Ot=j.value.findIndex(re=>re.id===at);Ot!==-1&&(rs(at),j.value.splice(Ot,1),X.getPlugin(Cn).setItems(j.value))}).onCancel(()=>{console.log(">>>> Cancel")})},rs=R=>{console.log("delete ",R),Ne.post("/deletephoto",{data:{id:R,site_id:parseInt(s.value),map_id:parseInt(G.value[0].id),point_id:parseInt(z.value.id)}},{headers:{"Content-Type":"application/json",Authorization:i.state.token}}).then(W=>{console.log("delete photo ",W.data)})},So=R=>{const W=R.filter(at=>!at.name.includes("$"));Pe.value.push(...W)},Ui=R=>{if(R.includes("$")){const W=R.split("$").length;if(W==3){const at=R.split("$")[1];return Al(parseInt(at*1e3))}else if(W==2){const at=R.split("$")[1];return Al(parseInt(at*1e3))}}else return"*"+R},os=()=>{console.log("submit photo",Pe.value);const R=new FormData,W={site_id:s.value,point:{id:parseInt(z.value.id),map_id:parseInt(G.value[0].id),postby:i.state.user.username}};R.append("data",JSON.stringify(W)),R.append("filePhoto",Pe.value),Pe.value.forEach((at,Ot)=>{R.append(`filePhoto[${Ot}]`,at)}),Pe.value.length>0?Ne.post("/addphoto",R,{headers:{"Content-Type":"multipart/form-data",Authorization:i.state.token}}).then(async at=>{console.log("Data submitted successfully",at.data.results),a.notify({position:"top",message:"Photos submitted successfully",color:"purple"}),_t.value=!1}).catch(at=>{console.error("Error submitting data",at)}):gn("Photo is required.")},Bn=()=>{console.log("click focus",P.value),Ee(P.value,X.getPosition(),X.getZoomLevel()),gn("Set Heading done.")},Nn=()=>{X.animate({yaw:4.029562733498638,pitch:-.05019066682177886,zoom:80,speed:"30rpm"}).then(()=>{})},Un=R=>{console.log("click addon",R)},Dn=()=>{if(note.value.title){const R={type:"note",point_id:z.value.id,photo_id:null,...tt.value,image:"/icons/not_listed_location.png",tooltip:note.value.title,text:note.value.text,hoverScale:!0},W=X.getPlugin(Ke);if(V.value){const at={...R,id:note.value.id};Ss(at),W.updateMarker({id:note.value.id,content:note.value.text,tooltip:note.value.title}),V.value=!1}else gi(R),W.updateMarker({id:tt.value.id,image:"/icons/not_listed_location.png",content:note.value.text,tooltip:note.value.title,hoverScale:!0})}else gn("Title is required!");ut.value=!1},H=()=>{V.value||X.getPlugin(Ke).removeMarker(tt.value.id)},gt=()=>{if(link.value.url){const R={type:"link",point_id:z.value.id,photo_id:null,...tt.value,image:"/icons/link.png",tooltip:link.value.title,url:link.value.url};console.log("add link",R);const W=X.getPlugin(Ke);if(V.value){const at={...R,id:link.value.id};console.log("update ..",at),Ss(at),W.updateMarker({id:link.value.id,tooltip:link.value.title}),V.value=!1}else gi(R),console.log("add link",tt.value.id),W.updateMarker({id:tt.value.id,image:"/icons/link.png",tooltip:link.value.title})}else gn("Link Url is required!");ut.value=!1},Pt=()=>{V.value=!V.value,V.value?(gn("Select a marker to edit"),J.value=!1):gn("Edit marker disabled")},Nt=()=>{J.value=!J.value,J.value?(gn("Select a marker to move"),V.value=!1):gn("Move marker disabled")},Kt=()=>{console.log("select",tt.value.type.id);const R=X.getPlugin(Ke),W={...tt.value,tooltip:tt.value.type.id=="hotspot"?tt.value.to_point_id.label:tt.value.title};V.value?(console.log("edit marker",W),Ss(W),R.updateMarker(W),V.value=!1):(console.log("add marker",W),R.updateMarker(W),gi(W)),ut.value=!1},vi=()=>{a.dialog({title:"Confirm",message:"Delete marker?",cancel:!0,persistent:!0}).onOk(()=>{ut.value=!1,console.log(">>>> delele marker  = ",tt.value.id);const R=X.getPlugin(Ke);qe(tt.value.id),R.removeMarker(tt.value.id)}).onCancel(()=>{console.log("Cancel")}).onDismiss(()=>{console.log("OK and Cancel")})},ks=Z(!1),rn=()=>{console.log("split point",z.value),ks.value=!ks.value,b.value=!b;const R=$.value[0].photos.filter(zs=>zs.point_id===z.value.id),W=`${r}/${s.value}/${z.value.map_id}/${z.value.id}/${R[0].id}`;Dt=new Hm({container:S.value,adapter:Wm,panorama:{width:R[0].size.width,cols:16,rows:8,baseUrl:`${W}/low.jpg`,tileUrl:(zs,ee)=>`${W}/${zs}_${ee}.jpg`},caption:z.value.name,defaultZoomLvl:0,fisheye:!0,navbar:["zoom","fullscreen","gallery","caption",{id:"comment-button",content:'<svg width="32px" height="32px" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Edit / Close_Square"> <path id="Vector" d="M9 9L11.9999 11.9999M11.9999 11.9999L14.9999 14.9999M11.9999 11.9999L9 14.9999M11.9999 11.9999L14.9999 9M4 16.8002V7.2002C4 6.08009 4 5.51962 4.21799 5.0918C4.40973 4.71547 4.71547 4.40973 5.0918 4.21799C5.51962 4 6.08009 4 7.2002 4H16.8002C17.9203 4 18.4801 4 18.9079 4.21799C19.2842 4.40973 19.5905 4.71547 19.7822 5.0918C20.0002 5.51962 20.0002 6.07967 20.0002 7.19978V16.7998C20.0002 17.9199 20.0002 18.48 19.7822 18.9078C19.5905 19.2841 19.2842 19.5905 18.9079 19.7822C18.4805 20 17.9215 20 16.8036 20H7.19691C6.07899 20 5.5192 20 5.0918 19.7822C4.71547 19.5905 4.40973 19.2842 4.21799 18.9079C4 18.4801 4 17.9203 4 16.8002Z" stroke="#f00" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg>',title:"Close Panel",className:"custom-button",onClick:zs=>{b.value=!0,fe.value=!1}}],plugins:[[Cn,{visibleOnLoad:!0}]]});const at=Dt.getPlugin(Cn);j.value=$n(`${r}/${s.value}/${z.value.map_id}`,R);const Ot=Ao(j.value);at.setItems(Ot);const re=X.getPosition(),Cs=X.getZoomLevel();Dt.rotate({yaw:re.yaw,pitch:re.pitch}),Dt.zoom(Cs),fe.value=!0},Oa=(R,W,at,Ot)=>{let re={height:"calc(100vh - 50px)"};return bl.is.platform=="iphone"?re={height:"calc(100vh - 125px)"}:bl.is.platform=="ipad"&&(re={height:"calc(100vh - 85px)"}),a.screen.gt.sm?b.value=!0:b.value=!1,new Hm({container:R,adapter:Wm,panorama:W,size:re,caption:at,defaultZoomLvl:0,touchmoveTwoFingers:!1,mousewheelCtrlKey:!1,fisheye:!0,moveInertia:!0,navbar:["zoom","autorotate","fullscreen","gallery","markers","markersList","caption","description","stereo",{id:"comment-button",content:'<svg width="18px" height="20px" viewBox="0 -0.5 17 17" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="si-glyph si-glyph-jump-page-left-right" fill="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <title>659</title> <defs> </defs> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g transform="translate(1.000000, 0.000000)" fill="#ffffff"> <path d="M5.958,8.951 L5.958,7.007 L3.979,7.007 L3.97900001,5.06677246 C3.97900001,4.57762889 0.265,7.332 0.265,7.332 C-0.095,7.696 -0.095,8.29 0.264,8.655 C0.264,8.655 3.97900001,11.4734899 3.97900001,10.9475709 L3.979,8.951 L5.958,8.951 Z" class="si-glyph-fill"> </path> <path d="M10.002,7 L10.002,8.973 L12.048,8.973 L12.048,11 C12.048,11.4553833 15.695,8.684 15.695,8.684 C16.055,8.336 16.055,7.771 15.695,7.423 C15.695,7.423 11.980774,4.64377734 11.980774,5.03546143 L12.048,7 L10.002,7 Z" class="si-glyph-fill"> </path> <rect x="7" y="0" width="2" height="16" class="si-glyph-fill"> </rect> </g> </g> </g></svg>',title:"Comments (3)",className:"custom-button",onClick:Cs=>{console.log("click togle"),b.value=!b.value}}],plugins:[[va,{size:"100px"}],[ho,Ot],[Ke],[Cn,{visibleOnLoad:!1}],[zn,{autorotatePitch:"0deg",autostartOnIdle:!1}]]})},as=Z(),Ao=R=>R.sort((W,at)=>at.id-W.id),gr=async R=>{const W=$.value[0],at=`${r}/${R.site_id}/${R.id}`,re=W.points.filter(he=>he.map_id===R.id);let Cs=0,ee=re.map(he=>{if(W.photos.filter(zo=>zo.point_id===he.id).length>0)return Cs++,{id:he.id,x:he.x+12,y:he.y+12,tooltip:he.name,color:Cs==1?"red":"yellow"}}).filter(he=>he!==void 0);const Ts=Lr.getItem("route");let ls;if(Ts?Ts.point_id?ls=W.photos.filter(he=>he.point_id===parseInt(Ts.point_id)):ls=W.photos.filter(he=>he.point_id===ee[0].id):ls=W.photos.filter(he=>he.point_id===ee[0].id),re.length>0&&ls.length>0){Ts&&Ts.photo_id?I.value=ls.filter(vt=>vt.id==parseInt(Ts.photo_id))[0]:I.value=ls[0];const he={imageUrl:`${at}/map.jpg`,center:{x:1024/2,y:512/2},rotation:"0deg",defaultZoom:80,size:"150px",pinSize:5,spotSize:g,visibleOnLoad:!0,static:!0,hotspots:ee},La={width:I.value.size.width,cols:16,rows:8,baseUrl:`${at}/${I.value.point_id}/${I.value.id}/low.jpg`,tileUrl:(vt,ve)=>`${at}/${I.value.point_id}/${I.value.id}/${vt}_${ve}.jpg`};z.value=re[0];const zo=re[0].name;P.value=I.value.id,X=Oa(E.value,La,zo,he);const Pa=X.getPlugin(va);Pa.hide(),bl.is.desktop||Pa.hide(),X.addEventListener("*",function(vt,ve){console.log("Event:",vt),console.log("Data:",ve)});const Ra=X.getPlugin(Cn);j.value=$n(at,ls);const yr=Ao(j.value);Ra.setItems(yr);const To=X.getPlugin(ho);To.addEventListener("select-hotspot",({hotspotId:vt})=>{const ve=W.points.filter(ue=>ue.id===parseInt(vt)),Xt=W.photos.filter(ue=>ue.point_id===parseInt(vt)),Ge={width:Xt[0].size.width,cols:16,rows:8,baseUrl:`${at}/${ve[0].id}/${Xt[0].id}/low.jpg`,tileUrl:(ue,gu)=>`${at}/${ve[0].id}/${Xt[0].id}/${ue}_${gu}.jpg`};X.setPanorama(Ge),X.setOptions({caption:ve[0].name}),ee=ee.map(ue=>({...ue,color:"yellow"}));const ii=ee.findIndex(ue=>ue.id===parseInt(vt));ii!==-1&&(ee[ii]={...ee[ii],color:"red"},To.setHotspots(ee),m.value=mt.value[ii]),z.value=ve[0],j.value=$n(at,Xt);const Qt=Ao(j.value);Ra.setItems(Qt),fe.value&&(console.log("split view new point"),Dt.destroy(),rn())});const Os=X.getPlugin(Ke);X.addEventListener("dblclick",({data:vt})=>{if(console.log("dbclick",mi.value),mi.value=Tt.value[0],u.value&&V.value){V.value=!1;const ve=$.value[0].points.map(Xt=>Xt.map_id==f.value.id&&Xt.id!=z.value.id?{label:` ${Xt.no}.${Xt.name}`,value:Xt.id}:!1);mt.value=ve.filter(Xt=>Xt!==!1),tt.value={type:ht.value[0],point_id:z.value.id,photo_id:P.value,to_point_id:mt.value[0],allphoto:!0,id:Math.floor(Date.now()/1e3),position:{pitch:vt.pitch,yaw:vt.yaw},size:{width:120,height:120},imageLayer:"/icons/markers/hotspot-w.png",orientation:"vertical",opacity:1,title:"",content:""},Os.addMarker(tt.value),ut.value=!0}}),Os.addEventListener("select-marker",async({marker:vt,doubleClick:ve,rightClick:Xt})=>{if(as.value=vt.config,V.value){V.value=!0,ut.value=!0,console.log(vt.config),tt.value=vt.config,Ft.value=ht.value[0];const Ge=$.value[0].points.map(Qt=>Qt.map_id==f.value.id?{label:` ${Qt.no}.${Qt.name}`,value:Qt.id}:!1);mt.value=Ge.filter(Qt=>Qt!==!1),to_point_id.value=mt.value.filter(Qt=>Qt.value==vt.config.to_point_id)[0];const ii=ss.findIndex(Qt=>vt.config.imageLayer=="/icons/markers/"+Qt+".png");mi.value=Tt.value[ii],opacity.value=vt.config.opacity}else if(J.value)X.rotate({yaw:vt.config.position.yaw,pitch:vt.config.position.pitch});else if(vt.config.type.id=="link")window.open(vt.config.content,"_blank");else if(vt.config.type.id=="hotspot"){const Ge=$.value[0].photos.filter(Qt=>Qt.point_id==vt.config.to_point_id.value)[0];m.value=mt.value.filter(Qt=>Qt.id==vt.config.to_point_id.value)[0];const ii={width:Ge.size.width,cols:16,rows:8,baseUrl:`${at}/${vt.config.to_point_id.value}/${Ge.id}/low.jpg`,tileUrl:(Qt,ue)=>`${at}/${vt.config.to_point_id.value}/${Ge.id}/${Qt}_${ue}.jpg`};X.setPanorama(ii)}}),X.addEventListener("panorama-loaded",async vt=>{const ve=vt.data.panorama.baseUrl.split("/"),Xt=ve[ve.length-2];P.value=parseInt(Xt),I.value=await Rn(Xt),z.value=$.value[0].points.filter(ue=>ue.id==I.value.point_id)[0],ee=ee.map(ue=>({...ue,color:"yellow"}));const Ge=ee.findIndex(ue=>ue.id===z.value.id);Ge!==-1&&(ee[Ge]={...ee[Ge],color:"red"},To.setHotspots(ee)),I.value.position!=null?X.rotate({yaw:I.value.position.yaw,pitch:I.value.position.pitch}):X.rotate({yaw:0,pitch:0}),I.value.zoom!=null?X.zoom(I.value.zoom):X.zoom(0),X.setOptions({caption:z.value.name+" ("+Sl(Xt)+")",description:ot.value.innerHTML});const ii=await Fn({point_id:z.value.id,photo_id:parseInt(Xt)});Os.setMarkers(ii);const Qt={site_id:W.id,map_id:z.value.map_id,point_id:z.value.id,photo_id:parseInt(Xt)};await GS(i.state,`view: ${W.name} - ${z.value.name}`),Lr.set("route",Qt)}),X.addEventListener("click",({data:vt})=>{if(X.getPlugin(ho).close(),as.value={},J.value=!1,We.value){console.log("mark point",vt.pitch,vt.yaw),Ni.value={pitch:vt.pitch,yaw:vt.yaw};const Xt=X.getPlugin(Ke);tt.value={type:"commentMarker",point_id:z.value.id,photo_id:P.value,allphoto:!1,id:Math.floor(Date.now()/1e3),position:{pitch:vt.pitch,yaw:vt.yaw},size:{width:120,height:120},imageLayer:"/icons/commentMarker.png",orientation:"vertical",tooltip:"comment marker",hoverScale:!0},We.value=!1,Xt.addMarker(tt.value)}}),X.addEventListener("position-updated",({position:vt})=>{as.value&&J.value&&(as.value={...as.value,position:vt},Os.updateMarker(as.value),Ss(as.value)),fe.value&&Dt.rotate({yaw:vt.yaw,pitch:vt.pitch})}),X.addEventListener("zoom-updated",({zoomLevel:vt})=>{fe.value&&(console.log(`new zoom level is ${vt}`),Dt.zoom(vt))}),O.value=!0}else O.value=!1},cu=R=>{console.log("cmarker",tt.value),console.log("val",R);const W=X.getPlugin(Ke);tt.value={...tt.value,imageLayer:`/icons/markers/${R.value}.png`},W.updateMarker(tt.value)};Wh(tt,R=>{console.log("new marker",R),X.getPlugin(Ke).updateMarker(R)},{deep:!0});const du=()=>{console.log("click autorote"),pt.value=!pt.value;const R=X.getPlugin(zn);pt.value?R.start():R.stop()},Ia=R=>{console.log("emit add point",R),We.value=R,X.getPlugin(zn).stop()},fu=R=>{R&&(console.log("emit delete point",R.id),We.value=!1,X.getPlugin(zn).stop(),X.getPlugin(Ke).removeMarker(R.id))},pu=R=>{console.log("parent gotoPoint",R),X.getPlugin(zn).stop(),X.animate({yaw:R.yaw,pitch:R.pitch,zoom:80,speed:"30rpm"})},mu=()=>{mr.value.setScrollPercentage("vertical",1,300)};let vr;const ko=Z(380),Co=R=>{R.isFirst===!0&&(vr=ko.value),ko.value=vr-R.offset.x};return gg(async()=>{if(e.params.catchAll){const R=e.params.catchAll[0].split(","),W={site_id:parseInt(s.value),map_id:parseInt(R[0]),point_id:parseInt(R[1]),photo_id:parseInt(R[2])};Lr.set("route",W)}if(fe.value=!1,$.value=await sn(),$.value.length>0){const R=Lr.getItem("route");if(x.value=$.value[0].maps,x.value.length>0)if(v.value=!0,G.value=x.value.map(W=>({label:`${W.code}: ${W.name}`,code:W.code,id:W.id})),R!=null&&R.site_id==s.value){const W=G.value.findIndex(Ot=>Ot.id==R.map_id);mt.value=$.value[0].points.filter(Ot=>Ot.map_id==R.map_id),mt.value=mt.value.map(Ot=>({label:`${Ot.name}`,no:Ot.no,id:Ot.id})),mt.value.sort((Ot,re)=>Ot.no-re.no);const at=mt.value.findIndex(Ot=>Ot.id==R.point_id);W!=-1&&(f.value=G.value[W],m.value=mt.value[at],d.value=x.value[W],gr(d.value))}else f.value=G.value[0],mt.value=$.value[0].points.filter(W=>W.map_id==$.value[0].maps[0].id),mt.value=mt.value.map(W=>({label:`${W.name}`,no:W.no,id:W.id})),m.value=mt.value[0],d.value=x.value[0],gr(d.value)}}),{screen:Z(a.screen),uploadPhotos:Pe,showDateTime:Ui,removeFile:Eo,drawerWidth:ko,resizeDrawer:Co,Platform:bl,gotoBottom:mu,scrollAreaRef:mr,gotoPoint:pu,markerPointPosition:Ni,deletePoint:fu,addPoint:Ia,localDateString:Sl,description:ot,selectedPhoto:P,onSelectIcon:cu,selectHotspotIcons:mi,hotspotIcons:Tt,pointOptions:mt,dAgo:qS,handleAutoRotate:du,autoRotate:pt,showViewer2:fe,split:ks,splitView:rn,addHotspot:Kt,handleEditMarker:Pt,handleMoveMarker:Nt,addLink:gt,editMarker:V,moveMarker:J,confirmDeleteMarker:vi,clearMarker:H,addNote:Dn,newMarker:tt,clickUpload:Lt,onSelectAddOn:Un,hotspotOption:Ft,hotspotOptions:ht,markerForm:ut,authorized:l,user:c,isAdmin:u,hasMap:v,site:s,sites:$,viewerContainer:E,viewerContainer2:S,selectedMap:d,pointInfo:z,photoInfo:I,hasHotspot:O,mapOptions:G,selectMapOption:f,selectPointOption:m,onSelectMap:ns,onSelectPoint:Re,handleupload:nn,uploadForm:_t,date:zt,gallery_photos:j,onPhotoUploaded:So,onSubmitPhoto:os,uploaderRef:lt,dateString:Al,localDateString:Sl,toggleComments:b,setFocus:Bn,setPosition:Nn}}}),jz={class:"row justify-center"},Zz={class:"q-drawer__resizer"},Xz={class:"col-grow",ref:"viewerContainer"},Qz={class:""},Jz=Ct("div",{class:"text-h2 col-12",style:{opacity:".4"}}," Nothing here.. ",-1),Kz={key:0,class:"col-12"},tT={class:"text-subtitle1 bg-grey-12 text-grey-9 text-center q-pa-sm q-mb-none"},eT={class:"absolute-top text-center"},iT={class:"flex justify-end q-mt-md"},sT={key:0},nT={key:1},rT={key:2},oT=Ct("div",{class:"q-mt-md"},"Select Icon:",-1),aT={class:"q-mt-md"},lT={class:"q-mt-md"},hT={class:"q-mb-md"},uT=Ct("div",null,"Position:",-1),cT={class:"q-mb-md"},dT={class:"flex q-mt-md"},fT={ref:"description",style:{display:"none"}},pT={key:0},mT=["src"],gT={class:"q-gutter-sm q-mt-md"},vT={key:0},yT={key:1};function xT(i,t,e,s,r,a){const l=yg("Comments");return nt(),le(ca,null,[Ct("div",jz,[i.hasMap&&i.hasHotspot?(nt(),Mt(PS,{key:0,modelValue:i.toggleComments,"onUpdate:modelValue":t[6]||(t[6]=u=>i.toggleComments=u),bordered:"",side:"right",class:"bg-grey-9 text-grey-1",width:i.drawerWidth,breakpoint:0},{default:Y(()=>[Li(Ct("div",Zz,null,512),[[Lh,i.resizeDrawer,void 0,{preserveCursor:!0,prevent:!0,mouse:!0,horizontal:!0}]]),q(da,{flat:"",square:""},{default:Y(()=>[q(Go,{color:"primary","bg-color":"grey-3","label-color":"grey-9",square:"",borderless:"",modelValue:i.selectMapOption,"onUpdate:modelValue":[t[0]||(t[0]=u=>i.selectMapOption=u),t[1]||(t[1]=u=>i.onSelectMap(u))],options:i.mapOptions,label:"Map"},{prepend:Y(()=>[q(Tn,{name:"map",size:"lg",class:"q-ml-md text-grey-9"})]),_:1},8,["modelValue","options"]),q(fh,{color:"grey-7 q-mx-sm"}),q(Go,{color:"primary","bg-color":"grey-3","label-color":"orange",square:"",borderless:"",modelValue:i.selectPointOption,"onUpdate:modelValue":[t[2]||(t[2]=u=>i.selectPointOption=u),t[3]||(t[3]=u=>i.onSelectPoint(u))],options:i.pointOptions},{prepend:Y(()=>[q(Tn,{name:"my_location",size:"lg",class:"q-ml-md text-grey-9"})]),_:1},8,["modelValue","options"]),q(fh,{color:"grey-7 q-mx-sm"}),q(vg,{class:"bg-grey-3 text-grey-9"},{default:Y(()=>[q(Ih),i.isAdmin?(nt(),Mt(jt,{key:0,title:"Edit Marker",size:"md",flat:"",color:i.editMarker?"deep-orange":"grey-9",icon:"edit",onClick:i.handleEditMarker},null,8,["color","onClick"])):xt("",!0),i.isAdmin?(nt(),Mt(jt,{key:1,title:"Move Marker",size:"md",flat:"",color:i.moveMarker?"deep-orange":"grey-9",icon:"multiple_stop",onClick:i.handleMoveMarker},null,8,["color","onClick"])):xt("",!0),i.isAdmin?(nt(),Mt(jt,{key:2,title:"Set Heading",size:"md",flat:"",icon:"center_focus_strong",onClick:t[4]||(t[4]=u=>i.setFocus())})):xt("",!0),q(jt,{title:"Split Screen",size:"md",flat:"",icon:"vertical_split",onClick:i.splitView},null,8,["onClick"]),q(jt,{title:"Split Screen",size:"md",flat:"",icon:"chevron_right",onClick:t[5]||(t[5]=u=>i.toggleComments=!i.toggleComments)})]),_:1})]),_:1}),q(YS,{ref:"scrollAreaRef",style:{height:"calc(100vh - 220px)"}},{default:Y(()=>[i.authorized?(nt(),Mt(l,{key:0,point:i.pointInfo,map:i.selectedMap,photo:i.selectedPhoto,markerPointPosition:i.newMarker,onDeletePoint:i.deletePoint,onAddPoint:i.addPoint,onGotoPoint:i.gotoPoint,onGotoBottom:i.gotoBottom},null,8,["point","map","photo","markerPointPosition","onDeletePoint","onAddPoint","onGotoPoint","onGotoBottom"])):xt("",!0)]),_:1},512)]),_:1},8,["modelValue","width"])):xt("",!0),Ct("div",Xz,null,512),Ct("div",{class:"col-6",ref:"viewerContainer2",style:kS({display:i.showViewer2?"block":"none"})},null,4)]),!i.hasMap||!i.hasHotspot?(nt(),Mt(RS,{key:0,class:"bg-grey-12 text-grey-9 text-center q-pa-md flex flex-center"},{default:Y(()=>[Ct("div",Qz,[Jz,i.authorized?(nt(),le("div",Kz,[q(jt,{class:"q-mt-xl",size:"xl",label:"New Map",icon:"add",color:"deep-orange",to:"/"+i.site+"/map"},null,8,["to"])])):xt("",!0)])]),_:1})):xt("",!0),q(Ed,{modelValue:i.uploadForm,"onUpdate:modelValue":t[7]||(t[7]=u=>i.uploadForm=u),class:"q-pa-md",square:"",onHide:t[8]||(t[8]=u=>i.clickUpload=!1)},{default:Y(()=>[q(da,{class:"q-pa-none",style:{width:"550px"}},{default:Y(()=>[q(Um,{class:"bg-secondary text-grey-1"},{default:Y(()=>[q(Tc,null,{default:Y(()=>[Bt("Upload 360\xB0 Photo")]),_:1})]),_:1}),Ct("div",tT,we(i.pointInfo.name),1),q(Dm,{onSubmit:CS(i.onSubmitPhoto,["prevent"])},{default:Y(()=>[q(Oh,{class:"q-mb-md"},{default:Y(()=>[Ct("div",null,[q(FS,{ref:"uploaderRef",onAdded:i.onPhotoUploaded,extensions:["jpg","jpeg","png","gif"],"auto-upload":!1,multiple:"","hide-upload-btn":!0,label:"Upload 360\xB0 Photo",class:"full-width"},{list:Y(u=>[q(Sd,{separator:""},{default:Y(()=>[(nt(!0),le(ca,null,Md(u.files,c=>(nt(),Mt(kn,{key:c.__key},{default:Y(()=>[c.__img?(nt(),Mt(Ii,{key:0},{default:Y(()=>[q(aa,{style:{height:"200px"},src:c.__img.src},{default:Y(()=>[Ct("div",eT,we(i.showDateTime(c.name)),1)]),_:2},1032,["src"])]),_:2},1024)):xt("",!0),u.files.length>1?(nt(),Mt(Ii,{key:1,top:"",side:""},{default:Y(()=>[q(jt,{class:"gt-xs",size:"12px",flat:"",dense:"",round:"",icon:"delete",onClick:d=>i.removeFile(u,c)},null,8,["onClick"])]),_:2},1024)):xt("",!0)]),_:2},1024))),128))]),_:2},1024)]),_:1},8,["onAdded"])]),Ct("div",iT,[Li(q(jt,{rounded:"",flat:"",label:"Close"},null,512),[[rr]]),i.uploadPhotos.length>0?(nt(),Mt(jt,{key:0,rounded:"",label:"Upload",type:"submit",color:"primary"})):xt("",!0)])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1},8,["modelValue"]),q(Ed,{persistent:"",modelValue:i.markerForm,"onUpdate:modelValue":t[26]||(t[26]=u=>i.markerForm=u),class:"q-pa-md",square:"",position:"right"},{default:Y(()=>[q(da,{class:"my-card"},{default:Y(()=>[q(Um,{class:"bg-secondary text-grey-1"},{default:Y(()=>[i.editMarker?(nt(),Mt(Tc,{key:0,class:"text-subtitle1 text-grey1"},{default:Y(()=>[Bt("Edit Marker")]),_:1})):(nt(),Mt(Tc,{key:1,class:"text-subtitle1 text-grey1"},{default:Y(()=>[Bt("New Marker")]),_:1}))]),_:1}),q(Oh,{class:"text-grey-9 q-gutter-sm"},{default:Y(()=>[q(Go,{class:"q-mb-lg",outlined:"",modelValue:i.newMarker.type,"onUpdate:modelValue":[t[9]||(t[9]=u=>i.newMarker.type=u),t[10]||(t[10]=u=>i.onSelectAddOn(u))],options:i.hotspotOptions,label:"Select Marker Type",color:"grey-9","options-selected-class":"text-primary bg-grey-12"},{option:Y(u=>[q(kn,zS(TS(u.itemProps)),{default:Y(()=>[q(Ii,{avatar:""},{default:Y(()=>[q(Tn,{name:u.opt.icon},null,8,["name"])]),_:2},1024),q(Ii,null,{default:Y(()=>[q(ao,null,{default:Y(()=>[Bt(we(u.opt.label),1)]),_:2},1024),q(ao,{caption:""},{default:Y(()=>[Bt(we(u.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"]),q(Dm,{onSubmit:i.addHotspot},{default:Y(()=>[i.newMarker.type.id=="hotspot"?(nt(),le("div",sT,[q(Go,{class:"",color:"deep-orange",outlined:"","label-color":"orange",modelValue:i.newMarker.to_point_id,"onUpdate:modelValue":t[11]||(t[11]=u=>i.newMarker.to_point_id=u),options:i.pointOptions,label:"Goto Point",rules:[u=>!!u||"Point is required"]},{append:Y(()=>[q(Tn,{size:"md",name:"my_location",color:"deep-orange"})]),_:1},8,["modelValue","options","rules"])])):xt("",!0),i.newMarker.type.id=="note"?(nt(),le("div",nT,[q(oa,{class:"q-pb-none q-mb-xs",label:"Title",filled:"",modelValue:i.newMarker.title,"onUpdate:modelValue":t[12]||(t[12]=u=>i.newMarker.title=u),rules:[u=>!!u||"required"],dense:""},null,8,["modelValue","rules"]),q(oa,{class:"q-pt-none q-mt-none",type:"textarea",filled:"",label:"Description",modelValue:i.newMarker.content,"onUpdate:modelValue":t[13]||(t[13]=u=>i.newMarker.content=u)},null,8,["modelValue"])])):xt("",!0),i.newMarker.type.id=="link"?(nt(),le("div",rT,[q(oa,{class:"q-pa-none q-mb-xs",label:"Title",filled:"",modelValue:i.newMarker.title,"onUpdate:modelValue":t[14]||(t[14]=u=>i.newMarker.title=u),rules:[u=>!!u||"required"],dense:""},null,8,["modelValue","rules"]),q(oa,{label:"Link URL",filled:"",modelValue:i.newMarker.content,"onUpdate:modelValue":t[15]||(t[15]=u=>i.newMarker.content=u),rules:[u=>!!u||"required"],dense:""},{hint:Y(()=>[Bt(" ex: https://www.google.com ")]),_:1},8,["modelValue","rules"])])):xt("",!0),q(fh),oT,q(Go,{"onUpdate:modelValue":[t[16]||(t[16]=u=>i.onSelectIcon(u)),t[17]||(t[17]=u=>i.selectHotspotIcons=u)],class:"bg-grey-4 q-pa-xs",color:"grey-1",dark:"","options-selected-class":"text-grey-1 bg-grey-9",outlined:"",modelValue:i.selectHotspotIcons,options:i.hotspotIcons,"options-html":"true"},null,8,["modelValue","options"]),Ct("div",aT,[Bt(" Size: "+we(i.newMarker.size.width)+" X "+we(i.newMarker.size.height)+" px ",1),q(Lc,{modelValue:i.newMarker.size.width,"onUpdate:modelValue":t[18]||(t[18]=u=>i.newMarker.size.width=u),label:"",markers:"",step:32,snap:"",min:16,max:512},null,8,["modelValue"]),q(Lc,{modelValue:i.newMarker.size.height,"onUpdate:modelValue":t[19]||(t[19]=u=>i.newMarker.size.height=u),label:"",markers:"",step:32,snap:"",min:16,max:512},null,8,["modelValue"])]),Ct("div",lT,[Bt(" Opacity: "+we(i.newMarker.opacity)+"% ",1),q(Lc,{modelValue:i.newMarker.opacity,"onUpdate:modelValue":t[20]||(t[20]=u=>i.newMarker.opacity=u),label:"",markers:"",step:.05,snap:"",min:0,max:1},null,8,["modelValue"])]),Ct("div",hT,[uT,q(Ml,{modelValue:i.newMarker.orientation,"onUpdate:modelValue":t[21]||(t[21]=u=>i.newMarker.orientation=u),val:"vertical",label:"2D"},null,8,["modelValue"]),q(Ml,{modelValue:i.newMarker.orientation,"onUpdate:modelValue":t[22]||(t[22]=u=>i.newMarker.orientation=u),val:"horizontal",label:"Floor"},null,8,["modelValue"]),q(Ml,{modelValue:i.newMarker.orientation,"onUpdate:modelValue":t[23]||(t[23]=u=>i.newMarker.orientation=u),val:"vertical-left",label:"Left"},null,8,["modelValue"]),q(Ml,{modelValue:i.newMarker.orientation,"onUpdate:modelValue":t[24]||(t[24]=u=>i.newMarker.orientation=u),val:"vertical-right",label:"Right"},null,8,["modelValue"])]),Ct("div",cT,[q(OS,{modelValue:i.newMarker.allphoto,"onUpdate:modelValue":t[25]||(t[25]=u=>i.newMarker.allphoto=u),label:"Mark all photo"},null,8,["modelValue"])]),Ct("div",dT,[i.editMarker?(nt(),Mt(jt,{key:0,color:"red",onClick:i.confirmDeleteMarker},{default:Y(()=>[Bt("Delete")]),_:1},8,["onClick"])):xt("",!0),q(Ih),Li(q(jt,{rounded:"",flat:"",label:"Close",onClick:i.clearMarker},null,8,["onClick"]),[[rr]]),q(jt,{rounded:"",type:"submit",color:"primary"},{default:Y(()=>[Bt("Submit")]),_:1})])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),Ct("div",fT,[i.photoInfo?(nt(),le("div",pT,[i.photoInfo?(nt(),le("iframe",{key:0,src:`https://www.google.com/maps/embed/v1/view?center=${i.photoInfo.gps.GPSLatitude},${i.photoInfo.gps.GPSLongitude}&zoom=15&key=AIzaSyBaJuw08lJV6LH8LjeKMe2zqeIft6qWBYM`,width:"100%",height:"300",frameborder:"0",style:{border:"0"},allowfullscreen:"","aria-hidden":"false",tabindex:"0"},`
      `,8,mT)):xt("",!0),Ct("div",gT,[Ct("div",null,"Id: "+we(i.photoInfo.id),1),Ct("div",null,"By: "+we(i.photoInfo.postby),1),Ct("div",null,"Camera: "+we(`${i.photoInfo.gps.Make}-${i.photoInfo.gps.Model}`),1),i.photoInfo.gps.ModifyDate?(nt(),le("div",vT,"Modify Date: "+we(i.localDateString(i.photoInfo.gps.ModifyDate)),1)):xt("",!0),i.photoInfo.gps.DateTimeOriginal?(nt(),le("div",yT,"Created Date: "+we(i.localDateString(i.photoInfo.gps.DateTimeOriginal)),1)):xt("",!0),Ct("div",null,"GPS: "+we(`${i.photoInfo.gps.GPSLatitude},${i.photoInfo.gps.GPSLongitude}`),1)])])):xt("",!0)],512)],64)}var wT=Fd(Yz,[["render",xT]]);const _T=Rd({name:"IndexPage",components:{PhotoSphere:wT},setup(){return{}}});function bT(i,t,e,s,r,a){const l=yg("PhotoSphere");return nt(),Mt(l)}var WT=Fd(_T,[["render",bT]]);export{WT as default};
